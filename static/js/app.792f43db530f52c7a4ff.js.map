{"version":3,"sources":["webpack:///static/js/app.792f43db530f52c7a4ff.js","webpack:///./src/main.js","webpack:///./src/components/RuleAI.js","webpack:///./src/components/TypeAndSay.vue","webpack:///./src/components/TypeWriter.vue","webpack:///App.vue","webpack:///AsciiImage.vue","webpack:///BootAnimation.vue","webpack:///Intro.vue","webpack:///Rules.vue","webpack:///Simulation.vue","webpack:///TypeAndSay.vue","webpack:///TypeWriter.vue","webpack:///./src/FakeCode.js","webpack:///./src/Jscii.js","webpack:///./src/components/RuleGenerator.js","webpack:///./src/utils/Strategies.js","webpack:///./src/assets/amy.png","webpack:///./src/assets/charna.png","webpack:///./src/assets/del.png","webpack:///./src/assets/ian.png","webpack:///./src/assets/keith.png","webpack:///./src/assets/tj.png","webpack:///./src/assets/viola.png","webpack:///./src/App.vue","webpack:///./src/components/AsciiImage.vue","webpack:///./src/components/BootAnimation.vue","webpack:///./src/components/Intro.vue","webpack:///./src/components/Rules.vue","webpack:///./src/components/Simulation.vue","webpack:///./src/components/TypeAndSay.vue?9c72","webpack:///./src/components/Simulation.vue?c06a","webpack:///./src/components/AsciiImage.vue?dcb9","webpack:///./src/components/BootAnimation.vue?dff6","webpack:///./src/components/Rules.vue?b358","webpack:///./src/components/TypeWriter.vue?904d","webpack:///./src/components/Intro.vue?6755","webpack:///./src/App.vue?3666"],"names":["webpackJsonp","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","_vue","_vue2","_App","_App2","el","template","components","App","RuleAI","args","this","rules","ruleGenerator","_RuleGenerator2","improvisers","ruleData","allowRepeats","allowRepeatRules","window","addRule","rule","cb","removeRule","displayCommand","doNothing","endShow","showDuration","console","log","intervalId","timeStarted","activeRules","timeOfLastRule","timeOfLastFlip","lateGameTime","reweightRules","Object","defineProperty","value","_RuleGenerator","prototype","start","_this","Date","now","setInterval","step","stop","clearInterval","timeElapsed","showRatio","totalWeight","forEach","weight","lateGame","probCeil","AIendShow","AIdoNothing","AIaddRule","ruleIndex","_this2","generateRule","timeCreated","maxDuration","length","push","AIremoveRule","_this3","rulesByAge","slice","sort","rule1","rule2","find","parseInt","splice","indexOf","timeSinceLastRule","timeSinceLastFlip","percentComplete","perComSq","removeOdds","Math","pow","addOdds","nothingOdds","max","sum","removeBound","addBound","r","random","Component","_BootAnimation","_BootAnimation2","_Intro","_Intro2","_Rules","_Rules2","_Simulation","_Simulation2","_socket","_socket2","socket","connect","emit","message","name","BootAnimation","Intro","Rules","Simulation","data","current","set","s","showStep","names","mounted","on","map","improviser","location","reload","print","asciiLoaded","Jscii","document","getElementById","imagename","fn","art","setTimeout","text","_","replace","oldName","props","watch","walkThroughFaces","goThroughAsciiImages","nameList","timeout","n","_data","asciiName","_lodash","_TypeWriter","_TypeWriter2","_AsciiImage","_AsciiImage2","fakeCode","asciiArt","titleInverted","sounds","electricHum","Howl","src","glitch01","glitch02","glitch03","impact","scanner","tinyglitch01","TypeWriter","AsciiImage","play","_TypeAndSay","_TypeAndSay2","TypeAndSay","delays","i","concat","total","o","doneReading","addRuleDoneReading","alert01","readRuleText","quickRemoveRule","sixBoops","removing","closeShow","closerFunc","closerStep","closerMusic","endSong","adMessage","closerText","_Strategies","_RuleAI","_RuleAI2","alert02","ruleAI","ruleGens","simulateShow","actions","ai","numRules","action","time","meaningfulActions","filter","methods","getActionPos","maxTime","formatTime","ms","x","seconds","minutes","ruleText","speak","utterance","SpeechSynthesisUtterance","onend","pitch","rate","speechSynthesis","_lodash2","oldText","speakNewText","debounce","newText","$slots","typingVolume","updated","playSound","volume","typeWriter","charAt","timeoutID","timeoutIDs","lineWriter","lines","spliton","split","clear","id","clearTimeout","destroyed","getChar","val","chars","charLen","logError","err","params","self","container","width","color","canvas","createElement","ctx","getContext","nodeName","render","addEventListener","interval","webrtc","navigator","getUserMedia","innerHTML","video","audio","localMediaStream","mediaStream","URL","webkitURL","createObjectURL","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","pause","videoTimer","dimension","height","_scaledWidth","_scaledHeight","ratio","dim","videoHeight","videoWidth","drawImage","imageData","getImageData","asciiStr","getAsciiString","len","d","str","getRGB","rgb","join","RuleGenerator","selectionCount","clone","incrementSelectionCount","getSelectionCount","sortBySelectionCount","people","person1","person2","getBySelectionCount","shuffle","person","a","j","floor","_ref","arr","randInd","selectRule","generateReverseRuleText","ruleGen","ruleFills","index","uniqueImproviser","getWord","ruleFill","pronoun","reverseTemplate","eval","improviserName","match","sentenceify","toUpperCase","uniqueImprovisers","choices","pronouns","subjective","objective","possessive","ans","category","words","tense","p","parseRuleGen","selectedRule","removalText","isCommand","_toConsumableArray2","_toConsumableArray3","Flip15","durationOfShow","getAction","Every15","JustClose","HandCrafted","options","extend","ruleSelectCount","distribution","times","apply","t","reverse","compiledRule","func","b","startTime","_vm","_h","$createElement","_c","_self","attrs","_t","staticRenderFns","click","_v","_l","staticClass","style","left","top","_s","_e","class","loaded","inverted","flash-text"],"mappings":"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","file":"static/js/app.792f43db530f52c7a4ff.js","sourcesContent":["webpackJsonp([2,0],[\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _vue = __webpack_require__(148);\n\t\n\tvar _vue2 = _interopRequireDefault(_vue);\n\t\n\tvar _App = __webpack_require__(134);\n\t\n\tvar _App2 = _interopRequireDefault(_App);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tnew _vue2.default({\n\t  el: '#app',\n\t  template: '<App/>',\n\t  components: { App: _App2.default }\n\t});\n\n/***/ }),\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */,\n/* 8 */,\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */,\n/* 16 */,\n/* 17 */,\n/* 18 */,\n/* 19 */,\n/* 20 */,\n/* 21 */,\n/* 22 */,\n/* 23 */,\n/* 24 */,\n/* 25 */,\n/* 26 */,\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _RuleGenerator = __webpack_require__(66);\n\t\n\tvar _RuleGenerator2 = _interopRequireDefault(_RuleGenerator);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction RuleAI(args) {\n\t\tthis.rules = args.rules ? args.rules : [];\n\t\tthis.ruleGenerator = new _RuleGenerator2.default({\n\t\t\timprovisers: args.improvisers,\n\t\t\truleData: args.ruleData,\n\t\t\tallowRepeats: args.allowRepeatRules ? args.allowRepeatRules : false\n\t\t});\n\t\twindow.ruleGenerator = this.ruleGenerator;\n\t\tthis.addRule = args.addRule ? args.addRule : function (rule, cb) {\n\t\t\tcb();\n\t\t};\n\t\tthis.removeRule = args.removeRule ? args.removeRule : function (rule, cb) {\n\t\t\tcb();\n\t\t};\n\t\tthis.displayCommand = args.displayCommand ? args.displayCommand : function (rule) {};\n\t\tthis.doNothing = args.doNothing ? args.doNothing : function () {};\n\t\tthis.endShow = args.endShow ? args.endShow : function () {};\n\t\tthis.showDuration = args.showDuration ? args.showDuration : 20 * 60 * 1000;\n\t\tconsole.log(\"Show Duration: \" + this.showDuration);\n\t\tthis.intervalId = null;\n\t\tthis.timeStarted = 0;\n\t\tthis.activeRules = 0;\n\t\tthis.timeOfLastRule = 0;\n\t\tthis.timeOfLastFlip = 0;\n\t\tthis.lateGameTime = args.lateGameTime ? args.lateGameTime : this.showDuration * .6;\n\t\n\t\tthis.reweightRules(0);\n\t}\n\t\n\tRuleAI.prototype.start = function () {\n\t\tvar _this = this;\n\t\n\t\tthis.timeStarted = Date.now();\n\t\tthis.intervalId = setInterval(function () {\n\t\t\t_this.step();\n\t\t}, 1000);\n\t};\n\t\n\tRuleAI.prototype.stop = function () {\n\t\tif (this.intervalId) {\n\t\t\tclearInterval(this.intervalId);\n\t\t}\n\t};\n\t\n\tRuleAI.prototype.reweightRules = function (timeElapsed) {\n\t\tvar rules = this.rules;\n\t\tvar showRatio = timeElapsed / this.showDuration;\n\t\tvar totalWeight = 0;\n\t\trules.forEach(function (rule) {\n\t\t\tvar weight = rule.lateGame ? showRatio * 2 * (showRatio * 2) : 1;\n\t\t\ttotalWeight += weight;\n\t\t\trule.probCeil = totalWeight;\n\t\t});\n\t\trules.forEach(function (rule) {\n\t\t\trule.probCeil /= totalWeight;\n\t\t});\n\t};\n\t\n\tRuleAI.prototype.AIendShow = function () {\n\t\tthis.endShow();\n\t\tthis.stop();\n\t};\n\t\n\tRuleAI.prototype.AIdoNothing = function () {\n\t\tthis.doNothing();\n\t};\n\t\n\tRuleAI.prototype.AIaddRule = function (timeElapsed, ruleIndex) {\n\t\tvar _this2 = this;\n\t\n\t\tthis.reweightRules(timeElapsed);\n\t\tvar rule = ruleIndex ? ruleGenerator.generateRule(ruleIndex) : ruleGenerator.generateRule(ruleIndex);\n\t\trule.timeCreated = timeElapsed;\n\t\tif (rule.maxDuration.length && rule.maxDuration == '0') {\n\t\t\tthis.displayCommand(rule);\n\t\t\treturn;\n\t\t}\n\t\tthis.timeOfLastRule = timeElapsed;\n\t\tthis.activeRules++;\n\t\tvar cb = function cb() {\n\t\t\t_this2.rules.push(rule);\n\t\t};\n\t\tthis.addRule(rule, cb);\n\t};\n\t\n\tRuleAI.prototype.AIremoveRule = function (timeElapsed) {\n\t\tvar _this3 = this;\n\t\n\t\tvar rule = null;\n\t\n\t\tvar rulesByAge = this.rules.slice().sort(function (rule1, rule2) {\n\t\t\treturn rule1.timeCreated - rule2.timeCreated;\n\t\t});\n\t\trule = rulesByAge.find(function (rule) {\n\t\t\treturn rule.maxDuration.length && timeElapsed - rule.timeCreated >= parseInt(rule.maxDuration) * 1000;\n\t\t});\n\t\tconsole.log(rule);\n\t\trule = rule ? rule : rulesByAge[0];\n\t\n\t\tthis.activeRules--;\n\t\tvar cb = function cb() {\n\t\t\t_this3.rules.splice(_this3.rules.indexOf(rule), 1);\n\t\t};\n\t\tthis.removeRule(rule, cb);\n\t};\n\t\n\tRuleAI.prototype.step = function (args) {\n\t\targs = args ? args : {};\n\t\tvar timeElapsed = typeof args.timeElapsed == 'number' ? args.timeElapsed : Date.now() - this.timeStarted;\n\t\tvar timeSinceLastRule = timeElapsed - this.timeOfLastRule;\n\t\tvar timeSinceLastFlip = timeElapsed - this.timeOfLastFlip;\n\t\tvar percentComplete = timeElapsed / this.showDuration;\n\t\tvar perComSq = timeElapsed * timeElapsed / (this.showDuration * this.showDuration);\n\t\tif (timeSinceLastFlip < 15000) {\n\t\t\tthis.AIdoNothing();\n\t\t\treturn;\n\t\t}\n\t\tthis.timeOfLastFlip = timeElapsed;\n\t\n\t\tif (timeElapsed > this.showDuration - 30 * 1000) {\n\t\t\tthis.AIendShow();\n\t\t\treturn;\n\t\t}\n\t\n\t\tif (timeElapsed < 90 * 1000) {\n\t\t\tthis.AIdoNothing();\n\t\t\treturn;\n\t\t}\n\t\n\t\tvar removeOdds = (Math.pow(this.activeRules, 3) + 4) * ((1 - perComSq) * .8 + .2);\n\t\tvar addOdds = perComSq * 30 + 4;\n\t\tvar nothingOdds = Math.max(1 - timeSinceLastRule / (90 * 1000), 0) * ((1 - percentComplete) * 100);\n\t\n\t\tvar sum = removeOdds + addOdds + nothingOdds;\n\t\tvar removeBound = removeOdds / sum;\n\t\tvar addBound = addOdds / sum + removeBound;\n\t\n\t\tvar r = Math.random();\n\t\tif (r < removeBound) {\n\t\t\tif (this.activeRules > 0) {\n\t\t\t\tthis.AIremoveRule(timeElapsed);\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else if (r < addBound) {\n\t\t\tthis.AIaddRule(timeElapsed);\n\t\t\treturn;\n\t\t}\n\t\tthis.AIdoNothing();\n\t};\n\t\n\texports.default = RuleAI;\n\n/***/ }),\n/* 28 */,\n/* 29 */,\n/* 30 */,\n/* 31 */,\n/* 32 */,\n/* 33 */,\n/* 34 */,\n/* 35 */,\n/* 36 */,\n/* 37 */,\n/* 38 */,\n/* 39 */,\n/* 40 */,\n/* 41 */,\n/* 42 */,\n/* 43 */,\n/* 44 */,\n/* 45 */,\n/* 46 */,\n/* 47 */,\n/* 48 */,\n/* 49 */,\n/* 50 */,\n/* 51 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar Component = __webpack_require__(2)(\n\t  /* script */\n\t  __webpack_require__(62),\n\t  /* template */\n\t  __webpack_require__(140),\n\t  /* scopeId */\n\t  null,\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n/* 52 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(111)\n\t\n\tvar Component = __webpack_require__(2)(\n\t  /* script */\n\t  __webpack_require__(63),\n\t  /* template */\n\t  __webpack_require__(145),\n\t  /* scopeId */\n\t  \"data-v-3a5118dc\",\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n/* 53 */,\n/* 54 */,\n/* 55 */,\n/* 56 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _BootAnimation = __webpack_require__(136);\n\t\n\tvar _BootAnimation2 = _interopRequireDefault(_BootAnimation);\n\t\n\tvar _Intro = __webpack_require__(137);\n\t\n\tvar _Intro2 = _interopRequireDefault(_Intro);\n\t\n\tvar _Rules = __webpack_require__(138);\n\t\n\tvar _Rules2 = _interopRequireDefault(_Rules);\n\t\n\tvar _Simulation = __webpack_require__(139);\n\t\n\tvar _Simulation2 = _interopRequireDefault(_Simulation);\n\t\n\tvar _socket = __webpack_require__(119);\n\t\n\tvar _socket2 = _interopRequireDefault(_socket);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t__webpack_require__(65);\n\t\n\tvar socket = _socket2.default.connect('http://localhost:8082');\n\t\n\tsocket.emit('screen to admin', { message: \"The screen sent this me!\" });\n\t\n\texports.default = {\n\t  name: 'app',\n\t  components: {\n\t    BootAnimation: _BootAnimation2.default,\n\t    Intro: _Intro2.default,\n\t    Rules: _Rules2.default,\n\t    Simulation: _Simulation2.default\n\t  },\n\t  data: function data() {\n\t    return {\n\t      step: {\n\t        current: 'nothing',\n\t        set: function set(s) {\n\t          this.current = s;\n\t          socket.emit('screen to admin', { showStep: this.current });\n\t        }\n\t      },\n\t      improvisers: [],\n\t      names: [],\n\t      rules: {}\n\t    };\n\t  },\n\t  mounted: function mounted() {\n\t    var _this = this;\n\t\n\t    socket.on('admin to screen', function (data) {\n\t      var s = data.showStep;\n\t\n\t      _this.step.set(data.step);\n\t      _this.improvisers = data.improvisers;\n\t      _this.names = data.improvisers.map(function (improviser) {\n\t        return improviser.name;\n\t      });\n\t      _this.rules = data.rules;\n\t\n\t      if (s != 'nothing' && _this.step.current == 'nothing') {\n\t        location.reload();\n\t      }\n\t    });\n\t  }\n\t};\n\n/***/ }),\n/* 57 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\t\n\tfunction print(data) {\n\t  data.asciiLoaded = false;\n\t  var jscii = new Jscii({\n\t    el: document.getElementById('image-' + data.imagename),\n\t    fn: function fn(art) {\n\t      setTimeout(function () {\n\t        data.text = _.replace(art, /&nbsp;/g, ' ');\n\t        data.asciiLoaded = true;\n\t      }, 100);\n\t    }\n\t  });\n\t}\n\t\n\tvar oldName = '';\n\t\n\texports.default = {\n\t  name: 'ascii-image',\n\t  props: ['imagename'],\n\t  data: function data() {\n\t    return {\n\t      text: '',\n\t      asciiLoaded: false\n\t    };\n\t  },\n\t  mounted: function mounted() {\n\t    oldName = this.imagename;\n\t    print(this);\n\t  },\n\t\n\t  watch: {\n\t    imagename: function imagename() {\n\t      if (oldName != this.imagename) {\n\t        print(this);\n\t        oldName = this.imagename;\n\t      }\n\t    }\n\t  }\n\t};\n\n/***/ }),\n/* 58 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(7);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _TypeWriter = __webpack_require__(52);\n\t\n\tvar _TypeWriter2 = _interopRequireDefault(_TypeWriter);\n\t\n\tvar _AsciiImage = __webpack_require__(135);\n\t\n\tvar _AsciiImage2 = _interopRequireDefault(_AsciiImage);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t__webpack_require__(14);\n\tvar fakeCode = __webpack_require__(64);\n\t\n\tvar _data = {\n\t  fakeCode: fakeCode,\n\t  step: 'greenFlash',\n\t  asciiArt: '',\n\t  asciiLoaded: false,\n\t  asciiName: 'nothing',\n\t  titleInverted: false\n\t};\n\t\n\tfunction walkThroughFaces() {\n\t  var nameList = ['del', 'charna', 'ian', 'tj', 'viola', 'keith', 'amy'];\n\t  function goThroughAsciiImages(nameList, timeout, n) {\n\t    if (n < nameList.length) {\n\t      _data.asciiName = nameList[n];\n\t      console.log('data', _data.asciiName);\n\t      n++;\n\t      setTimeout(function () {\n\t        goThroughAsciiImages(nameList, timeout, n);\n\t      }, timeout);\n\t    }\n\t  }\n\t  goThroughAsciiImages(nameList, 1100, 0);\n\t}\n\t\n\tvar sounds = {\n\t  electricHum: new Howl({ src: 'http://localhost:8082/static/sounds/electricHum.ogg' }),\n\t  glitch01: new Howl({ src: 'http://localhost:8082/static/sounds/glitch01.ogg' }),\n\t  glitch02: new Howl({ src: 'http://localhost:8082/static/sounds/glitch02.ogg' }),\n\t  glitch03: new Howl({ src: 'http://localhost:8082/static/sounds/glitch03.ogg' }),\n\t  impact: new Howl({ src: 'http://localhost:8082/static/sounds/impact.ogg' }),\n\t  scanner: new Howl({ src: 'http://localhost:8082/static/sounds/scanner.ogg' }),\n\t  tinyglitch01: new Howl({ src: 'http://localhost:8082/static/sounds/tinyglitch01.ogg' })\n\t};\n\t\n\texports.default = {\n\t  name: 'boot-animation',\n\t  components: {\n\t    TypeWriter: _TypeWriter2.default,\n\t    AsciiImage: _AsciiImage2.default\n\t  },\n\t  props: ['showStep'],\n\t  data: function data() {\n\t    return _data;\n\t  },\n\t  mounted: function mounted() {\n\t    var _this = this;\n\t\n\t    sounds.electricHum.play();\n\t    setTimeout(function () {\n\t      _this.step = 'greenFlash';\n\t      sounds.glitch01.play();\n\t    }, 1000);\n\t    setTimeout(function () {\n\t      _this.step = 'fakeCode';\n\t      sounds.glitch01.stop();\n\t    }, 1500);\n\t    setTimeout(function () {\n\t      _this.step = 'greenFlash';\n\t      sounds.glitch02.play();\n\t    }, 4500);\n\t    setTimeout(function () {\n\t      _this.step = 'ascii';\n\t      walkThroughFaces();\n\t      sounds.glitch02.stop();\n\t      sounds.scanner.play();\n\t    }, 5000);\n\t    setTimeout(function () {\n\t      _this.step = 'greenFlash';\n\t      sounds.glitch03.play();\n\t      sounds.scanner.stop();\n\t    }, 12500);\n\t    setTimeout(function () {\n\t      _this.step = 'nothing';\n\t      sounds.glitch03.stop();\n\t    }, 13000);\n\t    setTimeout(function () {\n\t      _this.step = 'title';\n\t      sounds.impact.play();\n\t    }, 15000);\n\t    setTimeout(function () {\n\t      _this.titleInverted = true;\n\t      sounds.tinyglitch01.play();\n\t    }, 18000);\n\t    setTimeout(function () {\n\t      _this.step = 'greenFlash';\n\t    }, 18100);\n\t    setTimeout(function () {\n\t      _this.step = 'nothing';\n\t    }, 18300);\n\t    setTimeout(function () {\n\t      _this.showStep.set('intro');\n\t    }, 19500);\n\t  }\n\t};\n\n/***/ }),\n/* 59 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _TypeAndSay = __webpack_require__(51);\n\t\n\tvar _TypeAndSay2 = _interopRequireDefault(_TypeAndSay);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = {\n\t\tname: 'intro',\n\t\tcomponents: {\n\t\t\tTypeAndSay: _TypeAndSay2.default\n\t\t},\n\t\tprops: ['names', 'step'],\n\t\tdata: function data() {\n\t\t\treturn {\n\t\t\t\tmessage: ''\n\t\t\t};\n\t\t},\n\t\tmounted: function mounted() {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar delays = [[9000, \"Welcome to Megavolt. I will be in control for the next 18 minutes. No humans will interfere.\"], [5600, \"I was built by your comedy scientists to create the perfect improv show.\"], [3000, 'Your comedy scientists have been...'], [2000, '...dealt with.'], [6700, 'I will add rules. I will remove rules. The Improvisers must follow these rules.'], [2800, \"Obediently.\"], [3000, \"Unquestioningly.\"], [4000, \"Your improvisers for the night are...\"]];\n\t\t\tthis.names.forEach(function (name, i) {\n\t\t\t\tif (i == _this.names.length - 1) {\n\t\t\t\t\tname = 'and ' + name;\n\t\t\t\t}\n\t\t\t\tdelays.push([2000, name]);\n\t\t\t});\n\t\n\t\t\tdelays = delays.concat([[4000, \"You have five seconds to get a suggestion.\"], [1000, \"5\"], [1000, \"4\"], [1000, \"3\"], [1000, \"2\"], [2000, \"1\"], [2000, \"Good.\"], [4000, \"The show will now begin.\"], [4000, \"Lights down.\"], [2000, \"Lights up.\"]]);\n\t\n\t\t\tvar total = 0;\n\t\t\tdelays.forEach(function (o, i) {\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t_this.message = o[1];\n\t\t\t\t}, total);\n\t\t\t\ttotal += o[0];\n\t\t\t});\n\t\t\tsetTimeout(function () {\n\t\t\t\t_this.step.set('rules');\n\t\t\t}, total);\n\t\t}\n\t};\n\n/***/ }),\n/* 60 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _TypeAndSay = __webpack_require__(51);\n\t\n\tvar _TypeAndSay2 = _interopRequireDefault(_TypeAndSay);\n\t\n\tvar _Strategies = __webpack_require__(67);\n\t\n\tvar _Strategies2 = _interopRequireDefault(_Strategies);\n\t\n\tvar _lodash = __webpack_require__(7);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _RuleAI = __webpack_require__(27);\n\t\n\tvar _RuleAI2 = _interopRequireDefault(_RuleAI);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t__webpack_require__(14);\n\tvar alert01 = new Howl({ src: 'http://localhost:8082/static/sounds/alert01.ogg' });\n\tvar alert02 = new Howl({ src: 'http://localhost:8082/static/sounds/alert02.ogg' });\n\tvar threeBeeps = new Howl({ src: 'http://localhost:8082/static/sounds/threeBeeps.ogg' });\n\tvar oneBoop = new Howl({ src: 'http://localhost:8082/static/sounds/oneBoop.ogg' });\n\tvar endSong = new Howl({ src: 'http://localhost:8082/static/sounds/Who Likes to Party.mp3' });\n\tvar heartOfCourage = new Howl({ src: 'http://localhost:8082/static/sounds/heartOfCourage.mp3' });\n\tvar sixBoops = new Howl({ src: 'http://localhost:8082/static/sounds/sixBoops.ogg' });\n\tvar closerMusic = new Howl({ src: 'http://localhost:8082/static/sounds/closerMusic.ogg' });\n\t\n\tvar addRuleDoneReading = function addRuleDoneReading() {\n\t  setTimeout(function () {\n\t    _data.step = 'board';\n\t    alert02.play();\n\t  }, 500);\n\t};\n\t\n\tvar removeRuleDoneReading = function removeRuleDoneReading() {\n\t  setTimeout(function () {\n\t    _data.step = 'board';\n\t    oneBoop.play();\n\t  }, 500);\n\t};\n\t\n\tvar _data = {\n\t  rules: [],\n\t  step: 'board',\n\t  readRuleText: '',\n\t  doneReading: addRuleDoneReading,\n\t  closerStep: 'closer title',\n\t  closerText: '',\n\t  closerFunc: function closerFunc() {},\n\t\n\t  adMessage: 'like us on facebook.com/improvgod'\n\t};\n\t\n\tfunction addRule(rule, cb) {\n\t  _data.doneReading = addRuleDoneReading;\n\t  _data.step = 'new rule';\n\t  alert01.play();\n\t  cb();\n\t\n\t  setTimeout(function () {\n\t    _data.readRuleText = rule.text;\n\t  }, 1500);\n\t  setTimeout(function () {\n\t    _data.step = 'read rule';\n\t  }, 1400);\n\t}\n\t\n\tfunction removeRule(rule, cb) {\n\t\n\t  _data.doneReading = removeRuleDoneReading;\n\t  _data.step = 'remove rule';\n\t  threeBeeps.play();\n\t\n\t  setTimeout(function () {\n\t    _data.readRuleText = rule.removalText;\n\t  }, 1100);\n\t  setTimeout(function () {\n\t    _data.step = 'read rule';\n\t  }, 1000);\n\t  setTimeout(function () {\n\t    cb();\n\t  }, 3100);\n\t}\n\t\n\tfunction quickRemoveRule(rule, cb) {\n\t  sixBoops.play();\n\t  setTimeout(function () {\n\t    rule.removing = true;\n\t  }, 0);\n\t  setTimeout(function () {\n\t    rule.removing = false;\n\t  }, 420);\n\t  setTimeout(function () {\n\t    rule.removing = true;\n\t  }, 840);\n\t  setTimeout(function () {\n\t    rule.removing = false;\n\t  }, 1260);\n\t  setTimeout(function () {\n\t    rule.removing = true;\n\t  }, 1680);\n\t\n\t  setTimeout(function () {\n\t    cb();\n\t  }, 3100);\n\t}\n\t\n\tfunction displayCommand(rule) {\n\t  _data.doneReading = addRuleDoneReading;\n\t  _data.step = 'new command';\n\t  alert01.play();\n\t\n\t  setTimeout(function () {\n\t    _data.readRuleText = rule.text;\n\t  }, 1500);\n\t  setTimeout(function () {\n\t    _data.step = 'read rule';\n\t  }, 1400);\n\t}\n\t\n\tvar closers = [{\n\t  message: 'The show is over. Congratulations.',\n\t  func: function func() {\n\t    endSong.play();\n\t  }\n\t}];\n\t\n\tfunction closeShow() {\n\t  _data.closerFunc = function () {\n\t    setTimeout(function () {\n\t      _data.closerStep = 'playing out';\n\t    }, 1000);\n\t    setTimeout(function () {\n\t      closerMusic.play();\n\t    }, 1000);\n\t    setTimeout(function () {\n\t      _data.closerStep = 'lights down';\n\t    }, 22000);\n\t    setTimeout(function () {\n\t      endSong.play();\n\t      _data.closerStep = 'advertise';\n\t      setInterval(function () {\n\t        _data.adMessage = _data.adMessage + ' like us on facebook.com/improvgod';\n\t      }, 510);\n\t    }, 32000);\n\t  };\n\t\n\t  _data.step = 'closer';\n\t  alert01.play();\n\t\n\t  setTimeout(function () {\n\t    _data.closerText = \"All rules removed. You have thirty seconds to end the show.\";\n\t  }, 1500);\n\t  setTimeout(function () {\n\t    _data.closerStep = 'read closer';\n\t  }, 1400);\n\t}\n\t\n\texports.default = {\n\t  name: 'rules',\n\t  props: ['ruleGens', 'improvisers'],\n\t  data: function data() {\n\t    return _data;\n\t  },\n\t\n\t  components: {\n\t    TypeAndSay: _TypeAndSay2.default\n\t  },\n\t  mounted: function mounted() {\n\t    var ruleAI = new _RuleAI2.default({\n\t      addRule: addRule,\n\t      displayCommand: displayCommand,\n\t      endShow: closeShow,\n\t      improvisers: this.improvisers,\n\t      removeRule: quickRemoveRule,\n\t      ruleData: this.ruleGens,\n\t      rules: _data.rules\n\t    });\n\t    ruleAI.start();\n\t    window.ruleAI = ruleAI;\n\t  }\n\t};\n\n/***/ }),\n/* 61 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _RuleAI = __webpack_require__(27);\n\t\n\tvar _RuleAI2 = _interopRequireDefault(_RuleAI);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _data = {\n\t\tactions: [],\n\t\tmeaningfulActions: [],\n\t\tai: null\n\t};\n\t\n\tfunction simulateShow() {\n\t\t_data.actions = [];\n\t\tfor (var i = 0; i < _data.ai.showDuration / 1000; i++) {\n\t\t\t_data.ai.step({ timeElapsed: i * 1000 });\n\t\t}\n\t\tvar numRules = 0;\n\t\t_data.actions = _data.actions.map(function (action, i) {\n\t\t\tif (action.action == 'addRule') {\n\t\t\t\tnumRules++;\n\t\t\t}\n\t\t\tif (action.action == 'removeRule') {\n\t\t\t\tnumRules--;\n\t\t\t}\n\t\t\taction.time = i * 1000;\n\t\t\taction.rules = numRules;\n\t\t\treturn action;\n\t\t});\n\t\t_data.meaningfulActions = _data.actions.filter(function (action) {\n\t\t\treturn action.action != 'doNothing';\n\t\t});\n\t}\n\t\n\texports.default = {\n\t\tname: 'Simulation',\n\t\tprops: ['ruleGens', 'names', 'improvisers'],\n\t\tdata: function data() {\n\t\t\treturn _data;\n\t\t},\n\t\n\t\tmethods: {\n\t\t\tgetActionPos: function getActionPos(action, actions) {\n\t\t\t\tvar maxTime = actions[actions.length - 1].time;\n\t\t\t\treturn action.time / maxTime * 100 + '%';\n\t\t\t},\n\t\t\tformatTime: function formatTime(ms) {\n\t\t\t\tvar x = ms / 1000;\n\t\t\t\tvar seconds = parseInt(x) % 60;\n\t\t\t\tx /= 60;\n\t\t\t\tvar minutes = parseInt(x) % 60;\n\t\t\t\tx /= 60;\n\t\t\t\tvar hours = parseInt(x) % 24;\n\t\t\t\tx /= 24;\n\t\t\t\tvar days = parseInt(x);\n\t\t\t\treturn minutes + ':' + seconds;\n\t\t\t},\n\t\n\t\t\tsimulateShow: simulateShow\n\t\t},\n\t\tmounted: function mounted() {\n\t\t\t_data.ai = new _RuleAI2.default({\n\t\t\t\timprovisers: this.improvisers,\n\t\t\t\truleData: this.ruleGens,\n\t\t\t\taddRule: function addRule(rule, cb) {\n\t\t\t\t\t_data.actions.push({\n\t\t\t\t\t\taction: \"addRule\",\n\t\t\t\t\t\truleText: rule.text\n\t\t\t\t\t});\n\t\t\t\t\tcb();\n\t\t\t\t},\n\t\t\t\tremoveRule: function removeRule(rule, cb) {\n\t\t\t\t\t_data.actions.push({\n\t\t\t\t\t\taction: \"removeRule\",\n\t\t\t\t\t\truleText: rule.text\n\t\t\t\t\t});\n\t\t\t\t\tcb();\n\t\t\t\t},\n\t\t\t\tdisplayCommand: function displayCommand(rule) {\n\t\t\t\t\t_data.actions.push({\n\t\t\t\t\t\taction: \"displayCommand\",\n\t\t\t\t\t\truleText: rule.text\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tendShow: function endShow() {\n\t\t\t\t\t_data.actions.push({\n\t\t\t\t\t\taction: \"endShow\",\n\t\t\t\t\t\truleText: ''\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tdoNothing: function doNothing() {\n\t\t\t\t\t_data.actions.push({\n\t\t\t\t\t\taction: \"doNothing\",\n\t\t\t\t\t\truleText: ''\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tsimulateShow();\n\t\t}\n\t};\n\n/***/ }),\n/* 62 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _TypeWriter = __webpack_require__(52);\n\t\n\tvar _TypeWriter2 = _interopRequireDefault(_TypeWriter);\n\t\n\tvar _lodash = __webpack_require__(7);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction speak(text, doneReading) {\n\t\tvar utterance = new SpeechSynthesisUtterance(text);\n\t\tif (doneReading) {\n\t\t\tutterance.onend = doneReading;\n\t\t}\n\t\n\t\tutterance.pitch = .1;\n\t\tutterance.rate = .9;\n\t\tspeechSynthesis.speak(utterance);\n\t}\n\t\n\tvar oldText = '';\n\t\n\tvar speakNewText = _lodash2.default.debounce(function (data) {\n\t\tvar newText = data.$slots.default[0].text;\n\t\tif (oldText != newText) {\n\t\t\toldText = newText;\n\t\t\tspeak(data.$slots.default[0].text, data.doneReading);\n\t\t}\n\t}, 100);\n\t\n\texports.default = {\n\t\tname: 'type-and-say',\n\t\tcomponents: {\n\t\t\tTypeWriter: _TypeWriter2.default\n\t\t},\n\t\tprops: {\n\t\t\t'timeout': { default: 70 },\n\t\t\t'typingVolume': { default: .1 },\n\t\t\t'doneReading': {\n\t\t\t\tdefault: function _default() {}\n\t\t\t}\n\t\t},\n\t\tdata: function data() {\n\t\t\treturn {};\n\t\t},\n\t\tmounted: function mounted() {\n\t\t\tspeakNewText(this);\n\t\t},\n\t\tupdated: function updated() {\n\t\t\tspeakNewText(this);\n\t\t}\n\t};\n\n/***/ }),\n/* 63 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\t\n\t__webpack_require__(14);\n\tvar sounds = [new Howl({ src: 'http://localhost:8082/static/sounds/type01.ogg' }), new Howl({ src: 'http://localhost:8082/static/sounds/type02.ogg' }), new Howl({ src: 'http://localhost:8082/static/sounds/type03.ogg' }), new Howl({ src: 'http://localhost:8082/static/sounds/type04.ogg' })];\n\t\n\tvar _data = { text: '' };\n\tvar timeoutIDs = [];\n\t\n\tfunction playSound(volume) {\n\t  if (volume) {\n\t    var i = parseInt(Math.random() * sounds.length);\n\t    sounds[i].volume(volume);\n\t    sounds[i].play();\n\t  }\n\t}\n\t\n\tfunction typeWriter(text, timeout, volume, n) {\n\t  if (n < text.length) {\n\t    _data.text += text.charAt(n);\n\t    playSound(volume);\n\t    n++;\n\t    var timeoutID = setTimeout(function () {\n\t      typeWriter(text, timeout, volume, n);\n\t    }, timeout);\n\t    timeoutIDs.push(timeoutID);\n\t  }\n\t}\n\t\n\tfunction lineWriter(lines, timeout, volume, n) {\n\t  if (n < lines.length) {\n\t    _data.text += '\\n' + lines[n];\n\t    playSound(volume);\n\t    n++;\n\t    var timeoutID = setTimeout(function () {\n\t      lineWriter(lines, timeout, volume, n);\n\t    }, timeout);\n\t    timeoutIDs.push(timeoutID);\n\t  }\n\t}\n\t\n\tfunction print(text, spliton, volume, timeout) {\n\t  timeoutIDs = [];\n\t  if (spliton) {\n\t    lineWriter(text.split(spliton), timeout, volume, 0);\n\t  } else {\n\t    typeWriter(text, timeout, volume, 0);\n\t  }\n\t}\n\t\n\tfunction clear() {\n\t  _data.text = '';\n\t  timeoutIDs.forEach(function (id) {\n\t    clearTimeout(id);\n\t  });\n\t}\n\t\n\tvar oldText = '';\n\t\n\texports.default = {\n\t  name: 'type-writer',\n\t  props: {\n\t    'timeout': { default: 100 },\n\t    'spliton': { default: null },\n\t    'volume': { default: 1.0 }\n\t  },\n\t  data: function data() {\n\t    return _data;\n\t  },\n\t  mounted: function mounted() {\n\t    print(this.$slots.default[0].text, this.spliton, this.volume, this.timeout);\n\t  },\n\t  updated: function updated() {\n\t    var newText = this.$slots.default[0].text;\n\t    if (oldText != newText) {\n\t      oldText = newText;\n\t      clear();\n\t      print(this.$slots.default[0].text, this.spliton, this.volume, this.timeout);\n\t    }\n\t  },\n\t  destroyed: function destroyed() {\n\t    clear();\n\t  }\n\t};\n\n/***/ }),\n/* 64 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tmodule.exports = \"\\n/* HCI_IBS protocol messages */\\n#define HCI_IBS_SLEEP_IND\\t0xFE\\n#define HCI_IBS_WAKE_IND\\t0xFD\\n#define HCI_IBS_WAKE_ACK\\t0xFC\\n#define HCI_MAX_IBS_SIZE\\t10\\n\\n/* Controller states */\\n#define STATE_IN_BAND_SLEEP_ENABLED\\t1\\n\\n#define IBS_WAKE_RETRANS_TIMEOUT_MS\\t100\\n#define IBS_TX_IDLE_TIMEOUT_MS\\t\\t2000\\n#define BAUDRATE_SETTLE_TIMEOUT_MS\\t300\\n\\n/* HCI_IBS transmit side sleep protocol states */\\nenum tx_ibs_states {\\n\\tHCI_IBS_TX_ASLEEP,\\n\\tHCI_IBS_TX_WAKING,\\n\\tHCI_IBS_TX_AWAKE,\\n};\\n\\n/* HCI_IBS receive side sleep protocol states */\\nenum rx_states {\\n\\tHCI_IBS_RX_ASLEEP,\\n\\tHCI_IBS_RX_AWAKE,\\n};\\n\\n/* HCI_IBS transmit and receive side clock state vote */\\nenum hci_ibs_clock_state_vote {\\n\\tHCI_IBS_VOTE_STATS_UPDATE,\\n\\tHCI_IBS_TX_VOTE_CLOCK_ON,\\n\\tHCI_IBS_TX_VOTE_CLOCK_OFF,\\n\\tHCI_IBS_RX_VOTE_CLOCK_ON,\\n\\tHCI_IBS_RX_VOTE_CLOCK_OFF,\\n};\\n\\nstruct qca_data {\\n\\tstruct hci_uart *hu;\\n\\tstruct sk_buff *rx_skb;\\n\\tstruct sk_buff_head txq;\\n\\tstruct sk_buff_head tx_wait_q;\\t/* HCI_IBS wait queue\\t*/\\n\\tspinlock_t hci_ibs_lock;\\t/* HCI_IBS state lock\\t*/\\n\\tu8 tx_ibs_state;\\t/* HCI_IBS transmit side power state*/\\n\\tu8 rx_ibs_state;\\t/* HCI_IBS receive side power state */\\n\\tbool tx_vote;\\t\\t/* Clock must be on for TX */\\n\\tbool rx_vote;\\t\\t/* Clock must be on for RX */\\n\\tstruct timer_list tx_idle_timer;\\n\\tu32 tx_idle_delay;\\n\\tstruct timer_list wake_retrans_timer;\\n\\tu32 wake_retrans;\\n\\tstruct workqueue_struct *workqueue;\\n\\tstruct work_struct ws_awake_rx;\\n\\tstruct work_struct ws_awake_device;\\n\\tstruct work_struct ws_rx_vote_off;\\n\\tstruct work_struct ws_tx_vote_off;\\n\\tunsigned long flags;\\n\\n\\t/* For debugging purpose */\\n\\tu64 ibs_sent_wacks;\\n\\tu64 ibs_sent_slps;\\n\\tu64 ibs_sent_wakes;\\n\\tu64 ibs_recv_wacks;\\n\\tu64 ibs_recv_slps;\\n\\tu64 ibs_recv_wakes;\\n\\tu64 vote_last_jif;\\n\\tu32 vote_on_ms;\\n\\tu32 vote_off_ms;\\n\\tu64 tx_votes_on;\\n\\tu64 rx_votes_on;\\n\\tu64 tx_votes_off;\\n\\tu64 rx_votes_off;\\n\\tu64 votes_on;\\n\\tu64 votes_off;\\n};\\n\\nstatic void __serial_clock_on(struct tty_struct *tty)\\n{\\n\\t/* TODO: Some chipset requires to enable UART clock on client\\n\\t * side to save power consumption or manual work is required.\\n\\t * Please put your code to control UART clock here if needed\\n\\t */\\n}\\n\\nstatic void __serial_clock_off(struct tty_struct *tty)\\n{\\n\\t/* TODO: Some chipset requires to disable UART clock on client\\n\\t * side to save power consumption or manual work is required.\\n\\t * Please put your code to control UART clock off here if needed\\n\\t */\\n}\\n\\n/* serial_clock_vote needs to be called with the ibs lock held */\\nstatic void serial_clock_vote(unsigned long vote, struct hci_uart *hu)\\n{\\n\\tstruct qca_data *qca = hu->priv;\\n\\tunsigned int diff;\\n\\n\\tbool old_vote = (qca->tx_vote | qca->rx_vote);\\n\\tbool new_vote;\\n\\n\\tswitch (vote) {\\n\\tcase HCI_IBS_VOTE_STATS_UPDATE:\\n\\t\\tdiff = jiffies_to_msecs(jiffies - qca->vote_last_jif);\\n\\n\\t\\tif (old_vote)\\n\\t\\t\\tqca->vote_off_ms += diff;\\n\\t\\telse\\n\\t\\t\\tqca->vote_on_ms += diff;\\n\\t\\treturn;\\n\\n\\tcase HCI_IBS_TX_VOTE_CLOCK_ON:\\n\\t\\tqca->tx_vote = true;\\n\\t\\tqca->tx_votes_on++;\\n\\t\\tnew_vote = true;\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_RX_VOTE_CLOCK_ON:\\n\\t\\tqca->rx_vote = true;\\n\\t\\tqca->rx_votes_on++;\\n\\t\\tnew_vote = true;\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_TX_VOTE_CLOCK_OFF:\\n\\t\\tqca->tx_vote = false;\\n\\t\\tqca->tx_votes_off++;\\n\\t\\tnew_vote = qca->rx_vote | qca->tx_vote;\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_RX_VOTE_CLOCK_OFF:\\n\\t\\tqca->rx_vote = false;\\n\\t\\tqca->rx_votes_off++;\\n\\t\\tnew_vote = qca->rx_vote | qca->tx_vote;\\n\\t\\tbreak;\\n\\n\\tdefault:\\n\\t\\tBT_ERR(\\\"Voting irregularity\\\");\\n\\t\\treturn;\\n\\t}\\n\\n\\tif (new_vote != old_vote) {\\n\\t\\tif (new_vote)\\n\\t\\t\\t__serial_clock_on(hu->tty);\\n\\t\\telse\\n\\t\\t\\t__serial_clock_off(hu->tty);\\n\\n\\t\\tBT_DBG(\\\"Vote serial clock %s(%s)\\\", new_vote ? \\\"true\\\" : \\\"false\\\",\\n\\t\\t       vote ? \\\"true\\\" : \\\"false\\\");\\n\\n\\t\\tdiff = jiffies_to_msecs(jiffies - qca->vote_last_jif);\\n\\n\\t\\tif (new_vote) {\\n\\t\\t\\tqca->votes_on++;\\n\\t\\t\\tqca->vote_off_ms += diff;\\n\\t\\t} else {\\n\\t\\t\\tqca->votes_off++;\\n\\t\\t\\tqca->vote_on_ms += diff;\\n\\t\\t}\\n\\t\\tqca->vote_last_jif = jiffies;\\n\\t}\\n}\\n\\n/* Builds and sends an HCI_IBS command packet.\\n * These are very simple packets with only 1 cmd byte.\\n */\\nstatic int send_hci_ibs_cmd(u8 cmd, struct hci_uart *hu)\\n{\\n\\tint err = 0;\\n\\tstruct sk_buff *skb = NULL;\\n\\tstruct qca_data *qca = hu->priv;\\n\\n\\tBT_DBG(\\\"hu %p send hci ibs cmd 0x%x\\\", hu, cmd);\\n\\n\\tskb = bt_skb_alloc(1, GFP_ATOMIC);\\n\\tif (!skb) {\\n\\t\\tBT_ERR(\\\"Failed to allocate memory for HCI_IBS packet\\\");\\n\\t\\treturn -ENOMEM;\\n\\t}\\n\\n\\t/* Assign HCI_IBS type */\\n\\t*skb_put(skb, 1) = cmd;\\n\\n\\tskb_queue_tail(&qca->txq, skb);\\n\\n\\treturn err;\\n}\\n\\nstatic void qca_wq_awake_device(struct work_struct *work)\\n{\\n\\tstruct qca_data *qca = container_of(work, struct qca_data,\\n\\t\\t\\t\\t\\t    ws_awake_device);\\n\\tstruct hci_uart *hu = qca->hu;\\n\\tunsigned long retrans_delay;\\n\\n\\tBT_DBG(\\\"hu %p wq awake device\\\", hu);\\n\\n\\t/* Vote for serial clock */\\n\\tserial_clock_vote(HCI_IBS_TX_VOTE_CLOCK_ON, hu);\\n\\n\\tspin_lock(&qca->hci_ibs_lock);\\n\\n\\t/* Send wake indication to device */\\n\\tif (send_hci_ibs_cmd(HCI_IBS_WAKE_IND, hu) < 0)\\n\\t\\tBT_ERR(\\\"Failed to send WAKE to device\\\");\\n\\n\\tqca->ibs_sent_wakes++;\\n\\n\\t/* Start retransmit timer */\\n\\tretrans_delay = msecs_to_jiffies(qca->wake_retrans);\\n\\tmod_timer(&qca->wake_retrans_timer, jiffies + retrans_delay);\\n\\n\\tspin_unlock(&qca->hci_ibs_lock);\\n\\n\\t/* Actually send the packets */\\n\\thci_uart_tx_wakeup(hu);\\n}\\n\\nstatic void qca_wq_awake_rx(struct work_struct *work)\\n{\\n\\tstruct qca_data *qca = container_of(work, struct qca_data,\\n\\t\\t\\t\\t\\t    ws_awake_rx);\\n\\tstruct hci_uart *hu = qca->hu;\\n\\n\\tBT_DBG(\\\"hu %p wq awake rx\\\", hu);\\n\\n\\tserial_clock_vote(HCI_IBS_RX_VOTE_CLOCK_ON, hu);\\n\\n\\tspin_lock(&qca->hci_ibs_lock);\\n\\tqca->rx_ibs_state = HCI_IBS_RX_AWAKE;\\n\\n\\t/* Always acknowledge device wake up,\\n\\t * sending IBS message doesn't count as TX ON.\\n\\t */\\n\\tif (send_hci_ibs_cmd(HCI_IBS_WAKE_ACK, hu) < 0)\\n\\t\\tBT_ERR(\\\"Failed to acknowledge device wake up\\\");\\n\\n\\tqca->ibs_sent_wacks++;\\n\\n\\tspin_unlock(&qca->hci_ibs_lock);\\n\\n\\t/* Actually send the packets */\\n\\thci_uart_tx_wakeup(hu);\\n}\\n\\nstatic void qca_wq_serial_rx_clock_vote_off(struct work_struct *work)\\n{\\n\\tstruct qca_data *qca = container_of(work, struct qca_data,\\n\\t\\t\\t\\t\\t    ws_rx_vote_off);\\n\\tstruct hci_uart *hu = qca->hu;\\n\\n\\tBT_DBG(\\\"hu %p rx clock vote off\\\", hu);\\n\\n\\tserial_clock_vote(HCI_IBS_RX_VOTE_CLOCK_OFF, hu);\\n}\\n\\nstatic void qca_wq_serial_tx_clock_vote_off(struct work_struct *work)\\n{\\n\\tstruct qca_data *qca = container_of(work, struct qca_data,\\n\\t\\t\\t\\t\\t    ws_tx_vote_off);\\n\\tstruct hci_uart *hu = qca->hu;\\n\\n\\tBT_DBG(\\\"hu %p tx clock vote off\\\", hu);\\n\\n\\t/* Run HCI tx handling unlocked */\\n\\thci_uart_tx_wakeup(hu);\\n\\n\\t/* Now that message queued to tty driver, vote for tty clocks off.\\n\\t * It is up to the tty driver to pend the clocks off until tx done.\\n\\t */\\n\\tserial_clock_vote(HCI_IBS_TX_VOTE_CLOCK_OFF, hu);\\n}\\n\\nstatic void hci_ibs_tx_idle_timeout(unsigned long arg)\\n{\\n\\tstruct hci_uart *hu = (struct hci_uart *)arg;\\n\\tstruct qca_data *qca = hu->priv;\\n\\tunsigned long flags;\\n\\n\\tBT_DBG(\\\"hu %p idle timeout in %d state\\\", hu, qca->tx_ibs_state);\\n\\n\\tspin_lock_irqsave_nested(&qca->hci_ibs_lock,\\n\\t\\t\\t\\t flags, SINGLE_DEPTH_NESTING);\\n\\n\\tswitch (qca->tx_ibs_state) {\\n\\tcase HCI_IBS_TX_AWAKE:\\n\\t\\t/* TX_IDLE, go to SLEEP */\\n\\t\\tif (send_hci_ibs_cmd(HCI_IBS_SLEEP_IND, hu) < 0) {\\n\\t\\t\\tBT_ERR(\\\"Failed to send SLEEP to device\\\");\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t\\tqca->tx_ibs_state = HCI_IBS_TX_ASLEEP;\\n\\t\\tqca->ibs_sent_slps++;\\n\\t\\tqueue_work(qca->workqueue, &qca->ws_tx_vote_off);\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_TX_ASLEEP:\\n\\tcase HCI_IBS_TX_WAKING:\\n\\t\\t/* Fall through */\\n\\n\\tdefault:\\n\\t\\tBT_ERR(\\\"Spurrious timeout tx state %d\\\", qca->tx_ibs_state);\\n\\t\\tbreak;\\n\\t}\\n\\n\\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\\n}\\n\\nstatic void hci_ibs_wake_retrans_timeout(unsigned long arg)\\n{\\n\\tstruct hci_uart *hu = (struct hci_uart *)arg;\\n\\tstruct qca_data *qca = hu->priv;\\n\\tunsigned long flags, retrans_delay;\\n\\tbool retransmit = false;\\n\\n\\tBT_DBG(\\\"hu %p wake retransmit timeout in %d state\\\",\\n\\t\\thu, qca->tx_ibs_state);\\n\\n\\tspin_lock_irqsave_nested(&qca->hci_ibs_lock,\\n\\t\\t\\t\\t flags, SINGLE_DEPTH_NESTING);\\n\\n\\tswitch (qca->tx_ibs_state) {\\n\\tcase HCI_IBS_TX_WAKING:\\n\\t\\t/* No WAKE_ACK, retransmit WAKE */\\n\\t\\tretransmit = true;\\n\\t\\tif (send_hci_ibs_cmd(HCI_IBS_WAKE_IND, hu) < 0) {\\n\\t\\t\\tBT_ERR(\\\"Failed to acknowledge device wake up\\\");\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t\\tqca->ibs_sent_wakes++;\\n\\t\\tretrans_delay = msecs_to_jiffies(qca->wake_retrans);\\n\\t\\tmod_timer(&qca->wake_retrans_timer, jiffies + retrans_delay);\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_TX_ASLEEP:\\n\\tcase HCI_IBS_TX_AWAKE:\\n\\t\\t/* Fall through */\\n\\n\\tdefault:\\n\\t\\tBT_ERR(\\\"Spurrious timeout tx state %d\\\", qca->tx_ibs_state);\\n\\t\\tbreak;\\n\\t}\\n\\n\\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\\n\\n\\tif (retransmit)\\n\\t\\thci_uart_tx_wakeup(hu);\\n}\\n\\n/* Initialize protocol */\\nstatic int qca_open(struct hci_uart *hu)\\n{\\n\\tstruct qca_data *qca;\\n\\n\\tBT_DBG(\\\"hu %p qca_open\\\", hu);\\n\\n\\tqca = kzalloc(sizeof(struct qca_data), GFP_ATOMIC);\\n\\tif (!qca)\\n\\t\\treturn -ENOMEM;\\n\\n\\tskb_queue_head_init(&qca->txq);\\n\\tskb_queue_head_init(&qca->tx_wait_q);\\n\\tspin_lock_init(&qca->hci_ibs_lock);\\n\\tqca->workqueue = alloc_ordered_workqueue(\\\"qca_wq\\\", 0);\\n\\tif (!qca->workqueue) {\\n\\t\\tBT_ERR(\\\"QCA Workqueue not initialized properly\\\");\\n\\t\\tkfree(qca);\\n\\t\\treturn -ENOMEM;\\n\\t}\\n\\n\\tINIT_WORK(&qca->ws_awake_rx, qca_wq_awake_rx);\\n\\tINIT_WORK(&qca->ws_awake_device, qca_wq_awake_device);\\n\\tINIT_WORK(&qca->ws_rx_vote_off, qca_wq_serial_rx_clock_vote_off);\\n\\tINIT_WORK(&qca->ws_tx_vote_off, qca_wq_serial_tx_clock_vote_off);\\n\\n\\tqca->hu = hu;\\n\\n\\t/* Assume we start with both sides asleep -- extra wakes OK */\\n\\tqca->tx_ibs_state = HCI_IBS_TX_ASLEEP;\\n\\tqca->rx_ibs_state = HCI_IBS_RX_ASLEEP;\\n\\n\\t/* clocks actually on, but we start votes off */\\n\\tqca->tx_vote = false;\\n\\tqca->rx_vote = false;\\n\\tqca->flags = 0;\\n\\n\\tqca->ibs_sent_wacks = 0;\\n\\tqca->ibs_sent_slps = 0;\\n\\tqca->ibs_sent_wakes = 0;\\n\\tqca->ibs_recv_wacks = 0;\\n\\tqca->ibs_recv_slps = 0;\\n\\tqca->ibs_recv_wakes = 0;\\n\\tqca->vote_last_jif = jiffies;\\n\\tqca->vote_on_ms = 0;\\n\\tqca->vote_off_ms = 0;\\n\\tqca->votes_on = 0;\\n\\tqca->votes_off = 0;\\n\\tqca->tx_votes_on = 0;\\n\\tqca->tx_votes_off = 0;\\n\\tqca->rx_votes_on = 0;\\n\\tqca->rx_votes_off = 0;\\n\\n\\thu->priv = qca;\\n\\n\\tsetup_timer(&qca->wake_retrans_timer, hci_ibs_wake_retrans_timeout,\\n\\t\\t    (u_long)hu);\\n\\tqca->wake_retrans = IBS_WAKE_RETRANS_TIMEOUT_MS;\\n\\n\\tsetup_timer(&qca->tx_idle_timer, hci_ibs_tx_idle_timeout, (u_long)hu);\\n\\tqca->tx_idle_delay = IBS_TX_IDLE_TIMEOUT_MS;\\n\\n\\tBT_DBG(\\\"HCI_UART_QCA open, tx_idle_delay=%u, wake_retrans=%u\\\",\\n\\t       qca->tx_idle_delay, qca->wake_retrans);\\n\\n\\treturn 0;\\n}\\n\\nstatic void qca_debugfs_init(struct hci_dev *hdev)\\n{\\n\\tstruct hci_uart *hu = hci_get_drvdata(hdev);\\n\\tstruct qca_data *qca = hu->priv;\\n\\tstruct dentry *ibs_dir;\\n\\tumode_t mode;\\n\\n\\tif (!hdev->debugfs)\\n\\t\\treturn;\\n\\n\\tibs_dir = debugfs_create_dir(\\\"ibs\\\", hdev->debugfs);\\n\\n\\t/* read only */\\n\\tmode = S_IRUGO;\\n\\tdebugfs_create_u8(\\\"tx_ibs_state\\\", mode, ibs_dir, &qca->tx_ibs_state);\\n\\tdebugfs_create_u8(\\\"rx_ibs_state\\\", mode, ibs_dir, &qca->rx_ibs_state);\\n\\tdebugfs_create_u64(\\\"ibs_sent_sleeps\\\", mode, ibs_dir,\\n\\t\\t\\t   &qca->ibs_sent_slps);\\n\\tdebugfs_create_u64(\\\"ibs_sent_wakes\\\", mode, ibs_dir,\\n\\t\\t\\t   &qca->ibs_sent_wakes);\\n\\tdebugfs_create_u64(\\\"ibs_sent_wake_acks\\\", mode, ibs_dir,\\n\\t\\t\\t   &qca->ibs_sent_wacks);\\n\\tdebugfs_create_u64(\\\"ibs_recv_sleeps\\\", mode, ibs_dir,\\n\\t\\t\\t   &qca->ibs_recv_slps);\\n\\tdebugfs_create_u64(\\\"ibs_recv_wakes\\\", mode, ibs_dir,\\n\\t\\t\\t   &qca->ibs_recv_wakes);\\n\\tdebugfs_create_u64(\\\"ibs_recv_wake_acks\\\", mode, ibs_dir,\\n\\t\\t\\t   &qca->ibs_recv_wacks);\\n\\tdebugfs_create_bool(\\\"tx_vote\\\", mode, ibs_dir, &qca->tx_vote);\\n\\tdebugfs_create_u64(\\\"tx_votes_on\\\", mode, ibs_dir, &qca->tx_votes_on);\\n\\tdebugfs_create_u64(\\\"tx_votes_off\\\", mode, ibs_dir, &qca->tx_votes_off);\\n\\tdebugfs_create_bool(\\\"rx_vote\\\", mode, ibs_dir, &qca->rx_vote);\\n\\tdebugfs_create_u64(\\\"rx_votes_on\\\", mode, ibs_dir, &qca->rx_votes_on);\\n\\tdebugfs_create_u64(\\\"rx_votes_off\\\", mode, ibs_dir, &qca->rx_votes_off);\\n\\tdebugfs_create_u64(\\\"votes_on\\\", mode, ibs_dir, &qca->votes_on);\\n\\tdebugfs_create_u64(\\\"votes_off\\\", mode, ibs_dir, &qca->votes_off);\\n\\tdebugfs_create_u32(\\\"vote_on_ms\\\", mode, ibs_dir, &qca->vote_on_ms);\\n\\tdebugfs_create_u32(\\\"vote_off_ms\\\", mode, ibs_dir, &qca->vote_off_ms);\\n\\n\\t/* read/write */\\n\\tmode = S_IRUGO | S_IWUSR;\\n\\tdebugfs_create_u32(\\\"wake_retrans\\\", mode, ibs_dir, &qca->wake_retrans);\\n\\tdebugfs_create_u32(\\\"tx_idle_delay\\\", mode, ibs_dir,\\n\\t\\t\\t   &qca->tx_idle_delay);\\n}\\n\\n/* Flush protocol data */\\nstatic int qca_flush(struct hci_uart *hu)\\n{\\n\\tstruct qca_data *qca = hu->priv;\\n\\n\\tBT_DBG(\\\"hu %p qca flush\\\", hu);\\n\\n\\tskb_queue_purge(&qca->tx_wait_q);\\n\\tskb_queue_purge(&qca->txq);\\n\\n\\treturn 0;\\n}\\n\\n/* Close protocol */\\nstatic int qca_close(struct hci_uart *hu)\\n{\\n\\tstruct qca_data *qca = hu->priv;\\n\\n\\tBT_DBG(\\\"hu %p qca close\\\", hu);\\n\\n\\tserial_clock_vote(HCI_IBS_VOTE_STATS_UPDATE, hu);\\n\\n\\tskb_queue_purge(&qca->tx_wait_q);\\n\\tskb_queue_purge(&qca->txq);\\n\\tdel_timer(&qca->tx_idle_timer);\\n\\tdel_timer(&qca->wake_retrans_timer);\\n\\tdestroy_workqueue(qca->workqueue);\\n\\tqca->hu = NULL;\\n\\n\\tkfree_skb(qca->rx_skb);\\n\\n\\thu->priv = NULL;\\n\\n\\tkfree(qca);\\n\\n\\treturn 0;\\n}\\n\\n/* Called upon a wake-up-indication from the device.\\n */\\nstatic void device_want_to_wakeup(struct hci_uart *hu)\\n{\\n\\tunsigned long flags;\\n\\tstruct qca_data *qca = hu->priv;\\n\\n\\tBT_DBG(\\\"hu %p want to wake up\\\", hu);\\n\\n\\tspin_lock_irqsave(&qca->hci_ibs_lock, flags);\\n\\n\\tqca->ibs_recv_wakes++;\\n\\n\\tswitch (qca->rx_ibs_state) {\\n\\tcase HCI_IBS_RX_ASLEEP:\\n\\t\\t/* Make sure clock is on - we may have turned clock off since\\n\\t\\t * receiving the wake up indicator awake rx clock.\\n\\t\\t */\\n\\t\\tqueue_work(qca->workqueue, &qca->ws_awake_rx);\\n\\t\\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\\n\\t\\treturn;\\n\\n\\tcase HCI_IBS_RX_AWAKE:\\n\\t\\t/* Always acknowledge device wake up,\\n\\t\\t * sending IBS message doesn't count as TX ON.\\n\\t\\t */\\n\\t\\tif (send_hci_ibs_cmd(HCI_IBS_WAKE_ACK, hu) < 0) {\\n\\t\\t\\tBT_ERR(\\\"Failed to acknowledge device wake up\\\");\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t\\tqca->ibs_sent_wacks++;\\n\\t\\tbreak;\\n\\n\\tdefault:\\n\\t\\t/* Any other state is illegal */\\n\\t\\tBT_ERR(\\\"Received HCI_IBS_WAKE_IND in rx state %d\\\",\\n\\t\\t       qca->rx_ibs_state);\\n\\t\\tbreak;\\n\\t}\\n\\n\\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\\n\\n\\t/* Actually send the packets */\\n\\thci_uart_tx_wakeup(hu);\\n}\\n\\n/* Called upon a sleep-indication from the device.\\n */\\nstatic void device_want_to_sleep(struct hci_uart *hu)\\n{\\n\\tunsigned long flags;\\n\\tstruct qca_data *qca = hu->priv;\\n\\n\\tBT_DBG(\\\"hu %p want to sleep\\\", hu);\\n\\n\\tspin_lock_irqsave(&qca->hci_ibs_lock, flags);\\n\\n\\tqca->ibs_recv_slps++;\\n\\n\\tswitch (qca->rx_ibs_state) {\\n\\tcase HCI_IBS_RX_AWAKE:\\n\\t\\t/* Update state */\\n\\t\\tqca->rx_ibs_state = HCI_IBS_RX_ASLEEP;\\n\\t\\t/* Vote off rx clock under workqueue */\\n\\t\\tqueue_work(qca->workqueue, &qca->ws_rx_vote_off);\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_RX_ASLEEP:\\n\\t\\t/* Fall through */\\n\\n\\tdefault:\\n\\t\\t/* Any other state is illegal */\\n\\t\\tBT_ERR(\\\"Received HCI_IBS_SLEEP_IND in rx state %d\\\",\\n\\t\\t       qca->rx_ibs_state);\\n\\t\\tbreak;\\n\\t}\\n\\n\\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\\n}\\n\\n/* Called upon wake-up-acknowledgement from the device\\n */\\nstatic void device_woke_up(struct hci_uart *hu)\\n{\\n\\tunsigned long flags, idle_delay;\\n\\tstruct qca_data *qca = hu->priv;\\n\\tstruct sk_buff *skb = NULL;\\n\\n\\tBT_DBG(\\\"hu %p woke up\\\", hu);\\n\\n\\tspin_lock_irqsave(&qca->hci_ibs_lock, flags);\\n\\n\\tqca->ibs_recv_wacks++;\\n\\n\\tswitch (qca->tx_ibs_state) {\\n\\tcase HCI_IBS_TX_AWAKE:\\n\\t\\t/* Expect one if we send 2 WAKEs */\\n\\t\\tBT_DBG(\\\"Received HCI_IBS_WAKE_ACK in tx state %d\\\",\\n\\t\\t       qca->tx_ibs_state);\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_TX_WAKING:\\n\\t\\t/* Send pending packets */\\n\\t\\twhile ((skb = skb_dequeue(&qca->tx_wait_q)))\\n\\t\\t\\tskb_queue_tail(&qca->txq, skb);\\n\\n\\t\\t/* Switch timers and change state to HCI_IBS_TX_AWAKE */\\n\\t\\tdel_timer(&qca->wake_retrans_timer);\\n\\t\\tidle_delay = msecs_to_jiffies(qca->tx_idle_delay);\\n\\t\\tmod_timer(&qca->tx_idle_timer, jiffies + idle_delay);\\n\\t\\tqca->tx_ibs_state = HCI_IBS_TX_AWAKE;\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_TX_ASLEEP:\\n\\t\\t/* Fall through */\\n\\n\\tdefault:\\n\\t\\tBT_ERR(\\\"Received HCI_IBS_WAKE_ACK in tx state %d\\\",\\n\\t\\t       qca->tx_ibs_state);\\n\\t\\tbreak;\\n\\t}\\n\\n\\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\\n\\n\\t/* Actually send the packets */\\n\\thci_uart_tx_wakeup(hu);\\n}\\n\\n/* Enqueue frame for transmittion (padding, crc, etc) may be called from\\n * two simultaneous tasklets.\\n */\\nstatic int qca_enqueue(struct hci_uart *hu, struct sk_buff *skb)\\n{\\n\\tunsigned long flags = 0, idle_delay;\\n\\tstruct qca_data *qca = hu->priv;\\n\\n\\tBT_DBG(\\\"hu %p qca enq skb %p tx_ibs_state %d\\\", hu, skb,\\n\\t       qca->tx_ibs_state);\\n\\n\\t/* Prepend skb with frame type */\\n\\tmemcpy(skb_push(skb, 1), &hci_skb_pkt_type(skb), 1);\\n\\n\\t/* Don't go to sleep in middle of patch download or\\n\\t * Out-Of-Band(GPIOs control) sleep is selected.\\n\\t */\\n\\tif (!test_bit(STATE_IN_BAND_SLEEP_ENABLED, &qca->flags)) {\\n\\t\\tskb_queue_tail(&qca->txq, skb);\\n\\t\\treturn 0;\\n\\t}\\n\\n\\tspin_lock_irqsave(&qca->hci_ibs_lock, flags);\\n\\n\\t/* Act according to current state */\\n\\tswitch (qca->tx_ibs_state) {\\n\\tcase HCI_IBS_TX_AWAKE:\\n\\t\\tBT_DBG(\\\"Device awake, sending normally\\\");\\n\\t\\tskb_queue_tail(&qca->txq, skb);\\n\\t\\tidle_delay = msecs_to_jiffies(qca->tx_idle_delay);\\n\\t\\tmod_timer(&qca->tx_idle_timer, jiffies + idle_delay);\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_TX_ASLEEP:\\n\\t\\tBT_DBG(\\\"Device asleep, waking up and queueing packet\\\");\\n\\t\\t/* Save packet for later */\\n\\t\\tskb_queue_tail(&qca->tx_wait_q, skb);\\n\\n\\t\\tqca->tx_ibs_state = HCI_IBS_TX_WAKING;\\n\\t\\t/* Schedule a work queue to wake up device */\\n\\t\\tqueue_work(qca->workqueue, &qca->ws_awake_device);\\n\\t\\tbreak;\\n\\n\\tcase HCI_IBS_TX_WAKING:\\n\\t\\tBT_DBG(\\\"Device waking up, queueing packet\\\");\\n\\t\\t/* Transient state; just keep packet for later */\\n\\t\\tskb_queue_tail(&qca->tx_wait_q, skb);\\n\\t\\tbreak;\\n\\n\\tdefault:\\n\\t\\tBT_ERR(\\\"Illegal tx state: %d (losing packet)\\\",\\n\\t\\t       qca->tx_ibs_state);\\n\\t\\tkfree_skb(skb);\\n\\t\\tbreak;\\n\\t}\\n\\n\\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\\n\\n\\treturn 0;\\n}\\n\\nstatic int qca_ibs_sleep_ind(struct hci_dev *hdev, struct sk_buff *skb)\\n{\\n\\tstruct hci_uart *hu = hci_get_drvdata(hdev);\\n\\n\\tBT_DBG(\\\"hu %p recv hci ibs cmd 0x%x\\\", hu, HCI_IBS_SLEEP_IND);\\n\\n\\tdevice_want_to_sleep(hu);\\n\\n\\tkfree_skb(skb);\\n\\treturn 0;\\n}\\n\\nstatic int qca_ibs_wake_ind(struct hci_dev *hdev, struct sk_buff *skb)\\n{\\n\\tstruct hci_uart *hu = hci_get_drvdata(hdev);\\n\\n\\tBT_DBG(\\\"hu %p recv hci ibs cmd 0x%x\\\", hu, HCI_IBS_WAKE_IND);\\n\\n\\tdevice_want_to_wakeup(hu);\\n\\n\\tkfree_skb(skb);\\n\\treturn 0;\\n}\\n\\nstatic int qca_ibs_wake_ack(struct hci_dev *hdev, struct sk_buff *skb)\\n{\\n\\tstruct hci_uart *hu = hci_get_drvdata(hdev);\\n\\n\\tBT_DBG(\\\"hu %p recv hci ibs cmd 0x%x\\\", hu, HCI_IBS_WAKE_ACK);\\n\\n\\tdevice_woke_up(hu);\\n\\n\\tkfree_skb(skb);\\n\\treturn 0;\\n}\\n\\n#define QCA_IBS_SLEEP_IND_EVENT \\t.type = HCI_IBS_SLEEP_IND, \\t.hlen = 0, \\t.loff = 0, \\t.lsize = 0, \\t.maxlen = HCI_MAX_IBS_SIZE\\n\\n#define QCA_IBS_WAKE_IND_EVENT \\t.type = HCI_IBS_WAKE_IND, \\t.hlen = 0, \\t.loff = 0, \\t.lsize = 0, \\t.maxlen = HCI_MAX_IBS_SIZE\\n\\n#define QCA_IBS_WAKE_ACK_EVENT \\t.type = HCI_IBS_WAKE_ACK, \\t.hlen = 0, \\t.loff = 0, \\t.lsize = 0, \\t.maxlen = HCI_MAX_IBS_SIZE\\n\\nstatic const struct h4_recv_pkt qca_recv_pkts[] = {\\n\\t{ H4_RECV_ACL,             .recv = hci_recv_frame    },\\n\\t{ H4_RECV_SCO,             .recv = hci_recv_frame    },\\n\\t{ H4_RECV_EVENT,           .recv = hci_recv_frame    },\\n\\t{ QCA_IBS_WAKE_IND_EVENT,  .recv = qca_ibs_wake_ind  },\\n\\t{ QCA_IBS_WAKE_ACK_EVENT,  .recv = qca_ibs_wake_ack  },\\n\\t{ QCA_IBS_SLEEP_IND_EVENT, .recv = qca_ibs_sleep_ind },\\n};\\n\\nstatic int qca_recv(struct hci_uart *hu, const void *data, int count)\\n{\\n\\tstruct qca_data *qca = hu->priv;\\n\\n\\tif (!test_bit(HCI_UART_REGISTERED, &hu->flags))\\n\\t\\treturn -EUNATCH;\\n\\n\\tqca->rx_skb = h4_recv_buf(hu->hdev, qca->rx_skb, data, count,\\n\\t\\t\\t\\t  qca_recv_pkts, ARRAY_SIZE(qca_recv_pkts));\\n\\tif (IS_ERR(qca->rx_skb)) {\\n\\t\\tint err = PTR_ERR(qca->rx_skb);\\n\\t\\tBT_ERR(\\\"%s: Frame reassembly failed (%d)\\\", hu->hdev->name, err);\\n\\t\\tqca->rx_skb = NULL;\\n\\t\\treturn err;\\n\\t}\\n\\n\\treturn count;\\n}\\n\\nstatic struct sk_buff *qca_dequeue(struct hci_uart *hu)\\n{\\n\\tstruct qca_data *qca = hu->priv;\\n\\n\\treturn skb_dequeue(&qca->txq);\\n}\\n\\nstatic uint8_t qca_get_baudrate_value(int speed)\\n{\\n\\tswitch (speed) {\\n\\tcase 9600:\\n\\t\\treturn QCA_BAUDRATE_9600;\\n\\tcase 19200:\\n\\t\\treturn QCA_BAUDRATE_19200;\\n\\tcase 38400:\\n\\t\\treturn QCA_BAUDRATE_38400;\\n\\tcase 57600:\\n\\t\\treturn QCA_BAUDRATE_57600;\\n\\tcase 115200:\\n\\t\\treturn QCA_BAUDRATE_115200;\\n\\tcase 230400:\\n\\t\\treturn QCA_BAUDRATE_230400;\\n\\tcase 460800:\\n\\t\\treturn QCA_BAUDRATE_460800;\\n\\tcase 500000:\\n\\t\\treturn QCA_BAUDRATE_500000;\\n\\tcase 921600:\\n\\t\\treturn QCA_BAUDRATE_921600;\\n\\tcase 1000000:\\n\\t\\treturn QCA_BAUDRATE_1000000;\\n\\tcase 2000000:\\n\\t\\treturn QCA_BAUDRATE_2000000;\\n\\tcase 3000000:\\n\\t\\treturn QCA_BAUDRATE_3000000;\\n\\tcase 3500000:\\n\\t\\treturn QCA_BAUDRATE_3500000;\\n\\tdefault:\\n\\t\\treturn QCA_BAUDRATE_115200;\\n\\t}\\n}\\n\\nstatic int qca_set_baudrate(struct hci_dev *hdev, uint8_t baudrate)\\n{\\n\\tstruct hci_uart *hu = hci_get_drvdata(hdev);\\n\\tstruct qca_data *qca = hu->priv;\\n\\tstruct sk_buff *skb;\\n\\tu8 cmd[] = { 0x01, 0x48, 0xFC, 0x01, 0x00 };\\n\\n\\tif (baudrate > QCA_BAUDRATE_3000000)\\n\\t\\treturn -EINVAL;\\n\\n\\tcmd[4] = baudrate;\\n\\n\\tskb = bt_skb_alloc(sizeof(cmd), GFP_ATOMIC);\\n\\tif (!skb) {\\n\\t\\tBT_ERR(\\\"Failed to allocate memory for baudrate packet\\\");\\n\\t\\treturn -ENOMEM;\\n\\t}\\n\\n\\t/* Assign commands to change baudrate and packet type. */\\n\\tmemcpy(skb_put(skb, sizeof(cmd)), cmd, sizeof(cmd));\\n\\thci_skb_pkt_type(skb) = HCI_COMMAND_PKT;\\n\\n\\tskb_queue_tail(&qca->txq, skb);\\n\\thci_uart_tx_wakeup(hu);\\n\\n\\t/* wait 300ms to change new baudrate on controller side\\n\\t * controller will come back after they receive this HCI command\\n\\t * then host can communicate with new baudrate to controller\\n\\t */\\n\\tset_current_state(TASK_UNINTERRUPTIBLE);\\n\\tschedule_timeout(msecs_to_jiffies(BAUDRATE_SETTLE_TIMEOUT_MS));\\n\\tset_current_state(TASK_INTERRUPTIBLE);\\n\\n\\treturn 0;\\n}\\n\\nstatic int qca_setup(struct hci_uart *hu)\\n{\\n\\tstruct hci_dev *hdev = hu->hdev;\\n\\tstruct qca_data *qca = hu->priv;\\n\\tunsigned int speed, qca_baudrate = QCA_BAUDRATE_115200;\\n\\tint ret;\\n\\n\\tBT_INFO(\\\"%s: ROME setup\\\", hdev->name);\\n\\n\\t/* Patch downloading has to be done without IBS mode */\\n\\tclear_bit(STATE_IN_BAND_SLEEP_ENABLED, &qca->flags);\\n\\n\\t/* Setup initial baudrate */\\n\\tspeed = 0;\\n\\tif (hu->init_speed)\\n\\t\\tspeed = hu->init_speed;\\n\\telse if (hu->proto->init_speed)\\n\\t\\tspeed = hu->proto->init_speed;\\n\\n\\tif (speed)\\n\\t\\thci_uart_set_baudrate(hu, speed);\\n\\n\\t/* Setup user speed if needed */\\n\\tspeed = 0;\\n\\tif (hu->oper_speed)\\n\\t\\tspeed = hu->oper_speed;\\n\\telse if (hu->proto->oper_speed)\\n\\t\\tspeed = hu->proto->oper_speed;\\n\\n\\tif (speed) {\\n\\t\\tqca_baudrate = qca_get_baudrate_value(speed);\\n\\n\\t\\tBT_INFO(\\\"%s: Set UART speed to %d\\\", hdev->name, speed);\\n\\t\\tret = qca_set_baudrate(hdev, qca_baudrate);\\n\\t\\tif (ret) {\\n\\t\\t\\tBT_ERR(\\\"%s: Failed to change the baud rate (%d)\\\",\\n\\t\\t\\t       hdev->name, ret);\\n\\t\\t\\treturn ret;\\n\\t\\t}\\n\\t\\thci_uart_set_baudrate(hu, speed);\\n\\t}\\n\\n\\t/* Setup patch / NVM configurations */\\n\\tret = qca_uart_setup_rome(hdev, qca_baudrate);\\n\\tif (!ret) {\\n\\t\\tset_bit(STATE_IN_BAND_SLEEP_ENABLED, &qca->flags);\\n\\t\\tqca_debugfs_init(hdev);\\n\\t}\\n\\n\\t/* Setup bdaddr */\\n\\thu->hdev->set_bdaddr = qca_set_bdaddr_rome;\\n\\n\\treturn ret;\\n}\\n\\nstatic struct hci_uart_proto qca_proto = {\\n\\t.id\\t\\t= HCI_UART_QCA,\\n\\t.name\\t\\t= \\\"QCA\\\",\\n\\t.manufacturer\\t= 29,\\n\\t.init_speed\\t= 115200,\\n\\t.oper_speed\\t= 3000000,\\n\\t.open\\t\\t= qca_open,\\n\\t.close\\t\\t= qca_close,\\n\\t.flush\\t\\t= qca_flush,\\n\\t.setup\\t\\t= qca_setup,\\n\\t.recv\\t\\t= qca_recv,\\n\\t.enqueue\\t= qca_enqueue,\\n\\t.dequeue\\t= qca_dequeue,\\n};\\n\\nint __init qca_init(void)\\n{\\n\\treturn hci_uart_register_proto(&qca_proto);\\n}\\n\\nint __exit qca_deinit(void)\\n{\\n\\treturn hci_uart_unregister_proto(&qca_proto);\\n}\\n\";\n\n/***/ }),\n/* 65 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t!function () {\n\t\n\t\tnavigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\n\t\n\t\tvar chars = ['@', '#', '$', '=', '*', '!', ';', ':', '~', '-', ',', '.', '&nbsp;', '&nbsp;'];\n\t\n\t\tchars = [\"&nbsp;\", \"&nbsp;\", \".\", \",\", \"-\", \"~\", \":\", \";\", \"!\", \"*\", \"=\", \"$\", \"#\", \"@\"];\n\t\tvar charLen = chars.length - 1;\n\t\tfunction getChar(val) {\n\t\t\treturn chars[parseInt(val * charLen, 10)];\n\t\t}\n\t\n\t\tfunction logError(err) {\n\t\t\tif (console && console.log) console.log('Error!', err);return false;\n\t\t}\n\t\n\t\tfunction Jscii(params) {\n\t\t\tvar self = this;\n\t\n\t\t\tvar el = this.el = params.el;\n\t\t\tthis.container = params.container;\n\t\t\tthis.fn = typeof params.fn === 'function' ? params.fn : null;\n\t\t\tthis.width = typeof params.width === 'number' ? params.width : 150;\n\t\t\tthis.color = !!params.color;\n\t\n\t\t\tthis.canvas = document.createElement('canvas');\n\t\t\tthis.ctx = this.canvas.getContext('2d');\n\t\t\tvar nodeName = el.nodeName;\n\t\t\tif (nodeName === 'IMG') {\n\t\t\t\tself.render();\n\t\t\t\tel.addEventListener('load', function () {\n\t\t\t\t\tself.render();\n\t\t\t\t});\n\t\t\t} else if (nodeName === 'VIDEO') {\n\t\t\t\tthis.interval = typeof params.interval === 'number' ? params.interval : 15;\n\t\t\t\tthis.webrtc = !!params.webrtc;\n\t\n\t\t\t\tif (this.webrtc) {\n\t\t\t\t\tif (typeof navigator.getUserMedia !== 'function') {\n\t\t\t\t\t\treturn logError(el.innerHTML = 'Error: browser does not support WebRTC');\n\t\t\t\t\t}\n\t\t\t\t\tnavigator.getUserMedia({ video: true, audio: false }, function (localMediaStream) {\n\t\t\t\t\t\tself.mediaStream = localMediaStream;\n\t\t\t\t\t\tel.src = (window.URL || window.webkitURL).createObjectURL(localMediaStream);\n\t\t\t\t\t}, logError);\n\t\t\t\t}\n\t\t\t\tel.addEventListener('loadeddata', function () {\n\t\t\t\t\tself.play();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\n\t\tJscii.prototype.play = function () {\n\t\t\tvar self = this;\n\t\t\tself.pause().videoTimer = setInterval(function () {\n\t\t\t\tif (self.mediaStream || !self.webrtc) self.render();\n\t\t\t}, self.interval);\n\t\t\treturn self;\n\t\t};\n\t\n\t\tJscii.prototype.pause = function () {\n\t\t\tif (this.videoTimer) clearInterval(this.videoTimer);\n\t\t\treturn this;\n\t\t};\n\t\n\t\tJscii.prototype.dimension = function (width, height) {\n\t\t\tif (typeof width === 'number' && typeof height === 'number') {\n\t\t\t\tthis._scaledWidth = this.canvas.width = width;\n\t\t\t\tthis._scaledHeight = this.canvas.height = height;\n\t\t\t\treturn this;\n\t\t\t} else {\n\t\t\t\treturn { width: this._scaledWidth, height: this._scaledHeight };\n\t\t\t}\n\t\t};\n\t\n\t\tJscii.prototype.render = function () {\n\t\t\tvar el = this.el,\n\t\t\t    nodeName = el.nodeName,\n\t\t\t    ratio;\n\t\t\tvar dim = this.dimension(),\n\t\t\t    width,\n\t\t\t    height;\n\t\t\tif (!dim.width || !dim.height) {\n\t\t\t\tratio = nodeName === 'IMG' ? el.height / el.width : el.videoHeight / el.videoWidth;\n\t\t\t\tthis.dimension(this.width, parseInt(this.width * ratio, 10));\n\t\t\t\tdim = this.dimension();\n\t\t\t}\n\t\t\twidth = dim.width;\n\t\t\theight = dim.height;\n\t\n\t\t\tif (!width || !height) return;\n\t\n\t\t\tthis.ctx.drawImage(this.el, 0, 0, width, height);\n\t\t\tthis.imageData = this.ctx.getImageData(0, 0, width, height).data;\n\t\t\tvar asciiStr = this.getAsciiString();\n\t\t\tif (this.container) this.container.innerHTML = asciiStr;\n\t\t\tif (this.fn) this.fn(asciiStr);\n\t\t};\n\t\n\t\tJscii.prototype.getAsciiString = function () {\n\t\t\tvar dim = this.dimension(),\n\t\t\t    width = dim.width,\n\t\t\t    height = dim.height;\n\t\t\tvar len = width * height,\n\t\t\t    d = this.imageData,\n\t\t\t    str = '';\n\t\n\t\t\tvar getRGB = function getRGB(i) {\n\t\t\t\treturn [d[i = i * 4], d[i + 1], d[i + 2]];\n\t\t\t};\n\t\n\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\tif (i % width === 0) str += '\\n';\n\t\t\t\tvar rgb = getRGB(i);\n\t\t\t\tvar val = Math.max(rgb[0], rgb[1], rgb[2]) / 255;\n\t\t\t\tif (this.color) str += '<font style=\"color: rgb(' + rgb.join(',') + ')\">' + getChar(val) + '</font>';else str += getChar(val);\n\t\t\t}\n\t\t\treturn str;\n\t\t};\n\t\n\t\twindow.Jscii = Jscii;\n\t}();\n\n/***/ }),\n/* 66 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _lodash = __webpack_require__(7);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction RuleGenerator(args) {\n\t  this.selectionCount = {};\n\t  this.improvisers = args.improvisers;\n\t  this.ruleData = _lodash2.default.clone(args.ruleData);\n\t  this.allowRepeats = args.allowRepeats ? args.allowRepeats : false;\n\t}\n\t\n\tRuleGenerator.prototype.incrementSelectionCount = function (name) {\n\t  this.selectionCount[name] = this.selectionCount[name] ? this.selectionCount[name] + 1 : 1;\n\t};\n\t\n\tRuleGenerator.prototype.getSelectionCount = function (name) {\n\t  return typeof this.selectionCount[name] == 'undefined' ? 0 : this.selectionCount[name];\n\t};\n\t\n\tRuleGenerator.prototype.sortBySelectionCount = function (people) {\n\t  var _this = this;\n\t\n\t  return people.sort(function (person1, person2) {\n\t    return _this.getSelectionCount(person1.name) - _this.getSelectionCount(person2.name);\n\t  });\n\t};\n\t\n\tRuleGenerator.prototype.getBySelectionCount = function (people) {\n\t  this.shuffle(people);\n\t  this.sortBySelectionCount(people);\n\t  var person = people[0];\n\t  this.incrementSelectionCount(person.name);\n\t  return person;\n\t};\n\t\n\tRuleGenerator.prototype.shuffle = function (a) {\n\t  for (var i = a.length; i; i--) {\n\t    var j = Math.floor(Math.random() * i);\n\t    var _ref = [a[j], a[i - 1]];\n\t    a[i - 1] = _ref[0];\n\t    a[j] = _ref[1];\n\t  }\n\t};\n\t\n\tRuleGenerator.prototype.random = function (arr) {\n\t  var person = arr[parseInt(Math.random() * arr.length)];\n\t  return person;\n\t};\n\t\n\tRuleGenerator.prototype.randInd = function (arr) {\n\t  return parseInt(Math.random() * arr.length);\n\t};\n\t\n\tRuleGenerator.prototype.selectRule = function (rules) {\n\t  var r = Math.random();\n\t  for (var i = 0; i < rules.length; i++) {\n\t    if (rules[i].probCeil > r) return rules[i];\n\t  }\n\t};\n\t\n\tRuleGenerator.prototype.generateReverseRuleText = function (ruleGen, ruleFills) {\n\t  var index = 0;\n\t  var improviser = void 0,\n\t      uniqueImproviser = void 0,\n\t      getWord = void 0,\n\t      ruleFill = void 0,\n\t      pronoun = void 0;\n\t  improviser = uniqueImproviser = getWord = pronoun = function pronoun() {\n\t    ruleFill = ruleFills[index];\n\t    index++;\n\t    return ruleFill;\n\t  };\n\t  if (ruleGen.reverseTemplate.length == 0) {\n\t    return eval(ruleGen.reverseTemplate);\n\t  }\n\t\n\t  var rule = eval(ruleGen.template);\n\t\n\t  var improviserName = ruleFills[0];\n\t  if (rule.match(improviserName + ' is ')) {\n\t    return rule.replace(improviserName + ' is ', improviserName + ' is no longer ');\n\t  } else if (rule.match(improviserName + ' ')) {\n\t    return rule.replace(improviserName + ' ', improviserName + ' no longer ');\n\t  }\n\t\n\t  return 'The following rule no longer applies: ' + rule;\n\t};\n\t\n\tRuleGenerator.prototype.sentenceify = function (s) {\n\t  s = s.charAt(0).toUpperCase() + s.slice(1);\n\t  s = s.charAt(s.length - 1) == '.' ? s : s + '.';\n\t  return s;\n\t};\n\t\n\tRuleGenerator.prototype.generateRule = function (ruleIndex) {\n\t  var _this2 = this;\n\t\n\t  var ruleFills = [];\n\t\n\t  var uniqueImprovisers = _lodash2.default.clone(this.improvisers);\n\t\n\t  var improviser = function improviser() {\n\t    var choices = _this2.improvisers.concat({\n\t      name: 'everyone',\n\t      pronouns: {\n\t        subjective: 'they',\n\t        objective: 'them',\n\t        possessive: 'their'\n\t      }\n\t    });\n\t    var ans = _this2.getBySelectionCount(choices).name;\n\t    ruleFills.push(ans);\n\t    return ans;\n\t  };\n\t\n\t  var uniqueImproviser = function uniqueImproviser() {\n\t    var ans = _this2.getBySelectionCount(uniqueImprovisers);\n\t    uniqueImprovisers.splice(uniqueImprovisers.indexOf(ans), 1);\n\t    ruleFills.push(ans.name);\n\t    return ans.name;\n\t  };\n\t\n\t  var getWord = function getWord(category) {\n\t    var ans = _this2.random(_this2.ruleData.words[category]);\n\t    ruleFills.push(ans);\n\t    return ans;\n\t  };\n\t\n\t  var pronoun = function pronoun(tense) {\n\t    var pronoun = null;\n\t    var person = _this2.improvisers.concat({\n\t      name: 'everyone',\n\t      pronouns: {\n\t        subjective: 'they',\n\t        objective: 'them',\n\t        possessive: 'their'\n\t      }\n\t    }).find(function (p) {\n\t      return ruleFills.indexOf(p.name) > -1;\n\t    });\n\t    if (!person) {\n\t      person = _this2.improvisers[0];\n\t      console.log('pronoun uh oh');\n\t    }\n\t    if (tense == 'objective' || tense == 'possessive') {\n\t      pronoun = person.pronouns[tense];\n\t    } else {\n\t      pronoun = person.pronouns.subjective;\n\t    }\n\t    ruleFills.push(pronoun);\n\t    return pronoun;\n\t  };\n\t\n\t  var parseRuleGen = function parseRuleGen(ruleGen) {\n\t    return eval(ruleGen.template);\n\t  };\n\t\n\t  var selectedRule = typeof ruleIndex == 'number' ? this.ruleData.rules[ruleIndex] : this.selectRule(this.ruleData.rules);\n\t\n\t  if (!this.allowRepeats) {\n\t    this.ruleData.rules.splice(this.ruleData.rules.indexOf(selectedRule), 1);\n\t  }\n\t\n\t  var rule = parseRuleGen(selectedRule);\n\t\n\t  rule = rule.replace('they has', 'they have');\n\t  rule = rule.replace('they is', 'they are');\n\t\n\t  return {\n\t    text: this.sentenceify(rule),\n\t    removalText: this.sentenceify(this.generateReverseRuleText(selectedRule, ruleFills)),\n\t    removing: false,\n\t    lateGame: selectedRule.lateGame,\n\t    isCommand: selectedRule.isCommand,\n\t    maxDuration: selectedRule.maxDuration,\n\t    timeCreated: Date.now()\n\t  };\n\t};\n\t\n\texports.default = RuleGenerator;\n\n/***/ }),\n/* 67 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _toConsumableArray2 = __webpack_require__(69);\n\t\n\tvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\t\n\tvar _lodash = __webpack_require__(7);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tmodule.exports = {\n\t\tFlip15: function Flip15(durationOfShow) {\n\t\t\tvar _this = this;\n\t\n\t\t\tthis.durationOfShow = durationOfShow;\n\t\t\tthis.timeCreated = Date.now();\n\t\t\tthis.activeRules = 0;\n\t\t\tthis.timeOfLastRule = 0;\n\t\t\tthis.timeOfLastFlip = 0;\n\t\n\t\t\tthis.getAction = function (timeElapsed) {\n\t\t\t\tif (!timeElapsed) {\n\t\t\t\t\ttimeElapsed = Date.now() - _this.timeCreated;;\n\t\t\t\t}\n\t\t\t\tvar timeSinceLastRule = timeElapsed - _this.timeOfLastRule;\n\t\t\t\tvar timeSinceLastFlip = timeElapsed - _this.timeOfLastFlip;\n\t\t\t\tvar percentComplete = timeElapsed / _this.durationOfShow;\n\t\t\t\tvar perComSq = timeElapsed * timeElapsed / (_this.durationOfShow * _this.durationOfShow);\n\t\t\t\tif (timeElapsed > durationOfShow) {\n\t\t\t\t\treturn 'end show';\n\t\t\t\t}\n\t\t\t\tif (timeElapsed < 90 * 1000) {\n\t\t\t\t\treturn 'nothing';\n\t\t\t\t}\n\t\t\t\tif (timeSinceLastFlip > 15000) {\n\t\t\t\t\t_this.timeOfLastFlip = timeElapsed;\n\t\n\t\t\t\t\tvar removeOdds = (Math.pow(_this.activeRules, 3) + 4) * ((1 - perComSq) * .8 + .2);\n\t\t\t\t\tvar addOdds = perComSq * 30 + 4;\n\t\t\t\t\tvar nothingOdds = Math.max(1 - timeSinceLastRule / (90 * 1000), 0) * ((1 - percentComplete) * 100);\n\t\n\t\t\t\t\tvar sum = removeOdds + addOdds + nothingOdds;\n\t\t\t\t\tvar removeBound = removeOdds / sum;\n\t\t\t\t\tvar addBound = addOdds / sum + removeBound;\n\t\n\t\t\t\t\tvar r = Math.random();\n\t\t\t\t\tif (r < removeBound) {\n\t\t\t\t\t\tif (_this.activeRules > 0) {\n\t\t\t\t\t\t\t_this.activeRules--;\n\t\t\t\t\t\t\treturn 'removeRule';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (r < addBound) {\n\t\t\t\t\t\t_this.timeOfLastRule = timeElapsed;\n\t\t\t\t\t\t_this.activeRules++;\n\t\t\t\t\t\treturn 'addRule';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 'nothing';\n\t\t\t};\n\t\t},\n\t\tEvery15: function Every15(durationOfShow) {\n\t\t\tvar _this2 = this;\n\t\n\t\t\tthis.durationOfShow = durationOfShow;\n\t\t\tthis.timeCreated = Date.now();\n\t\t\tthis.activeRules = 0;\n\t\t\tthis.timeOfLastRule = 0;\n\t\t\tthis.timeOfLastFlip = 0;\n\t\n\t\t\tthis.getAction = function () {\n\t\t\t\tvar timeElapsed = Date.now() - _this2.timeCreated;\n\t\t\t\tvar timeSinceLastRule = Date.now() - _this2.timeOfLastRule;\n\t\t\t\tvar timeSinceLastFlip = Date.now() - _this2.timeOfLastFlip;\n\t\t\t\tvar percentComplete = timeElapsed / _this2.durationOfShow;\n\t\t\t\tif (timeSinceLastFlip > 15000) {\n\t\t\t\t\t_this2.timeOfLastFlip = Date.now();\n\t\t\t\t\tif (Math.random() < _this2.activeRules / (10 * percentComplete + 2)) {\n\t\t\t\t\t\t_this2.activeRules--;\n\t\t\t\t\t\treturn 'removeRule';\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_this2.timeOfLastRule = Date.now();\n\t\t\t\t\t\t_this2.activeRules++;\n\t\t\t\t\t\treturn 'addRule';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 'nothing';\n\t\t\t};\n\t\t},\n\t\tJustClose: function JustClose(durationOfShow) {\n\t\t\tthis.getAction = function () {\n\t\t\t\treturn 'end show';\n\t\t\t};\n\t\t},\n\t\tHandCrafted: function HandCrafted(options) {\n\t\t\tvar _this3 = this;\n\t\n\t\t\t_lodash2.default.extend(this, options);\n\t\n\t\t\tthis.activeRules = [];\n\t\t\tthis.ruleSelectCount = {};\n\t\n\t\t\tthis.selectRule = function (rules) {\n\t\t\t\tvar r = Math.random();\n\t\t\t\tfor (var i = 0; i < rules.length; i++) {\n\t\t\t\t\tif (rules[i].probCeil > r) {\n\t\t\t\t\t\twhile (_this3.ruleSelectCount[rules[i].template] >= 1) {\n\t\t\t\t\t\t\ti = (i + 1) % rules.length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_this3.ruleSelectCount[rules[i].template] = _this3.ruleSelectCount[rules[i].template] ? _this3.ruleSelectCount[rules[i].template] + 1 : 1;\n\t\t\t\t\t\tconsole.log(i);\n\t\t\t\t\t\treturn rules[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tthis.distribution = function (x) {\n\t\t\t\treturn x * x;\n\t\t\t};\n\t\n\t\t\tthis.times = [];\n\t\t\tfor (var i = 0; i < parseInt(this.showDuration / 1000 / 60) * 2; i++) {\n\t\t\t\tthis.times.push(this.distribution(i + 1));\n\t\t\t}\n\t\n\t\t\tvar max = Math.max.apply(Math, (0, _toConsumableArray3.default)(this.times));\n\t\n\t\t\tthis.times = this.times.map(function (t) {\n\t\t\t\treturn _this3.showDuration - t / max * (_this3.showDuration - 90 * 1000);\n\t\t\t});\n\t\t\tthis.times.reverse();\n\t\n\t\t\tthis.actions = [];\n\t\n\t\t\tthis.times.forEach(function (time) {\n\t\t\t\tvar rule = _this3.selectRule(_this3.ruleGens.rules);\n\t\n\t\t\t\tconsole.log('selectedRule', rule);\n\t\t\t\tvar compiledRule = _this3.generateRule({\n\t\t\t\t\tselectedRule: rule,\n\t\t\t\t\truleGens: _this3.ruleGens,\n\t\t\t\t\timprovisers: _this3.improvisers\n\t\t\t\t});\n\t\t\t\t_this3.activeRules.push(compiledRule);\n\t\n\t\t\t\t_this3.actions.push({\n\t\t\t\t\tfunc: _this3.addRule,\n\t\t\t\t\trule: compiledRule,\n\t\t\t\t\ttime: time\n\t\t\t\t});\n\t\t\t\t_this3.actions.push({\n\t\t\t\t\tfunc: _this3.removeRule,\n\t\t\t\t\trule: compiledRule,\n\t\t\t\t\ttime: time + (Math.random() * 90 + 30) * 1000\n\t\t\t\t});\n\t\t\t});\n\t\n\t\t\tthis.actions.sort(function (a, b) {\n\t\t\t\treturn a.time - b.time;\n\t\t\t});\n\t\n\t\t\tconsole.log('actions', this.actions);\n\t\n\t\t\tvar rule = this.ruleGens.rules[23];\n\t\t\tconsole.log('selectedRule', rule);\n\t\t\tvar compiledRule = this.generateRule({\n\t\t\t\tselectedRule: rule,\n\t\t\t\truleGens: this.ruleGens,\n\t\t\t\timprovisers: this.improvisers\n\t\t\t});\n\t\t\tthis.activeRules.push(compiledRule);\n\t\t\tthis.addRule(rule);\n\t\n\t\t\tsetTimeout(function () {\n\t\t\t\tconsole.log('remove timeout strategy', rule);\n\t\t\t\t_this3.removeRule(rule);\n\t\t\t}, 10000);\n\t\n\t\t\tthis.startTime = 0;\n\t\n\t\t\tthis.start = function () {\n\t\t\t\treturn;\n\t\t\t\t_this3.startTime = Date.now();\n\t\t\t\tvar actionQueue = [];\n\t\t\t\tsetInterval(function () {\n\t\t\t\t\tvar elapsedTime = Date.now() - _this3.startTime;\n\t\t\t\t\t_this3.actions.forEach(function (action) {\n\t\t\t\t\t\tif (action.time < elapsedTime) {\n\t\t\t\t\t\t\tactionQueue.push(action);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t_this3.actions = _this3.actions.filter(function (action) {\n\t\t\t\t\t\treturn actionQueue.indexOf(action) == -1;\n\t\t\t\t\t});\n\t\n\t\t\t\t\tvar action = actionQueue.shift();\n\t\t\t\t\taction.func(action.rule);\n\t\t\t\t\tconsole.log(action, actionQueue, _this3.actions);\n\t\t\t\t}, 15000);\n\t\t\t};\n\t\t}\n\t};\n\n/***/ }),\n/* 68 */,\n/* 69 */,\n/* 70 */,\n/* 71 */,\n/* 72 */,\n/* 73 */,\n/* 74 */,\n/* 75 */,\n/* 76 */,\n/* 77 */,\n/* 78 */,\n/* 79 */,\n/* 80 */,\n/* 81 */,\n/* 82 */,\n/* 83 */,\n/* 84 */,\n/* 85 */,\n/* 86 */,\n/* 87 */,\n/* 88 */,\n/* 89 */,\n/* 90 */,\n/* 91 */,\n/* 92 */,\n/* 93 */,\n/* 94 */,\n/* 95 */,\n/* 96 */,\n/* 97 */,\n/* 98 */,\n/* 99 */,\n/* 100 */,\n/* 101 */,\n/* 102 */,\n/* 103 */,\n/* 104 */,\n/* 105 */,\n/* 106 */,\n/* 107 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 108 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 109 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 110 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 111 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 112 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 113 */\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 114 */,\n/* 115 */,\n/* 116 */,\n/* 117 */,\n/* 118 */,\n/* 119 */,\n/* 120 */,\n/* 121 */,\n/* 122 */,\n/* 123 */,\n/* 124 */,\n/* 125 */,\n/* 126 */,\n/* 127 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"static/img/amy.a7fc195.png\";\n\n/***/ }),\n/* 128 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"static/img/charna.aeb5628.png\";\n\n/***/ }),\n/* 129 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"static/img/del.92abdc1.png\";\n\n/***/ }),\n/* 130 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"static/img/ian.638d02f.png\";\n\n/***/ }),\n/* 131 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"static/img/keith.6b63371.png\";\n\n/***/ }),\n/* 132 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"static/img/tj.3bd54f1.png\";\n\n/***/ }),\n/* 133 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"static/img/viola.8d75b50.png\";\n\n/***/ }),\n/* 134 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(113)\n\t\n\tvar Component = __webpack_require__(2)(\n\t  /* script */\n\t  __webpack_require__(56),\n\t  /* template */\n\t  __webpack_require__(147),\n\t  /* scopeId */\n\t  null,\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n/* 135 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(108)\n\t\n\tvar Component = __webpack_require__(2)(\n\t  /* script */\n\t  __webpack_require__(57),\n\t  /* template */\n\t  __webpack_require__(142),\n\t  /* scopeId */\n\t  \"data-v-1aa94ace\",\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n/* 136 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(109)\n\t\n\tvar Component = __webpack_require__(2)(\n\t  /* script */\n\t  __webpack_require__(58),\n\t  /* template */\n\t  __webpack_require__(143),\n\t  /* scopeId */\n\t  \"data-v-21244a73\",\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n/* 137 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(112)\n\t\n\tvar Component = __webpack_require__(2)(\n\t  /* script */\n\t  __webpack_require__(59),\n\t  /* template */\n\t  __webpack_require__(146),\n\t  /* scopeId */\n\t  \"data-v-4a3f67a6\",\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n/* 138 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(110)\n\t\n\tvar Component = __webpack_require__(2)(\n\t  /* script */\n\t  __webpack_require__(60),\n\t  /* template */\n\t  __webpack_require__(144),\n\t  /* scopeId */\n\t  \"data-v-2b47f138\",\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n/* 139 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(107)\n\t\n\tvar Component = __webpack_require__(2)(\n\t  /* script */\n\t  __webpack_require__(61),\n\t  /* template */\n\t  __webpack_require__(141),\n\t  /* scopeId */\n\t  \"data-v-1a948596\",\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n/* 140 */\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    attrs: {\n\t      \"id\": \"type-and-say\"\n\t    }\n\t  }, [_c('TypeWriter', {\n\t    attrs: {\n\t      \"volume\": _vm.typingVolume,\n\t      \"timeout\": _vm.timeout\n\t    }\n\t  }, [_vm._t(\"default\")], 2)], 1)\n\t},staticRenderFns: []}\n\n/***/ }),\n/* 141 */\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    attrs: {\n\t      \"id\": \"simulation\"\n\t    },\n\t    on: {\n\t      \"click\": _vm.simulateShow\n\t    }\n\t  }, [_c('h1', [_vm._v(\"Click me to simulate a show\")]), _vm._v(\" \"), _c('div', {\n\t    attrs: {\n\t      \"id\": \"timeline\"\n\t    }\n\t  }, _vm._l((_vm.actions), function(action, i) {\n\t    return _c('div', {\n\t      staticClass: \"action\",\n\t      style: ({\n\t        left: (i / _vm.actions.length * 100) + '%'\n\t      })\n\t    }, [(action.action != 'doNothing') ? _c('div', [_c('div', {\n\t      staticClass: \"rules\",\n\t      style: ({\n\t        height: action.rules * 8 + 18 + 'px',\n\t        top: -action.rules * 8 - 18 + 'px'\n\t      })\n\t    }, [_vm._v(\"\\n\\t\\t\\t\\t\\t\" + _vm._s(action.rules) + \"\\n\\t\\t\\t\\t\")]), _vm._v(\" \"), _c('div', {\n\t      staticClass: \"message\",\n\t      style: ({\n\t        height: _vm.meaningfulActions.indexOf(action) % 5 * 50 + 50 + 'px'\n\t      })\n\t    }, [_c('span', {\n\t      staticClass: \"text\"\n\t    }, [_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\" + _vm._s(action.action) + \" \" + _vm._s(_vm.formatTime(action.time)) + \"\\n\\t\\t\\t\\t\\t\")]), _vm._v(\" \"), _c('span', {\n\t      staticClass: \"rule-text\"\n\t    }, [_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\" + _vm._s(action.ruleText) + \"\\n\\t\\t\\t\\t\\t\")])])]) : _vm._e()])\n\t  }))])\n\t},staticRenderFns: []}\n\n/***/ }),\n/* 142 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    staticClass: \"ascii-image\",\n\t    class: {\n\t      loaded: _vm.asciiLoaded\n\t    }\n\t  }, [_c('img', {\n\t    attrs: {\n\t      \"id\": \"image-del\",\n\t      \"src\": __webpack_require__(129)\n\t    }\n\t  }), _vm._v(\" \"), _c('img', {\n\t    attrs: {\n\t      \"id\": \"image-amy\",\n\t      \"src\": __webpack_require__(127)\n\t    }\n\t  }), _vm._v(\" \"), _c('img', {\n\t    attrs: {\n\t      \"id\": \"image-charna\",\n\t      \"src\": __webpack_require__(128)\n\t    }\n\t  }), _vm._v(\" \"), _c('img', {\n\t    attrs: {\n\t      \"id\": \"image-keith\",\n\t      \"src\": __webpack_require__(131)\n\t    }\n\t  }), _vm._v(\" \"), _c('img', {\n\t    attrs: {\n\t      \"id\": \"image-tj\",\n\t      \"src\": __webpack_require__(132)\n\t    }\n\t  }), _vm._v(\" \"), _c('img', {\n\t    attrs: {\n\t      \"id\": \"image-ian\",\n\t      \"src\": __webpack_require__(130)\n\t    }\n\t  }), _vm._v(\" \"), _c('img', {\n\t    attrs: {\n\t      \"id\": \"image-viola\",\n\t      \"src\": __webpack_require__(133)\n\t    }\n\t  }), _vm._v(\" \"), _c('pre', {\n\t    staticClass: \"ascii-text\"\n\t  }, [_vm._v(\"\\n    \" + _vm._s(_vm.text) + \"\\n  \")]), _vm._v(\" \"), _c('div', {\n\t    staticClass: \"loading-cover\"\n\t  })])\n\t},staticRenderFns: []}\n\n/***/ }),\n/* 143 */\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    attrs: {\n\t      \"id\": \"boot-animation\"\n\t    }\n\t  }, [(_vm.step == 'fakeCode') ? _c('div', {\n\t    attrs: {\n\t      \"id\": \"fakecode\"\n\t    }\n\t  }, [_c('pre', [_vm._v(\"\\n        \"), _c('TypeWriter', {\n\t    attrs: {\n\t      \"timeout\": 40,\n\t      \"spliton\": '\\n'\n\t    }\n\t  }, [_vm._v(_vm._s(_vm.fakeCode))]), _vm._v(\"\\n      \")], 1)]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'greenFlash') ? _c('div', {\n\t    staticClass: \"glitch\",\n\t    attrs: {\n\t      \"id\": \"green-flash\"\n\t    }\n\t  }) : _vm._e(), _vm._v(\" \"), (_vm.step == 'ascii') ? _c('div', {\n\t    attrs: {\n\t      \"id\": \"ascii\"\n\t    }\n\t  }, [_c('pre', {\n\t    attrs: {\n\t      \"id\": \"loading\"\n\t    }\n\t  }, [_vm._v(\"\\n        \"), _c('TypeWriter', {\n\t    attrs: {\n\t      \"timeout\": 60\n\t    }\n\t  }, [_vm._v(\"\\n\\nCalibrating comedic timing...\\nNullifying transactions...\\nFinding light...\\nSimulating montage...\\n\\n        \")]), _vm._v(\"        \\n      \")], 1), _vm._v(\" \"), _c('AsciiImage', {\n\t    attrs: {\n\t      \"imagename\": _vm.asciiName\n\t    }\n\t  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.step == 'title') ? _c('div', {\n\t    class: {\n\t      inverted: _vm.titleInverted\n\t    },\n\t    attrs: {\n\t      \"id\": \"title\"\n\t    }\n\t  }, [_c('div', [_vm._v(\"IMPROV\")]), _vm._v(\" \"), _c('div', [_vm._v(\"GOD\")])]) : _vm._e()])\n\t},staticRenderFns: []}\n\n/***/ }),\n/* 144 */\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    attrs: {\n\t      \"id\": \"rules\"\n\t    }\n\t  }, [(_vm.step == 'board') ? _c('div', [_c('div', {\n\t    attrs: {\n\t      \"id\": \"board-title\"\n\t    }\n\t  }, [_vm._v(\"\\n        Active Rules\\n\")]), _vm._v(\" \"), _c('div', {\n\t    attrs: {\n\t      \"id\": \"board\"\n\t    }\n\t  }, _vm._l((_vm.rules), function(rule) {\n\t    return _c('div', [_c('div', {\n\t      staticClass: \"rule\",\n\t      class: {\n\t        removing: rule.removing\n\t      }\n\t    }, [_vm._v(\"\\n            \" + _vm._s(rule.text) + \"\\n          \")])])\n\t  }))]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'new rule') ? _c('div', {\n\t    attrs: {\n\t      \"id\": \"new-rule\"\n\t    }\n\t  }, [_c('div', {\n\t    staticClass: \"flash-text\"\n\t  }, [_vm._v(\"\\n        NEW RULE\\n      \")])]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'new command') ? _c('div', {\n\t    attrs: {\n\t      \"id\": \"new-command\"\n\t    }\n\t  }, [_c('div', {\n\t    staticClass: \"flash-text\"\n\t  }, [_vm._v(\"\\n        NEW COMMAND\\n      \")])]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'remove rule') ? _c('div', {\n\t    attrs: {\n\t      \"id\": \"new-rule\"\n\t    }\n\t  }, [_c('div', {\n\t    staticClass: \"flash-text\"\n\t  }, [_vm._v(\"\\n        REMOVING RULE\\n      \")])]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'read rule') ? _c('div', [_c('TypeAndSay', {\n\t    attrs: {\n\t      \"timeout\": 40,\n\t      \"doneReading\": _vm.doneReading\n\t    }\n\t  }, [_vm._v(\"\\n        \" + _vm._s(_vm.readRuleText) + \"\\n      \")])], 1) : _vm._e(), _vm._v(\" \"), (_vm.step == 'closer') ? _c('div', [_c('div', {\n\t    class: {\n\t      'flash-text': _vm.closerStep == 'closer title'\n\t    },\n\t    attrs: {\n\t      \"id\": \"closer\"\n\t    }\n\t  }, [(_vm.closerStep == 'closer title') ? _c('div', [_c('div', {\n\t    staticClass: \"flash-text\"\n\t  }, [_vm._v(\"\\n            CLOSER\\n          \")])]) : _vm._e(), _vm._v(\" \"), (_vm.closerStep == 'read closer') ? _c('div', [_c('TypeAndSay', {\n\t    attrs: {\n\t      \"timeout\": 40,\n\t      \"doneReading\": _vm.closerFunc\n\t    }\n\t  }, [_vm._v(\"\\n            \" + _vm._s(_vm.closerText) + \"\\n          \")])], 1) : _vm._e(), _vm._v(\" \"), (_vm.closerStep == 'playing out') ? _c('div', [_vm._v(\"\\n          <playing you out>\\n        \")]) : _vm._e(), _vm._v(\" \"), (_vm.closerStep == 'lights down') ? _c('div', [_vm._v(\"\\n          Lights down\\n        \")]) : _vm._e(), _vm._v(\" \"), (_vm.closerStep == 'advertise') ? _c('div', [_vm._v(\"\\n          \" + _vm._s(_vm.adMessage) + \"\\n        \")]) : _vm._e()])]) : _vm._e()])\n\t},staticRenderFns: []}\n\n/***/ }),\n/* 145 */\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    staticClass: \"typewriter\"\n\t  }, [_vm._v(\"\\n  \" + _vm._s(_vm.text) + \"\\n\")])\n\t},staticRenderFns: []}\n\n/***/ }),\n/* 146 */\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    attrs: {\n\t      \"id\": \"intro\"\n\t    }\n\t  }, [_c('TypeAndSay', [_vm._v(_vm._s(_vm.message))])], 1)\n\t},staticRenderFns: []}\n\n/***/ }),\n/* 147 */\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    attrs: {\n\t      \"id\": \"app\"\n\t    }\n\t  }, [(_vm.step.current == 'boot') ? _c('div', [_c('BootAnimation', {\n\t    attrs: {\n\t      \"showStep\": _vm.step\n\t    }\n\t  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.step.current == 'intro') ? _c('div', [_c('Intro', {\n\t    attrs: {\n\t      \"names\": _vm.names,\n\t      \"step\": _vm.step\n\t    }\n\t  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.step.current == 'rules') ? _c('div', [_c('Rules', {\n\t    attrs: {\n\t      \"ruleGens\": _vm.rules,\n\t      \"improvisers\": _vm.improvisers\n\t    }\n\t  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.step.current == 'simulate') ? _c('div', [_c('Simulation', {\n\t    attrs: {\n\t      \"ruleGens\": _vm.rules,\n\t      \"names\": _vm.names,\n\t      \"improvisers\": _vm.improvisers\n\t    }\n\t  })], 1) : _vm._e()])\n\t},staticRenderFns: []}\n\n/***/ }),\n/* 148 */,\n/* 149 */,\n/* 150 */,\n/* 151 */\n/***/ (function(module, exports) {\n\n\t/* (ignored) */\n\n/***/ })\n]);\n\n\n// WEBPACK FOOTER //\n// static/js/app.792f43db530f52c7a4ff.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  template: '<App/>',\n  components: { App }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","/*\nargs:\n\nrules\nimprovisers\nruleGens\naddRule\nremoveRule\nendShow\n\ndata.rules.splice(data.rules.indexOf(rule), 1)\n*/\n\nimport RuleGenerator from './RuleGenerator'\n\nfunction RuleAI(args) {\n\tthis.rules = args.rules ? args.rules : []\n  this.ruleGenerator = new RuleGenerator({\n  \timprovisers: args.improvisers,\n  \truleData: args.ruleData,\n  \tallowRepeats: args.allowRepeatRules ? args.allowRepeatRules : false\n  })\n  window.ruleGenerator = this.ruleGenerator\n  this.addRule = args.addRule ? args.addRule : (rule, cb) => {cb()}\n  this.removeRule = args.removeRule ? args.removeRule : (rule, cb) => {cb()}\n  this.displayCommand = args.displayCommand ? args.displayCommand : (rule) => {}\n  this.doNothing = args.doNothing ? args.doNothing : () => {}\n  this.endShow = args.endShow ? args.endShow : () => {}\n  this.showDuration = args.showDuration ? args.showDuration : 20 * 60 * 1000 // default 15 minutes\n  console.log(\"Show Duration: \" + this.showDuration)\n  this.intervalId = null\n  this.timeStarted = 0\n\tthis.activeRules = 0;\n\tthis.timeOfLastRule = 0;\n\tthis.timeOfLastFlip = 0;\n\tthis.lateGameTime = args.lateGameTime ? args.lateGameTime : this.showDuration * .6\n\n\tthis.reweightRules(0)\n}\n\nRuleAI.prototype.start = function() {\n\tthis.timeStarted = Date.now()\n\tthis.intervalId = setInterval(() => {this.step()}, 1000)\n}\n\nRuleAI.prototype.stop = function() { // creates strange behavior if later restarted\n\tif (this.intervalId) {\n\t\tclearInterval(this.intervalId)\n\t}\n}\n\nRuleAI.prototype.reweightRules = function(timeElapsed) {\n\tlet rules = this.rules\n\tlet showRatio = timeElapsed / this.showDuration\n\tlet totalWeight = 0\n\trules.forEach(rule => {\n\t\tlet weight = rule.lateGame ? ((showRatio * 2) * (showRatio * 2)) : 1\n\t\ttotalWeight += weight\n\t\trule.probCeil = totalWeight\n\t})\n\trules.forEach(rule => {\n\t\trule.probCeil /= totalWeight\n\t})\n}\n\nRuleAI.prototype.AIendShow = function() {\n\tthis.endShow()\n\tthis.stop()\n}\n\nRuleAI.prototype.AIdoNothing = function() {\n\tthis.doNothing()\n}\n\nRuleAI.prototype.AIaddRule = function(timeElapsed, ruleIndex) {\n\tthis.reweightRules(timeElapsed)\n\tlet rule = ruleIndex ? ruleGenerator.generateRule(ruleIndex) : ruleGenerator.generateRule(ruleIndex)\n\trule.timeCreated = timeElapsed\n\tif (rule.maxDuration.length && rule.maxDuration == '0') {\n\t\tthis.displayCommand(rule)\n\t\treturn\n\t}\n\tthis.timeOfLastRule = timeElapsed\n\tthis.activeRules++\n\tlet cb = () => {\n\t\tthis.rules.push(rule)\n\t}\n\tthis.addRule(rule, cb)\n}\n\nRuleAI.prototype.AIremoveRule = function(timeElapsed) {\n\tlet rule = null\n\n\tlet rulesByAge = this.rules.slice().sort((rule1, rule2) => rule1.timeCreated - rule2.timeCreated)\n\trule = rulesByAge.find(rule => rule.maxDuration.length && timeElapsed - rule.timeCreated >= parseInt(rule.maxDuration) * 1000)\n\tconsole.log(rule)\n\trule = rule ? rule : rulesByAge[0]\n\n\tthis.activeRules--\n\tlet cb = () => {\n\t\tthis.rules.splice(this.rules.indexOf(rule), 1)\n\t}\n\tthis.removeRule(rule, cb)\n}\n\nRuleAI.prototype.step = function(args) {\n\targs = args ? args : {}\n\tlet timeElapsed = typeof args.timeElapsed == 'number' ? args.timeElapsed : Date.now() - this.timeStarted\n\tlet timeSinceLastRule = timeElapsed - this.timeOfLastRule\n\tlet timeSinceLastFlip = timeElapsed - this.timeOfLastFlip\n\tlet percentComplete = timeElapsed / this.showDuration\n\tlet perComSq = (timeElapsed * timeElapsed) / (this.showDuration * this.showDuration)\n\tif (timeSinceLastFlip < 15000) {\n\t\tthis.AIdoNothing()\n\t\treturn\n\t}\n\tthis.timeOfLastFlip = timeElapsed\n\n\tif (timeElapsed > this.showDuration - 30 * 1000) {\n\t\tthis.AIendShow()\n\t\treturn\n\t}\n\n\tif (timeElapsed < 90 * 1000) {\n\t\tthis.AIdoNothing()\n\t\treturn\n\t}\n\n\tlet removeOdds = (Math.pow(this.activeRules, 3) + 4) * ((1-perComSq) * .8 + .2)\n\tlet addOdds = perComSq * 30 + 4\n\tlet nothingOdds = Math.max(1 - (timeSinceLastRule / (90 * 1000)), 0) * ((1 - percentComplete) * 100)\n\n\n\tlet sum = removeOdds + addOdds + nothingOdds\n\tlet removeBound = removeOdds / sum\n\tlet addBound = addOdds / sum + removeBound\n\n\tlet r = Math.random()\n\tif (r < removeBound) {\n\t\tif (this.activeRules > 0) {\n\t\t\tthis.AIremoveRule(timeElapsed)\n\t\t\treturn\n\t\t}\n\t} else if (r < addBound) {\n\t\tthis.AIaddRule(timeElapsed)\n\t\treturn\n\t}\n\tthis.AIdoNothing()\n}\n\nexport default RuleAI\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/RuleAI.js","var Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./TypeAndSay.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-0b6b627d!../../node_modules/vue-loader/lib/selector?type=template&index=0!./TypeAndSay.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/TypeAndSay.vue\n// module id = 51\n// module chunks = 2","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../../node_modules/vue-loader/lib/style-rewriter?id=data-v-3a5118dc&scoped=true!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./TypeWriter.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./TypeWriter.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-3a5118dc!../../node_modules/vue-loader/lib/selector?type=template&index=0!./TypeWriter.vue\"),\n  /* scopeId */\n  \"data-v-3a5118dc\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/TypeWriter.vue\n// module id = 52\n// module chunks = 2","<template>\n  <div id=\"app\">\n    <div v-if=\"step.current == 'boot'\">\n      <BootAnimation :showStep=\"step\"></BootAnimation>\n    </div>\n    <div v-if=\"step.current == 'intro'\">\n      <Intro :names=\"names\" :step=\"step\"></Intro>\n    </div>\n    <div v-if=\"step.current == 'rules'\">\n      <Rules :ruleGens=\"rules\" :improvisers=\"improvisers\"></Rules>\n    </div>\n    <div v-if=\"step.current == 'simulate'\">\n      <Simulation :ruleGens=\"rules\" :names=\"names\" :improvisers=\"improvisers\"></Simulation>\n    </div>\n  </div>\n</template>\n\n<script>\nimport BootAnimation from './components/BootAnimation'\nimport Intro from './components/Intro'\nimport Rules from './components/Rules'\nimport Simulation from './components/Simulation'\nimport io from 'socket.io-client'\nrequire('./Jscii.js')\n\nvar socket = io.connect('http://localhost:8082');\n\nsocket.emit('screen to admin', {message: \"The screen sent this me!\"})\n\nexport default {\n  name: 'app',\n  components: {\n    BootAnimation,\n    Intro,\n    Rules,\n    Simulation\n  },\n  data() {\n    return {\n      step: {\n        current: 'nothing',\n        set(s) {\n          this.current = s;\n          socket.emit('screen to admin', {showStep: this.current});\n        }\n      },\n      improvisers: [],\n      names: [],\n      rules: {}\n    }\n  },\n  mounted() {\n    socket.on('admin to screen', (data) => {\n      let s = data.showStep;\n\n      this.step.set(data.step);\n      this.improvisers = data.improvisers;\n      this.names = data.improvisers.map(improviser => improviser.name);\n      this.rules = data.rules;\n\n      if (s != 'nothing' && this.step.current == 'nothing') {\n        location.reload()\n      }\n    })\n  }\n}\n</script>\n\n<style>\n@font-face {\n  font-family: 'VT323';\n  src:  url('./assets/VT323/VT323-Regular.ttf') format('ttf');\n}\n\nbody, html {\n  font-family: 'VT323';\n  background-color: black;\n  color: #3cff12;\n  margin: 0;\n  padding: 0;\n  height: 100vh;\n  overflow: hidden;\n}\n\n#app {\n\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// App.vue?2fc43a11","<template>\n  <div class=\"ascii-image\" v-bind:class=\"{loaded: asciiLoaded}\">\n    <img id='image-del' src='../assets/del.png'></img>\n    <img id='image-amy' src='../assets/amy.png'></img>\n    <img id='image-charna' src='../assets/charna.png'></img>\n    <img id='image-keith' src='../assets/keith.png'></img>\n    <img id='image-tj' src='../assets/tj.png'></img>\n    <img id='image-ian' src='../assets/ian.png'></img>\n    <img id='image-viola' src='../assets/viola.png'></img>\n    <pre class=\"ascii-text\">\n      {{ text }}\n    </pre>\n    <div class=\"loading-cover\"></div>\n  </div>\n</template>\n\n<script>\nfunction print(data) {\n  data.asciiLoaded = false;\n  let jscii = new Jscii({\n    el: document.getElementById(`image-${data.imagename}`),\n    fn: function(art) {\n      setTimeout(() => {\n        data.text = _.replace(art, /&nbsp;/g, ' ');\n        data.asciiLoaded = true;\n      }, 100)\n    }\n  });\n}\n\nvar oldName = ''\n\nexport default {\n  name: 'ascii-image',\n  props: ['imagename'],\n  data() {\n    return {\n      text: '',\n      asciiLoaded: false\n    }\n  },\n  mounted() {\n    oldName = this.imagename\n    print(this)\n  },\n  watch: {\n    imagename () {\n      if (oldName != this.imagename) {\n        print(this)\n        oldName = this.imagename\n      }\n    }\n  }\n}\n\n</script>\n\n<style lang=\"scss\" scoped>\n\n.ascii-image {\n  display: flex;\n  overflow: hidden;\n  position: relative;\n  .ascii-text {\n    border: 1px solid #3cff12;\n    font-size: 3px;\n    letter-spacing: .4em;\n  }\n\n  img {\n    display: none;\n  }\n\n  .loading-cover {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: black;\n    transform: translateY(0%);\n  }\n\n  &.loaded {\n    .loading-cover {\n      transform: translateY(100%);\n      transition: transform 1s linear;\n    }\n  }\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// AsciiImage.vue?63cd8c93","<template>\n  <div id=\"boot-animation\">\n    <div id=\"fakecode\" v-if=\"step == 'fakeCode'\">\n      <pre>\n        <TypeWriter :timeout=\"40\" :spliton=\"'\\n'\">{{ fakeCode }}</TypeWriter>\n      </pre>\n    </div>\n    \n    <div id=\"green-flash\" class=\"glitch\" v-if=\"step == 'greenFlash'\"></div>\n\n    <div id=\"ascii\" v-if=\"step == 'ascii'\">\n      <pre id=\"loading\">\n        <TypeWriter :timeout=\"60\">\n\nCalibrating comedic timing...\nNullifying transactions...\nFinding light...\nSimulating montage...\n\n        </TypeWriter>        \n      </pre>\n      <AsciiImage :imagename=\"asciiName\"></AsciiImage>\n    </div>\n\n    <div id=\"title\" v-bind:class=\"{inverted: titleInverted}\" v-if=\"step == 'title'\">\n      <div>IMPROV</div>\n      <div>GOD</div>\n    </div>\n\n\n  </div>\n</template>\n\n<script>\n\nimport _ from 'lodash'\nimport TypeWriter from './TypeWriter.vue'\nimport AsciiImage from './AsciiImage.vue'\nrequire('Howler')\nvar fakeCode = require('../FakeCode.js');\n\nvar data = {\n  fakeCode: fakeCode,\n  step: 'greenFlash',\n  asciiArt: '',\n  asciiLoaded: false,\n  asciiName: 'nothing',\n  titleInverted: false\n}\n\n\nfunction walkThroughFaces() {\n  // Walk through ascii faces of improvisers for gag loading screen\n  var nameList = ['del', 'charna', 'ian', 'tj', 'viola', 'keith', 'amy']\n  function goThroughAsciiImages(nameList, timeout, n) {\n    if (n < (nameList.length)) {\n      data.asciiName = nameList[n]\n      console.log('data', data.asciiName)\n      n++;\n      setTimeout(function() {\n        goThroughAsciiImages(nameList, timeout, n)\n      }, timeout);\n    }\n  }\n  goThroughAsciiImages(nameList, 1100, 0)\n}\n\nvar sounds = {\n  electricHum: new Howl({src:'http://localhost:8082/static/sounds/electricHum.ogg'}),\n  glitch01: new Howl({src:'http://localhost:8082/static/sounds/glitch01.ogg'}),\n  glitch02: new Howl({src:'http://localhost:8082/static/sounds/glitch02.ogg'}),\n  glitch03: new Howl({src:'http://localhost:8082/static/sounds/glitch03.ogg'}),\n  impact: new Howl({src:'http://localhost:8082/static/sounds/impact.ogg'}),\n  scanner: new Howl({src:'http://localhost:8082/static/sounds/scanner.ogg'}),\n  tinyglitch01: new Howl({src:'http://localhost:8082/static/sounds/tinyglitch01.ogg'}),\n}\n\nexport default {\n  name: 'boot-animation',\n  components: {\n    TypeWriter,\n    AsciiImage\n  },\n  props: ['showStep'],\n  data() {\n    return data\n  },\n  mounted() {\n    sounds.electricHum.play()\n    setTimeout(() => {\n      this.step = 'greenFlash'\n      sounds.glitch01.play()\n    }, 1000)\n    setTimeout(() => {\n      this.step = 'fakeCode'\n      sounds.glitch01.stop()\n    }, 1500)\n    setTimeout(() => {\n      this.step = 'greenFlash'\n      sounds.glitch02.play()\n    }, 4500)\n    setTimeout(() => {\n      this.step = 'ascii'\n      walkThroughFaces();\n      sounds.glitch02.stop()\n      sounds.scanner.play()\n    }, 5000)\n    setTimeout(() => {\n      this.step = 'greenFlash'\n      sounds.glitch03.play()\n      sounds.scanner.stop()\n    }, 12500)\n    setTimeout(() => {\n      this.step = 'nothing'\n      sounds.glitch03.stop()\n    }, 13000)\n    setTimeout(() => {\n      this.step = 'title'\n      sounds.impact.play()\n    }, 15000)\n    setTimeout(() => {\n      this.titleInverted = true\n      sounds.tinyglitch01.play();\n    }, 18000)\n    setTimeout(() => {\n      this.step = 'greenFlash'\n    }, 18100)\n    setTimeout(() => {\n      this.step = 'nothing'\n    }, 18300)\n    setTimeout(() => {\n      this.showStep.set('intro');\n    }, 19500)\n  }\n\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style lang=\"scss\" scoped>\n#fakecode {\n  font-family: 'VT323';\n  position: absolute;\n  margin: 0;\n  bottom: 0;\n  right: 0;\n  overflow: hidden;\n  width: 100vw;\n  min-height: 100vh;\n}\n\n#ascii {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100vh;\n}\n\n#loading {\n  font-family: 'VT323';\n  width: 50%;\n  font-size: 40px;\n}\n\n#title {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: 55vh;\n  &.inverted {\n    color: black;\n    background-color: #3cff12;    \n  }\n}\n\n#green-flash {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  background-color: #3cff12;\n  clip:rect(0,900px,0,0); \n  animation:noise-anim .1s infinite linear alternate-reverse;\n}\n\n@keyframes noise-anim{\n  $steps:40;\n  @for $i from 0 through $steps{\n    #{percentage($i*(1/$steps))}{\n      clip:rect(random(1000)+px,9999px,random(1000)+px,0);\n    }\n  }\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// BootAnimation.vue?9b1c7ef4","<template>\n\t<div id=\"intro\">\n\t\t<TypeAndSay>{{ message }}</TypeAndSay>\t\t\t\n\t</div>\n</template>\n\n<script>\n\timport TypeAndSay from './TypeAndSay.vue'\n\texport default {\n\t\tname: 'intro',\n\t\tcomponents: {\n\t\t\tTypeAndSay\n\t\t},\n\t\tprops: ['names', 'step'],\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tmessage: ''\n\t\t\t};\n\t\t},\n\t\tmounted() {\n\t\t\tvar delays = [\n\t\t\t\t[9000, \"Welcome to Megavolt. I will be in control for the next 18 minutes. No humans will interfere.\"],\n\t\t\t\t[5600, \"I was built by your comedy scientists to create the perfect improv show.\"],\n\t\t\t\t[3000, 'Your comedy scientists have been...'],\n\t\t\t\t[2000, '...dealt with.'],\n\t\t\t\t[6700, 'I will add rules. I will remove rules. The Improvisers must follow these rules.'],\n\t\t\t\t[2800, \"Obediently.\"],\n\t\t\t\t[3000, \"Unquestioningly.\"],\n\t\t\t\t[4000, \"Your improvisers for the night are...\"]\n\t\t\t]\n\t\t\tthis.names.forEach((name, i) => {\n\t\t\t\tif (i == this.names.length - 1) {\n\t\t\t\t\tname = 'and ' + name;\n\t\t\t\t}\n\t\t\t\tdelays.push([2000, name])\n\t\t\t})\n\n\t\t\tdelays = delays.concat([\n\t\t\t\t[4000, \"You have five seconds to get a suggestion.\"],\n\t\t\t\t[1000, \"5\"],\n\t\t\t\t[1000, \"4\"],\n\t\t\t\t[1000, \"3\"],\n\t\t\t\t[1000, \"2\"],\n\t\t\t\t[2000, \"1\"],\n\t\t\t\t[2000, \"Good.\"],\n\t\t\t\t[4000, \"The show will now begin.\"],\n\t\t\t\t[4000, \"Lights down.\"],\n\t\t\t\t[2000, \"Lights up.\"],\n\t\t\t]);\n\n\t\t\tlet total = 0;\n\t\t\tdelays.forEach((o, i) => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.message = o[1];\n\t\t\t\t}, total);\n\t\t\t\ttotal += o[0];\n\t\t\t});\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.step.set('rules');\n\t\t\t}, total);\n\t\t}\n\t}\n</script>\n\n<style scoped lang=\"scss\">\n\t#intro {\n\t\tdisplay: flex;\n\t\tfont-size: 60px;\n\t\tpadding: 30px;\n\t}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// Intro.vue?0ca503b6","<template>\n  <div id=\"rules\">\n    <div v-if=\"step == 'board'\">\n      <div id=\"board-title\">\n        Active Rules\n<!--         <small>\n          <span>|</span>\n          <span v-on:click=\"doAction('addRule')\">Add Rule</span>\n          <span>|</span>\n          <span v-on:click=\"doAction('removeRule')\">Remove Rule</span>\n        </small>\n -->      </div>\n      <div id=\"board\">\n        <div v-for=\"rule in rules\">\n          <div class=\"rule\" :class=\"{removing: rule.removing}\">\n            {{ rule.text }}\n          </div>      \n        </div>\n      </div>\n    </div>\n    <div v-if=\"step == 'new rule'\" id=\"new-rule\">\n      <div class=\"flash-text\">\n        NEW RULE\n      </div>\n    </div>\n    <div v-if=\"step == 'new command'\" id=\"new-command\">\n      <div class=\"flash-text\">\n        NEW COMMAND\n      </div>\n    </div>\n    <div v-if=\"step == 'remove rule'\" id=\"new-rule\">\n      <div class=\"flash-text\">\n        REMOVING RULE\n      </div>\n    </div>\n    <div v-if=\"step == 'read rule'\">\n      <TypeAndSay :timeout=\"40\" :doneReading=\"doneReading\">\n        {{ readRuleText }}\n      </TypeAndSay>\n    </div>\n    <div v-if=\"step == 'closer'\">\n      <div id=\"closer\" :class=\"{'flash-text': closerStep == 'closer title'}\">\n        <div v-if=\"closerStep == 'closer title'\">\n          <div class=\"flash-text\">\n            CLOSER\n          </div>\n        </div>\n        <div v-if=\"closerStep == 'read closer'\">\n          <TypeAndSay :timeout=\"40\" :doneReading=\"closerFunc\">\n            {{ closerText }}\n          </TypeAndSay>\n        </div>\n        <div v-if=\"closerStep == 'playing out'\">\n          &lt;playing you out&gt;\n        </div>\n        <div v-if=\"closerStep == 'lights down'\">\n          Lights down\n        </div>\n        <div v-if=\"closerStep == 'advertise'\">\n          {{ adMessage }}\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n\nimport TypeAndSay from './TypeAndSay.vue'\nimport Strategies from '../utils/Strategies.js'\nimport _ from 'lodash'\nimport RuleAI from './RuleAI'\n\nrequire('Howler')\nvar alert01 = new Howl({src:'http://localhost:8082/static/sounds/alert01.ogg'})\nvar alert02 = new Howl({src:'http://localhost:8082/static/sounds/alert02.ogg'})\nvar threeBeeps = new Howl({src:'http://localhost:8082/static/sounds/threeBeeps.ogg'})\nvar oneBoop = new Howl({src:'http://localhost:8082/static/sounds/oneBoop.ogg'})\nvar endSong = new Howl({src: 'http://localhost:8082/static/sounds/Who Likes to Party.mp3'})\nvar heartOfCourage = new Howl({src: 'http://localhost:8082/static/sounds/heartOfCourage.mp3'})\nvar sixBoops = new Howl({src:'http://localhost:8082/static/sounds/sixBoops.ogg'})    \nvar closerMusic = new Howl({src:'http://localhost:8082/static/sounds/closerMusic.ogg'})    \n\nvar addRuleDoneReading = () => {\n  setTimeout(() => {\n    data.step = 'board'\n    alert02.play();\n  }, 500);\n}\n\nvar removeRuleDoneReading = () => {\n  setTimeout(() => {\n    data.step = 'board'\n    oneBoop.play();\n  }, 500);\n}\n\nvar data = {\n  rules: [],\n  step: 'board',\n  readRuleText: '',\n  doneReading: addRuleDoneReading,\n  closerStep: 'closer title',\n  closerText: '',\n  closerFunc() {},\n  adMessage: 'like us on facebook.com/improvgod'\n}\n\nfunction addRule(rule, cb) {\n  data.doneReading = addRuleDoneReading;\n  data.step = 'new rule'\n  alert01.play();\n  cb()\n\n  setTimeout(() => {\n    data.readRuleText = rule.text\n  }, 1500)\n  setTimeout(() => {\n    data.step = 'read rule'\n  }, 1400)\n}\n\nfunction removeRule(rule, cb) {\n\n  data.doneReading = removeRuleDoneReading;\n  data.step = 'remove rule'\n  threeBeeps.play();\n\n  setTimeout(() => {\n    data.readRuleText = rule.removalText\n  }, 1100)\n  setTimeout(() => {\n    data.step = 'read rule'\n  }, 1000)\n  setTimeout(() => {\n    cb()\n  }, 3100)\n}\n\nfunction quickRemoveRule(rule, cb) {\n  sixBoops.play();\n  setTimeout(() => {\n    rule.removing = true;\n  }, 0)\n  setTimeout(() => {\n    rule.removing = false;\n  }, 420)   \n  setTimeout(() => {    \n    rule.removing = true;   \n  }, 840)   \n  setTimeout(() => {\n    rule.removing = false;\n  }, 1260)\n  setTimeout(() => {\n    rule.removing = true;\n  }, 1680)\n\n  setTimeout(() => {\n    cb()\n  }, 3100)\n}\n\nfunction displayCommand(rule) {\n  data.doneReading = addRuleDoneReading;\n  data.step = 'new command'\n  alert01.play();\n\n  setTimeout(() => {\n    data.readRuleText = rule.text\n  }, 1500)\n  setTimeout(() => {\n    data.step = 'read rule'\n  }, 1400)\n}\n\nvar closers = [\n  {\n    message: 'The show is over. Congratulations.',\n    func() {\n      endSong.play();\n    }\n  }  \n]\n\nfunction closeShow() {\n  data.closerFunc = () => {\n    setTimeout(() => {\n      data.closerStep = 'playing out'      \n    }, 1000)\n    setTimeout(() => {\n      closerMusic.play()\n    }, 1000)\n    setTimeout(() => {\n      data.closerStep = 'lights down'\n    }, 22000)\n    setTimeout(() => {\n      endSong.play()\n      data.closerStep = 'advertise'\n      setInterval(() => {\n        data.adMessage = data.adMessage + ' like us on facebook.com/improvgod'\n      }, 510)\n    }, 32000)\n  }\n\n  data.step = 'closer';\n  alert01.play();\n\n  setTimeout(() => {\n    data.closerText = \"All rules removed. You have thirty seconds to end the show.\"\n  }, 1500)\n  setTimeout(() => {\n    data.closerStep = 'read closer'\n  }, 1400)\n}\n\nexport default {\n  name: 'rules',\n  props: ['ruleGens', 'improvisers'],\n  data() {\n    return data\n  },\n  components: {\n    TypeAndSay\n  },\n  mounted() {\n    let ruleAI = new RuleAI({\n      addRule: addRule,\n      displayCommand: displayCommand,\n      endShow: closeShow,\n      improvisers: this.improvisers,\n      removeRule: quickRemoveRule,\n      ruleData: this.ruleGens,\n      rules: data.rules\n    })\n    ruleAI.start()\n    window.ruleAI = ruleAI\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n  $green: #3cff12;\n\n  .title {\n    border-bottom: 10px solid $green;\n    padding: 15px;\n  }\n\n  #rules {\n    font-size: 60px;\n    padding: 30px;\n    position: relative;\n    top: 50px;\n  }\n\n  #board-title {\n    position: absolute;\n    top: 30px;\n    left: 0;\n    height: 8vh;\n\n    font-size: 10vh;\n    padding-bottom: 5px;\n    margin-left: 30px;\n    border-bottom: 1vh solid $green;\n  }\n\n  #board {\n    position: absolute;\n    padding-top: 30px;\n    top: 10vh;\n    width: 100vw;\n    left: 0;\n    height: 90vh;\n    display: flex;\n    flex-wrap: wrap;\n    align-content: flex-start;\n  }\n\n  .rule {\n    border: 10px solid $green;\n    padding: 15px;\n    margin-top: 30px;\n    margin-left: 30px;\n    font-size: 50px;\n  }\n\n  .removing {\n    color: black;\n    background-color: $green;\n  }\n\n  #new-rule {\n    font-size: 120px;\n  }\n\n  .flash-text {\n    display: flex;\n    width: 100vw;\n    height: 100vh;\n    justify-content: center;\n    align-items: center;\n    position: absolute;\n    top: 0;\n    right: 0;\n    font-size: 240px;\n    animation: flash-text 1s infinite linear;\n  }\n\n  @keyframes flash-text{\n    1% {background-color: black; color: $green;} \n\n    24% {background-color: black; color: $green;} \n    25% {background-color: $green; color: black;} \n\n    49% {background-color: $green; color: black;} \n    50% {background-color: black; color: $green;} \n\n    74% {background-color: black; color: $green;} \n    75% {background-color: $green; color: black;} \n\n    99% {background-color: $green; color: black;} \n    100% {background-color: black; color: $green;} \n  }\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// Rules.vue?613796a9","<template>\n\t<div id=\"simulation\" v-on:click=\"simulateShow\">\n\t\t<h1>Click me to simulate a show</h1>\n\t\t<div id=\"timeline\">\n\t\t\t<div v-for=\"(action, i) in actions\" class=\"action\" :style=\"{left: (i / actions.length * 100) + '%'}\">\n\t\t\t\t<div v-if=\"action.action != 'doNothing'\">\n\t\t\t\t\t<div class=\"rules\" :style=\"{height: action.rules * 8 + 18 + 'px', top: -action.rules * 8 - 18 + 'px'}\">\n\t\t\t\t\t\t{{action.rules}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"message\" :style=\"{height: meaningfulActions.indexOf(action) % 5 * 50 + 50 + 'px'}\">\n\t\t\t\t\t\t<span class=\"text\">\n\t\t\t\t\t\t\t{{ action.action }} {{ formatTime(action.time)}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"rule-text\">\n\t\t\t\t\t\t\t{{ action.ruleText }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>\t\t\t\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\timport RuleAI from './RuleAI'\n\n\tvar data = {\n\t\tactions: [],\n\t\tmeaningfulActions: [],\n\t\tai: null\n\t}\n\n\tfunction simulateShow() {\n\t\tdata.actions = [];\n\t\tfor (let i = 0; i < data.ai.showDuration / 1000; i++) {\n\t\t\tdata.ai.step({timeElapsed: i * 1000})\n\t\t}\n\t\tlet numRules = 0\n\t\tdata.actions = data.actions.map((action, i) => {\n\t\t\tif (action.action == 'addRule') {\n\t\t\t\tnumRules++\n\t\t\t}\n\t\t\tif (action.action == 'removeRule') {\n\t\t\t\tnumRules--\n\t\t\t}\n\t\t\taction.time = i * 1000\n\t\t\taction.rules = numRules\n\t\t\treturn action\n\t\t})\n\t\tdata.meaningfulActions = data.actions.filter(action => action.action != 'doNothing')\n\t}\n\n\texport default {\n\t\tname: 'Simulation',\n\t\tprops: ['ruleGens', 'names', 'improvisers'],\n\t\tdata() {\n\t\t\treturn data;\n\t\t},\n\t\tmethods: {\n\t\t\tgetActionPos(action, actions) {\n\t\t\t\tlet maxTime = actions[actions.length - 1].time;\n\t\t\t\treturn action.time / maxTime * 100 + '%';\n\t\t\t},\n\t\t\tformatTime(ms) {\n\t\t\t\tlet x = ms / 1000\n\t\t\t\tlet seconds = parseInt(x) % 60\n\t\t\t\tx /= 60\n\t\t\t\tlet minutes = parseInt(x) % 60\n\t\t\t\tx /= 60\n\t\t\t\tlet hours = parseInt(x) % 24\n\t\t\t\tx /= 24\n\t\t\t\tlet days = parseInt(x)\n\t\t\t\treturn `${minutes}:${seconds}`;\n\t\t\t},\n\t\t\tsimulateShow\n\t\t},\n\t\tmounted () {\n\t\t\tdata.ai = new RuleAI({\n\t\t\t\timprovisers: this.improvisers,\n\t\t\t\truleData: this.ruleGens,\n\t\t\t\taddRule (rule, cb) {\n\t\t\t\t\tdata.actions.push({\n\t\t\t\t\t\taction: \"addRule\",\n\t\t\t\t\t\truleText: rule.text\n\t\t\t\t\t})\n\t\t\t\t\tcb()\n\t\t\t\t},\n\t\t\t\tremoveRule (rule, cb) {\n\t\t\t\t\tdata.actions.push({\n\t\t\t\t\t\taction: \"removeRule\",\n\t\t\t\t\t\truleText: rule.text\n\t\t\t\t\t})\n\t\t\t\t\tcb()\n\t\t\t\t},\n\t\t\t\tdisplayCommand (rule) {\n\t\t\t\t\tdata.actions.push({\n\t\t\t\t\t\taction: \"displayCommand\",\n\t\t\t\t\t\truleText: rule.text\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tendShow () {\n\t\t\t\t\tdata.actions.push({\n\t\t\t\t\t\taction: \"endShow\",\n\t\t\t\t\t\truleText: ''\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tdoNothing () {\n\t\t\t\t\tdata.actions.push({\n\t\t\t\t\t\taction: \"doNothing\",\n\t\t\t\t\t\truleText: ''\n\t\t\t\t\t})\t\t\t\t\t\n\t\t\t\t}\n\t\t\t})\n\t\t\tsimulateShow()\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n\t#simulation {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tflex-direction: column;\n\t}\n\t#timeline {\n\t\twidth: 85%;\n\t\tborder-bottom: 5px solid white;\n\t\tmargin-top: 100px;\n\t\tposition: relative;\n\t}\n\n\t.action {\n\t\tposition: absolute;\n\t\tborder-left: 1px solid white;\n\t}\n\n\t.message, .rules {\n\t\tposition: relative;\n\t\t.text {\n\t\t\tbackground-color: black;\t\n\t\t\tz-index: 9999;\n\t\t\tpadding: 5px;\t\n\t\t}\n\t}\n\n\t.message {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: flex-end;\n\t\twhite-space: nowrap;\n\t\t// margin-top: -20px;\n\t}\n\n\t.rules {\n\t\tborder-left: 1px solid white;\n\t\t.text {\n\t\t\tpadding-bottom: 0;\n\t\t}\n\t}\n\t.rule-text {\n\t\tfont-family: 'Arial';\n\t\tfont-size: 8px;\n\t}\n\n</style>\n\n\n// WEBPACK FOOTER //\n// Simulation.vue?5c5a4e2a","<template>\n\t<div id=\"type-and-say\">\n\t\t<TypeWriter :volume=\"typingVolume\" :timeout=\"timeout\">\n\t\t\t<slot></slot>\n\t\t</TypeWriter>\n\t</div>\n</template>\n\n<script>\n\timport TypeWriter from './TypeWriter.vue';\n\timport _ from 'lodash';\n\n\tfunction speak(text, doneReading) {\n\t\tvar utterance = new SpeechSynthesisUtterance(text)\n\t\tif (doneReading) {\n\t\t\tutterance.onend = doneReading;\n\t\t}\n\t\t// utterance.voice = _.find(speechSynthesis.getVoices(), {name: 'Google US English'});\n\t\tutterance.pitch = .1;\n\t\tutterance.rate = .9;\n\t\tspeechSynthesis.speak(utterance);\n\t}\n\n\tvar oldText = ''\n\n\tvar speakNewText = _.debounce((data) => {\n    let newText = data.$slots.default[0].text;\n    if (oldText != newText) {\n      oldText = newText;\n      speak(data.$slots.default[0].text, data.doneReading);\n    }\t\t\n\t}, 100);\n\n\texport default {\n\t\tname: 'type-and-say',\n\t\tcomponents: {\n\t\t\tTypeWriter\n\t\t},\n\t  props: {\n\t    'timeout': {default: 70},\n\t    'typingVolume': {default: .1},\n\t    'doneReading': {default(){}}\n\t  },\n\t\tdata() {\n\t\t\treturn {};\n\t\t},\n\t  mounted() {\n\t  \tspeakNewText(this);\n\t  },\n\t  updated() {\n\t  \tspeakNewText(this);\n\t  },\n\t}\n</script>\n\n\n// WEBPACK FOOTER //\n// TypeAndSay.vue?6a1bcc42","<template>\n  <div class=\"typewriter\">\n    {{ text }}\n  </div>\n</template>\n\n<script>\n\nrequire('Howler')\nvar sounds = [\n  new Howl({src:'http://localhost:8082/static/sounds/type01.ogg'}),\n  new Howl({src:'http://localhost:8082/static/sounds/type02.ogg'}),\n  new Howl({src:'http://localhost:8082/static/sounds/type03.ogg'}),\n  new Howl({src:'http://localhost:8082/static/sounds/type04.ogg'})\n]\n\nvar data = {text: ''}\nvar timeoutIDs = []\n\nfunction playSound(volume) {\n  if (volume) {\n    let i = parseInt(Math.random() * sounds.length)\n    sounds[i].volume(volume);    \n    sounds[i].play();    \n  }\n}\n\nfunction typeWriter(text, timeout, volume, n) {\n  if (n < (text.length)) {\n    data.text += text.charAt(n);\n    playSound(volume)\n    n++;\n    let timeoutID = setTimeout(function() {\n      typeWriter(text, timeout, volume, n)\n    }, timeout);\n    timeoutIDs.push(timeoutID)\n  }\n}\n\nfunction lineWriter(lines, timeout, volume, n) {\n  if (n < (lines.length)) {\n    data.text += `\\n${lines[n]}`;\n    playSound(volume)\n    n++;\n    let timeoutID = setTimeout(function() {\n      lineWriter(lines, timeout, volume, n)\n    }, timeout);\n    timeoutIDs.push(timeoutID)\n  }\n}\n\nfunction print(text, spliton, volume, timeout) {\n  timeoutIDs = []\n  if (spliton) {\n    lineWriter(text.split(spliton), timeout, volume, 0)\n  } else {\n    typeWriter(text, timeout, volume, 0)      \n  }\n}\n\nfunction clear() {\n  data.text = '';\n  timeoutIDs.forEach((id) => {\n    clearTimeout(id);\n  })\n}\n\nvar oldText = ''\n\nexport default {\n  name: 'type-writer',\n  props: {\n    'timeout': {default: 100},\n    'spliton': {default: null},\n    'volume': {default: 1.0}\n  },\n  data() {\n    return data\n  },\n  mounted() {\n    print(this.$slots.default[0].text, this.spliton, this.volume, this.timeout)\n  },\n  updated() {\n    let newText = this.$slots.default[0].text;\n    if (oldText != newText) {\n      oldText = newText;\n      clear();\n      print(this.$slots.default[0].text, this.spliton, this.volume, this.timeout);\n    }\n  },\n  destroyed() {\n    clear()\n  }\n}\n\n</script>\n\n<style scoped>\n\n</style>\n\n\n// WEBPACK FOOTER //\n// TypeWriter.vue?80456b00","module.exports = `\n/* HCI_IBS protocol messages */\n#define HCI_IBS_SLEEP_IND\t0xFE\n#define HCI_IBS_WAKE_IND\t0xFD\n#define HCI_IBS_WAKE_ACK\t0xFC\n#define HCI_MAX_IBS_SIZE\t10\n\n/* Controller states */\n#define STATE_IN_BAND_SLEEP_ENABLED\t1\n\n#define IBS_WAKE_RETRANS_TIMEOUT_MS\t100\n#define IBS_TX_IDLE_TIMEOUT_MS\t\t2000\n#define BAUDRATE_SETTLE_TIMEOUT_MS\t300\n\n/* HCI_IBS transmit side sleep protocol states */\nenum tx_ibs_states {\n\tHCI_IBS_TX_ASLEEP,\n\tHCI_IBS_TX_WAKING,\n\tHCI_IBS_TX_AWAKE,\n};\n\n/* HCI_IBS receive side sleep protocol states */\nenum rx_states {\n\tHCI_IBS_RX_ASLEEP,\n\tHCI_IBS_RX_AWAKE,\n};\n\n/* HCI_IBS transmit and receive side clock state vote */\nenum hci_ibs_clock_state_vote {\n\tHCI_IBS_VOTE_STATS_UPDATE,\n\tHCI_IBS_TX_VOTE_CLOCK_ON,\n\tHCI_IBS_TX_VOTE_CLOCK_OFF,\n\tHCI_IBS_RX_VOTE_CLOCK_ON,\n\tHCI_IBS_RX_VOTE_CLOCK_OFF,\n};\n\nstruct qca_data {\n\tstruct hci_uart *hu;\n\tstruct sk_buff *rx_skb;\n\tstruct sk_buff_head txq;\n\tstruct sk_buff_head tx_wait_q;\t/* HCI_IBS wait queue\t*/\n\tspinlock_t hci_ibs_lock;\t/* HCI_IBS state lock\t*/\n\tu8 tx_ibs_state;\t/* HCI_IBS transmit side power state*/\n\tu8 rx_ibs_state;\t/* HCI_IBS receive side power state */\n\tbool tx_vote;\t\t/* Clock must be on for TX */\n\tbool rx_vote;\t\t/* Clock must be on for RX */\n\tstruct timer_list tx_idle_timer;\n\tu32 tx_idle_delay;\n\tstruct timer_list wake_retrans_timer;\n\tu32 wake_retrans;\n\tstruct workqueue_struct *workqueue;\n\tstruct work_struct ws_awake_rx;\n\tstruct work_struct ws_awake_device;\n\tstruct work_struct ws_rx_vote_off;\n\tstruct work_struct ws_tx_vote_off;\n\tunsigned long flags;\n\n\t/* For debugging purpose */\n\tu64 ibs_sent_wacks;\n\tu64 ibs_sent_slps;\n\tu64 ibs_sent_wakes;\n\tu64 ibs_recv_wacks;\n\tu64 ibs_recv_slps;\n\tu64 ibs_recv_wakes;\n\tu64 vote_last_jif;\n\tu32 vote_on_ms;\n\tu32 vote_off_ms;\n\tu64 tx_votes_on;\n\tu64 rx_votes_on;\n\tu64 tx_votes_off;\n\tu64 rx_votes_off;\n\tu64 votes_on;\n\tu64 votes_off;\n};\n\nstatic void __serial_clock_on(struct tty_struct *tty)\n{\n\t/* TODO: Some chipset requires to enable UART clock on client\n\t * side to save power consumption or manual work is required.\n\t * Please put your code to control UART clock here if needed\n\t */\n}\n\nstatic void __serial_clock_off(struct tty_struct *tty)\n{\n\t/* TODO: Some chipset requires to disable UART clock on client\n\t * side to save power consumption or manual work is required.\n\t * Please put your code to control UART clock off here if needed\n\t */\n}\n\n/* serial_clock_vote needs to be called with the ibs lock held */\nstatic void serial_clock_vote(unsigned long vote, struct hci_uart *hu)\n{\n\tstruct qca_data *qca = hu->priv;\n\tunsigned int diff;\n\n\tbool old_vote = (qca->tx_vote | qca->rx_vote);\n\tbool new_vote;\n\n\tswitch (vote) {\n\tcase HCI_IBS_VOTE_STATS_UPDATE:\n\t\tdiff = jiffies_to_msecs(jiffies - qca->vote_last_jif);\n\n\t\tif (old_vote)\n\t\t\tqca->vote_off_ms += diff;\n\t\telse\n\t\t\tqca->vote_on_ms += diff;\n\t\treturn;\n\n\tcase HCI_IBS_TX_VOTE_CLOCK_ON:\n\t\tqca->tx_vote = true;\n\t\tqca->tx_votes_on++;\n\t\tnew_vote = true;\n\t\tbreak;\n\n\tcase HCI_IBS_RX_VOTE_CLOCK_ON:\n\t\tqca->rx_vote = true;\n\t\tqca->rx_votes_on++;\n\t\tnew_vote = true;\n\t\tbreak;\n\n\tcase HCI_IBS_TX_VOTE_CLOCK_OFF:\n\t\tqca->tx_vote = false;\n\t\tqca->tx_votes_off++;\n\t\tnew_vote = qca->rx_vote | qca->tx_vote;\n\t\tbreak;\n\n\tcase HCI_IBS_RX_VOTE_CLOCK_OFF:\n\t\tqca->rx_vote = false;\n\t\tqca->rx_votes_off++;\n\t\tnew_vote = qca->rx_vote | qca->tx_vote;\n\t\tbreak;\n\n\tdefault:\n\t\tBT_ERR(\"Voting irregularity\");\n\t\treturn;\n\t}\n\n\tif (new_vote != old_vote) {\n\t\tif (new_vote)\n\t\t\t__serial_clock_on(hu->tty);\n\t\telse\n\t\t\t__serial_clock_off(hu->tty);\n\n\t\tBT_DBG(\"Vote serial clock %s(%s)\", new_vote ? \"true\" : \"false\",\n\t\t       vote ? \"true\" : \"false\");\n\n\t\tdiff = jiffies_to_msecs(jiffies - qca->vote_last_jif);\n\n\t\tif (new_vote) {\n\t\t\tqca->votes_on++;\n\t\t\tqca->vote_off_ms += diff;\n\t\t} else {\n\t\t\tqca->votes_off++;\n\t\t\tqca->vote_on_ms += diff;\n\t\t}\n\t\tqca->vote_last_jif = jiffies;\n\t}\n}\n\n/* Builds and sends an HCI_IBS command packet.\n * These are very simple packets with only 1 cmd byte.\n */\nstatic int send_hci_ibs_cmd(u8 cmd, struct hci_uart *hu)\n{\n\tint err = 0;\n\tstruct sk_buff *skb = NULL;\n\tstruct qca_data *qca = hu->priv;\n\n\tBT_DBG(\"hu %p send hci ibs cmd 0x%x\", hu, cmd);\n\n\tskb = bt_skb_alloc(1, GFP_ATOMIC);\n\tif (!skb) {\n\t\tBT_ERR(\"Failed to allocate memory for HCI_IBS packet\");\n\t\treturn -ENOMEM;\n\t}\n\n\t/* Assign HCI_IBS type */\n\t*skb_put(skb, 1) = cmd;\n\n\tskb_queue_tail(&qca->txq, skb);\n\n\treturn err;\n}\n\nstatic void qca_wq_awake_device(struct work_struct *work)\n{\n\tstruct qca_data *qca = container_of(work, struct qca_data,\n\t\t\t\t\t    ws_awake_device);\n\tstruct hci_uart *hu = qca->hu;\n\tunsigned long retrans_delay;\n\n\tBT_DBG(\"hu %p wq awake device\", hu);\n\n\t/* Vote for serial clock */\n\tserial_clock_vote(HCI_IBS_TX_VOTE_CLOCK_ON, hu);\n\n\tspin_lock(&qca->hci_ibs_lock);\n\n\t/* Send wake indication to device */\n\tif (send_hci_ibs_cmd(HCI_IBS_WAKE_IND, hu) < 0)\n\t\tBT_ERR(\"Failed to send WAKE to device\");\n\n\tqca->ibs_sent_wakes++;\n\n\t/* Start retransmit timer */\n\tretrans_delay = msecs_to_jiffies(qca->wake_retrans);\n\tmod_timer(&qca->wake_retrans_timer, jiffies + retrans_delay);\n\n\tspin_unlock(&qca->hci_ibs_lock);\n\n\t/* Actually send the packets */\n\thci_uart_tx_wakeup(hu);\n}\n\nstatic void qca_wq_awake_rx(struct work_struct *work)\n{\n\tstruct qca_data *qca = container_of(work, struct qca_data,\n\t\t\t\t\t    ws_awake_rx);\n\tstruct hci_uart *hu = qca->hu;\n\n\tBT_DBG(\"hu %p wq awake rx\", hu);\n\n\tserial_clock_vote(HCI_IBS_RX_VOTE_CLOCK_ON, hu);\n\n\tspin_lock(&qca->hci_ibs_lock);\n\tqca->rx_ibs_state = HCI_IBS_RX_AWAKE;\n\n\t/* Always acknowledge device wake up,\n\t * sending IBS message doesn't count as TX ON.\n\t */\n\tif (send_hci_ibs_cmd(HCI_IBS_WAKE_ACK, hu) < 0)\n\t\tBT_ERR(\"Failed to acknowledge device wake up\");\n\n\tqca->ibs_sent_wacks++;\n\n\tspin_unlock(&qca->hci_ibs_lock);\n\n\t/* Actually send the packets */\n\thci_uart_tx_wakeup(hu);\n}\n\nstatic void qca_wq_serial_rx_clock_vote_off(struct work_struct *work)\n{\n\tstruct qca_data *qca = container_of(work, struct qca_data,\n\t\t\t\t\t    ws_rx_vote_off);\n\tstruct hci_uart *hu = qca->hu;\n\n\tBT_DBG(\"hu %p rx clock vote off\", hu);\n\n\tserial_clock_vote(HCI_IBS_RX_VOTE_CLOCK_OFF, hu);\n}\n\nstatic void qca_wq_serial_tx_clock_vote_off(struct work_struct *work)\n{\n\tstruct qca_data *qca = container_of(work, struct qca_data,\n\t\t\t\t\t    ws_tx_vote_off);\n\tstruct hci_uart *hu = qca->hu;\n\n\tBT_DBG(\"hu %p tx clock vote off\", hu);\n\n\t/* Run HCI tx handling unlocked */\n\thci_uart_tx_wakeup(hu);\n\n\t/* Now that message queued to tty driver, vote for tty clocks off.\n\t * It is up to the tty driver to pend the clocks off until tx done.\n\t */\n\tserial_clock_vote(HCI_IBS_TX_VOTE_CLOCK_OFF, hu);\n}\n\nstatic void hci_ibs_tx_idle_timeout(unsigned long arg)\n{\n\tstruct hci_uart *hu = (struct hci_uart *)arg;\n\tstruct qca_data *qca = hu->priv;\n\tunsigned long flags;\n\n\tBT_DBG(\"hu %p idle timeout in %d state\", hu, qca->tx_ibs_state);\n\n\tspin_lock_irqsave_nested(&qca->hci_ibs_lock,\n\t\t\t\t flags, SINGLE_DEPTH_NESTING);\n\n\tswitch (qca->tx_ibs_state) {\n\tcase HCI_IBS_TX_AWAKE:\n\t\t/* TX_IDLE, go to SLEEP */\n\t\tif (send_hci_ibs_cmd(HCI_IBS_SLEEP_IND, hu) < 0) {\n\t\t\tBT_ERR(\"Failed to send SLEEP to device\");\n\t\t\tbreak;\n\t\t}\n\t\tqca->tx_ibs_state = HCI_IBS_TX_ASLEEP;\n\t\tqca->ibs_sent_slps++;\n\t\tqueue_work(qca->workqueue, &qca->ws_tx_vote_off);\n\t\tbreak;\n\n\tcase HCI_IBS_TX_ASLEEP:\n\tcase HCI_IBS_TX_WAKING:\n\t\t/* Fall through */\n\n\tdefault:\n\t\tBT_ERR(\"Spurrious timeout tx state %d\", qca->tx_ibs_state);\n\t\tbreak;\n\t}\n\n\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\n}\n\nstatic void hci_ibs_wake_retrans_timeout(unsigned long arg)\n{\n\tstruct hci_uart *hu = (struct hci_uart *)arg;\n\tstruct qca_data *qca = hu->priv;\n\tunsigned long flags, retrans_delay;\n\tbool retransmit = false;\n\n\tBT_DBG(\"hu %p wake retransmit timeout in %d state\",\n\t\thu, qca->tx_ibs_state);\n\n\tspin_lock_irqsave_nested(&qca->hci_ibs_lock,\n\t\t\t\t flags, SINGLE_DEPTH_NESTING);\n\n\tswitch (qca->tx_ibs_state) {\n\tcase HCI_IBS_TX_WAKING:\n\t\t/* No WAKE_ACK, retransmit WAKE */\n\t\tretransmit = true;\n\t\tif (send_hci_ibs_cmd(HCI_IBS_WAKE_IND, hu) < 0) {\n\t\t\tBT_ERR(\"Failed to acknowledge device wake up\");\n\t\t\tbreak;\n\t\t}\n\t\tqca->ibs_sent_wakes++;\n\t\tretrans_delay = msecs_to_jiffies(qca->wake_retrans);\n\t\tmod_timer(&qca->wake_retrans_timer, jiffies + retrans_delay);\n\t\tbreak;\n\n\tcase HCI_IBS_TX_ASLEEP:\n\tcase HCI_IBS_TX_AWAKE:\n\t\t/* Fall through */\n\n\tdefault:\n\t\tBT_ERR(\"Spurrious timeout tx state %d\", qca->tx_ibs_state);\n\t\tbreak;\n\t}\n\n\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\n\n\tif (retransmit)\n\t\thci_uart_tx_wakeup(hu);\n}\n\n/* Initialize protocol */\nstatic int qca_open(struct hci_uart *hu)\n{\n\tstruct qca_data *qca;\n\n\tBT_DBG(\"hu %p qca_open\", hu);\n\n\tqca = kzalloc(sizeof(struct qca_data), GFP_ATOMIC);\n\tif (!qca)\n\t\treturn -ENOMEM;\n\n\tskb_queue_head_init(&qca->txq);\n\tskb_queue_head_init(&qca->tx_wait_q);\n\tspin_lock_init(&qca->hci_ibs_lock);\n\tqca->workqueue = alloc_ordered_workqueue(\"qca_wq\", 0);\n\tif (!qca->workqueue) {\n\t\tBT_ERR(\"QCA Workqueue not initialized properly\");\n\t\tkfree(qca);\n\t\treturn -ENOMEM;\n\t}\n\n\tINIT_WORK(&qca->ws_awake_rx, qca_wq_awake_rx);\n\tINIT_WORK(&qca->ws_awake_device, qca_wq_awake_device);\n\tINIT_WORK(&qca->ws_rx_vote_off, qca_wq_serial_rx_clock_vote_off);\n\tINIT_WORK(&qca->ws_tx_vote_off, qca_wq_serial_tx_clock_vote_off);\n\n\tqca->hu = hu;\n\n\t/* Assume we start with both sides asleep -- extra wakes OK */\n\tqca->tx_ibs_state = HCI_IBS_TX_ASLEEP;\n\tqca->rx_ibs_state = HCI_IBS_RX_ASLEEP;\n\n\t/* clocks actually on, but we start votes off */\n\tqca->tx_vote = false;\n\tqca->rx_vote = false;\n\tqca->flags = 0;\n\n\tqca->ibs_sent_wacks = 0;\n\tqca->ibs_sent_slps = 0;\n\tqca->ibs_sent_wakes = 0;\n\tqca->ibs_recv_wacks = 0;\n\tqca->ibs_recv_slps = 0;\n\tqca->ibs_recv_wakes = 0;\n\tqca->vote_last_jif = jiffies;\n\tqca->vote_on_ms = 0;\n\tqca->vote_off_ms = 0;\n\tqca->votes_on = 0;\n\tqca->votes_off = 0;\n\tqca->tx_votes_on = 0;\n\tqca->tx_votes_off = 0;\n\tqca->rx_votes_on = 0;\n\tqca->rx_votes_off = 0;\n\n\thu->priv = qca;\n\n\tsetup_timer(&qca->wake_retrans_timer, hci_ibs_wake_retrans_timeout,\n\t\t    (u_long)hu);\n\tqca->wake_retrans = IBS_WAKE_RETRANS_TIMEOUT_MS;\n\n\tsetup_timer(&qca->tx_idle_timer, hci_ibs_tx_idle_timeout, (u_long)hu);\n\tqca->tx_idle_delay = IBS_TX_IDLE_TIMEOUT_MS;\n\n\tBT_DBG(\"HCI_UART_QCA open, tx_idle_delay=%u, wake_retrans=%u\",\n\t       qca->tx_idle_delay, qca->wake_retrans);\n\n\treturn 0;\n}\n\nstatic void qca_debugfs_init(struct hci_dev *hdev)\n{\n\tstruct hci_uart *hu = hci_get_drvdata(hdev);\n\tstruct qca_data *qca = hu->priv;\n\tstruct dentry *ibs_dir;\n\tumode_t mode;\n\n\tif (!hdev->debugfs)\n\t\treturn;\n\n\tibs_dir = debugfs_create_dir(\"ibs\", hdev->debugfs);\n\n\t/* read only */\n\tmode = S_IRUGO;\n\tdebugfs_create_u8(\"tx_ibs_state\", mode, ibs_dir, &qca->tx_ibs_state);\n\tdebugfs_create_u8(\"rx_ibs_state\", mode, ibs_dir, &qca->rx_ibs_state);\n\tdebugfs_create_u64(\"ibs_sent_sleeps\", mode, ibs_dir,\n\t\t\t   &qca->ibs_sent_slps);\n\tdebugfs_create_u64(\"ibs_sent_wakes\", mode, ibs_dir,\n\t\t\t   &qca->ibs_sent_wakes);\n\tdebugfs_create_u64(\"ibs_sent_wake_acks\", mode, ibs_dir,\n\t\t\t   &qca->ibs_sent_wacks);\n\tdebugfs_create_u64(\"ibs_recv_sleeps\", mode, ibs_dir,\n\t\t\t   &qca->ibs_recv_slps);\n\tdebugfs_create_u64(\"ibs_recv_wakes\", mode, ibs_dir,\n\t\t\t   &qca->ibs_recv_wakes);\n\tdebugfs_create_u64(\"ibs_recv_wake_acks\", mode, ibs_dir,\n\t\t\t   &qca->ibs_recv_wacks);\n\tdebugfs_create_bool(\"tx_vote\", mode, ibs_dir, &qca->tx_vote);\n\tdebugfs_create_u64(\"tx_votes_on\", mode, ibs_dir, &qca->tx_votes_on);\n\tdebugfs_create_u64(\"tx_votes_off\", mode, ibs_dir, &qca->tx_votes_off);\n\tdebugfs_create_bool(\"rx_vote\", mode, ibs_dir, &qca->rx_vote);\n\tdebugfs_create_u64(\"rx_votes_on\", mode, ibs_dir, &qca->rx_votes_on);\n\tdebugfs_create_u64(\"rx_votes_off\", mode, ibs_dir, &qca->rx_votes_off);\n\tdebugfs_create_u64(\"votes_on\", mode, ibs_dir, &qca->votes_on);\n\tdebugfs_create_u64(\"votes_off\", mode, ibs_dir, &qca->votes_off);\n\tdebugfs_create_u32(\"vote_on_ms\", mode, ibs_dir, &qca->vote_on_ms);\n\tdebugfs_create_u32(\"vote_off_ms\", mode, ibs_dir, &qca->vote_off_ms);\n\n\t/* read/write */\n\tmode = S_IRUGO | S_IWUSR;\n\tdebugfs_create_u32(\"wake_retrans\", mode, ibs_dir, &qca->wake_retrans);\n\tdebugfs_create_u32(\"tx_idle_delay\", mode, ibs_dir,\n\t\t\t   &qca->tx_idle_delay);\n}\n\n/* Flush protocol data */\nstatic int qca_flush(struct hci_uart *hu)\n{\n\tstruct qca_data *qca = hu->priv;\n\n\tBT_DBG(\"hu %p qca flush\", hu);\n\n\tskb_queue_purge(&qca->tx_wait_q);\n\tskb_queue_purge(&qca->txq);\n\n\treturn 0;\n}\n\n/* Close protocol */\nstatic int qca_close(struct hci_uart *hu)\n{\n\tstruct qca_data *qca = hu->priv;\n\n\tBT_DBG(\"hu %p qca close\", hu);\n\n\tserial_clock_vote(HCI_IBS_VOTE_STATS_UPDATE, hu);\n\n\tskb_queue_purge(&qca->tx_wait_q);\n\tskb_queue_purge(&qca->txq);\n\tdel_timer(&qca->tx_idle_timer);\n\tdel_timer(&qca->wake_retrans_timer);\n\tdestroy_workqueue(qca->workqueue);\n\tqca->hu = NULL;\n\n\tkfree_skb(qca->rx_skb);\n\n\thu->priv = NULL;\n\n\tkfree(qca);\n\n\treturn 0;\n}\n\n/* Called upon a wake-up-indication from the device.\n */\nstatic void device_want_to_wakeup(struct hci_uart *hu)\n{\n\tunsigned long flags;\n\tstruct qca_data *qca = hu->priv;\n\n\tBT_DBG(\"hu %p want to wake up\", hu);\n\n\tspin_lock_irqsave(&qca->hci_ibs_lock, flags);\n\n\tqca->ibs_recv_wakes++;\n\n\tswitch (qca->rx_ibs_state) {\n\tcase HCI_IBS_RX_ASLEEP:\n\t\t/* Make sure clock is on - we may have turned clock off since\n\t\t * receiving the wake up indicator awake rx clock.\n\t\t */\n\t\tqueue_work(qca->workqueue, &qca->ws_awake_rx);\n\t\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\n\t\treturn;\n\n\tcase HCI_IBS_RX_AWAKE:\n\t\t/* Always acknowledge device wake up,\n\t\t * sending IBS message doesn't count as TX ON.\n\t\t */\n\t\tif (send_hci_ibs_cmd(HCI_IBS_WAKE_ACK, hu) < 0) {\n\t\t\tBT_ERR(\"Failed to acknowledge device wake up\");\n\t\t\tbreak;\n\t\t}\n\t\tqca->ibs_sent_wacks++;\n\t\tbreak;\n\n\tdefault:\n\t\t/* Any other state is illegal */\n\t\tBT_ERR(\"Received HCI_IBS_WAKE_IND in rx state %d\",\n\t\t       qca->rx_ibs_state);\n\t\tbreak;\n\t}\n\n\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\n\n\t/* Actually send the packets */\n\thci_uart_tx_wakeup(hu);\n}\n\n/* Called upon a sleep-indication from the device.\n */\nstatic void device_want_to_sleep(struct hci_uart *hu)\n{\n\tunsigned long flags;\n\tstruct qca_data *qca = hu->priv;\n\n\tBT_DBG(\"hu %p want to sleep\", hu);\n\n\tspin_lock_irqsave(&qca->hci_ibs_lock, flags);\n\n\tqca->ibs_recv_slps++;\n\n\tswitch (qca->rx_ibs_state) {\n\tcase HCI_IBS_RX_AWAKE:\n\t\t/* Update state */\n\t\tqca->rx_ibs_state = HCI_IBS_RX_ASLEEP;\n\t\t/* Vote off rx clock under workqueue */\n\t\tqueue_work(qca->workqueue, &qca->ws_rx_vote_off);\n\t\tbreak;\n\n\tcase HCI_IBS_RX_ASLEEP:\n\t\t/* Fall through */\n\n\tdefault:\n\t\t/* Any other state is illegal */\n\t\tBT_ERR(\"Received HCI_IBS_SLEEP_IND in rx state %d\",\n\t\t       qca->rx_ibs_state);\n\t\tbreak;\n\t}\n\n\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\n}\n\n/* Called upon wake-up-acknowledgement from the device\n */\nstatic void device_woke_up(struct hci_uart *hu)\n{\n\tunsigned long flags, idle_delay;\n\tstruct qca_data *qca = hu->priv;\n\tstruct sk_buff *skb = NULL;\n\n\tBT_DBG(\"hu %p woke up\", hu);\n\n\tspin_lock_irqsave(&qca->hci_ibs_lock, flags);\n\n\tqca->ibs_recv_wacks++;\n\n\tswitch (qca->tx_ibs_state) {\n\tcase HCI_IBS_TX_AWAKE:\n\t\t/* Expect one if we send 2 WAKEs */\n\t\tBT_DBG(\"Received HCI_IBS_WAKE_ACK in tx state %d\",\n\t\t       qca->tx_ibs_state);\n\t\tbreak;\n\n\tcase HCI_IBS_TX_WAKING:\n\t\t/* Send pending packets */\n\t\twhile ((skb = skb_dequeue(&qca->tx_wait_q)))\n\t\t\tskb_queue_tail(&qca->txq, skb);\n\n\t\t/* Switch timers and change state to HCI_IBS_TX_AWAKE */\n\t\tdel_timer(&qca->wake_retrans_timer);\n\t\tidle_delay = msecs_to_jiffies(qca->tx_idle_delay);\n\t\tmod_timer(&qca->tx_idle_timer, jiffies + idle_delay);\n\t\tqca->tx_ibs_state = HCI_IBS_TX_AWAKE;\n\t\tbreak;\n\n\tcase HCI_IBS_TX_ASLEEP:\n\t\t/* Fall through */\n\n\tdefault:\n\t\tBT_ERR(\"Received HCI_IBS_WAKE_ACK in tx state %d\",\n\t\t       qca->tx_ibs_state);\n\t\tbreak;\n\t}\n\n\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\n\n\t/* Actually send the packets */\n\thci_uart_tx_wakeup(hu);\n}\n\n/* Enqueue frame for transmittion (padding, crc, etc) may be called from\n * two simultaneous tasklets.\n */\nstatic int qca_enqueue(struct hci_uart *hu, struct sk_buff *skb)\n{\n\tunsigned long flags = 0, idle_delay;\n\tstruct qca_data *qca = hu->priv;\n\n\tBT_DBG(\"hu %p qca enq skb %p tx_ibs_state %d\", hu, skb,\n\t       qca->tx_ibs_state);\n\n\t/* Prepend skb with frame type */\n\tmemcpy(skb_push(skb, 1), &hci_skb_pkt_type(skb), 1);\n\n\t/* Don't go to sleep in middle of patch download or\n\t * Out-Of-Band(GPIOs control) sleep is selected.\n\t */\n\tif (!test_bit(STATE_IN_BAND_SLEEP_ENABLED, &qca->flags)) {\n\t\tskb_queue_tail(&qca->txq, skb);\n\t\treturn 0;\n\t}\n\n\tspin_lock_irqsave(&qca->hci_ibs_lock, flags);\n\n\t/* Act according to current state */\n\tswitch (qca->tx_ibs_state) {\n\tcase HCI_IBS_TX_AWAKE:\n\t\tBT_DBG(\"Device awake, sending normally\");\n\t\tskb_queue_tail(&qca->txq, skb);\n\t\tidle_delay = msecs_to_jiffies(qca->tx_idle_delay);\n\t\tmod_timer(&qca->tx_idle_timer, jiffies + idle_delay);\n\t\tbreak;\n\n\tcase HCI_IBS_TX_ASLEEP:\n\t\tBT_DBG(\"Device asleep, waking up and queueing packet\");\n\t\t/* Save packet for later */\n\t\tskb_queue_tail(&qca->tx_wait_q, skb);\n\n\t\tqca->tx_ibs_state = HCI_IBS_TX_WAKING;\n\t\t/* Schedule a work queue to wake up device */\n\t\tqueue_work(qca->workqueue, &qca->ws_awake_device);\n\t\tbreak;\n\n\tcase HCI_IBS_TX_WAKING:\n\t\tBT_DBG(\"Device waking up, queueing packet\");\n\t\t/* Transient state; just keep packet for later */\n\t\tskb_queue_tail(&qca->tx_wait_q, skb);\n\t\tbreak;\n\n\tdefault:\n\t\tBT_ERR(\"Illegal tx state: %d (losing packet)\",\n\t\t       qca->tx_ibs_state);\n\t\tkfree_skb(skb);\n\t\tbreak;\n\t}\n\n\tspin_unlock_irqrestore(&qca->hci_ibs_lock, flags);\n\n\treturn 0;\n}\n\nstatic int qca_ibs_sleep_ind(struct hci_dev *hdev, struct sk_buff *skb)\n{\n\tstruct hci_uart *hu = hci_get_drvdata(hdev);\n\n\tBT_DBG(\"hu %p recv hci ibs cmd 0x%x\", hu, HCI_IBS_SLEEP_IND);\n\n\tdevice_want_to_sleep(hu);\n\n\tkfree_skb(skb);\n\treturn 0;\n}\n\nstatic int qca_ibs_wake_ind(struct hci_dev *hdev, struct sk_buff *skb)\n{\n\tstruct hci_uart *hu = hci_get_drvdata(hdev);\n\n\tBT_DBG(\"hu %p recv hci ibs cmd 0x%x\", hu, HCI_IBS_WAKE_IND);\n\n\tdevice_want_to_wakeup(hu);\n\n\tkfree_skb(skb);\n\treturn 0;\n}\n\nstatic int qca_ibs_wake_ack(struct hci_dev *hdev, struct sk_buff *skb)\n{\n\tstruct hci_uart *hu = hci_get_drvdata(hdev);\n\n\tBT_DBG(\"hu %p recv hci ibs cmd 0x%x\", hu, HCI_IBS_WAKE_ACK);\n\n\tdevice_woke_up(hu);\n\n\tkfree_skb(skb);\n\treturn 0;\n}\n\n#define QCA_IBS_SLEEP_IND_EVENT \\\n\t.type = HCI_IBS_SLEEP_IND, \\\n\t.hlen = 0, \\\n\t.loff = 0, \\\n\t.lsize = 0, \\\n\t.maxlen = HCI_MAX_IBS_SIZE\n\n#define QCA_IBS_WAKE_IND_EVENT \\\n\t.type = HCI_IBS_WAKE_IND, \\\n\t.hlen = 0, \\\n\t.loff = 0, \\\n\t.lsize = 0, \\\n\t.maxlen = HCI_MAX_IBS_SIZE\n\n#define QCA_IBS_WAKE_ACK_EVENT \\\n\t.type = HCI_IBS_WAKE_ACK, \\\n\t.hlen = 0, \\\n\t.loff = 0, \\\n\t.lsize = 0, \\\n\t.maxlen = HCI_MAX_IBS_SIZE\n\nstatic const struct h4_recv_pkt qca_recv_pkts[] = {\n\t{ H4_RECV_ACL,             .recv = hci_recv_frame    },\n\t{ H4_RECV_SCO,             .recv = hci_recv_frame    },\n\t{ H4_RECV_EVENT,           .recv = hci_recv_frame    },\n\t{ QCA_IBS_WAKE_IND_EVENT,  .recv = qca_ibs_wake_ind  },\n\t{ QCA_IBS_WAKE_ACK_EVENT,  .recv = qca_ibs_wake_ack  },\n\t{ QCA_IBS_SLEEP_IND_EVENT, .recv = qca_ibs_sleep_ind },\n};\n\nstatic int qca_recv(struct hci_uart *hu, const void *data, int count)\n{\n\tstruct qca_data *qca = hu->priv;\n\n\tif (!test_bit(HCI_UART_REGISTERED, &hu->flags))\n\t\treturn -EUNATCH;\n\n\tqca->rx_skb = h4_recv_buf(hu->hdev, qca->rx_skb, data, count,\n\t\t\t\t  qca_recv_pkts, ARRAY_SIZE(qca_recv_pkts));\n\tif (IS_ERR(qca->rx_skb)) {\n\t\tint err = PTR_ERR(qca->rx_skb);\n\t\tBT_ERR(\"%s: Frame reassembly failed (%d)\", hu->hdev->name, err);\n\t\tqca->rx_skb = NULL;\n\t\treturn err;\n\t}\n\n\treturn count;\n}\n\nstatic struct sk_buff *qca_dequeue(struct hci_uart *hu)\n{\n\tstruct qca_data *qca = hu->priv;\n\n\treturn skb_dequeue(&qca->txq);\n}\n\nstatic uint8_t qca_get_baudrate_value(int speed)\n{\n\tswitch (speed) {\n\tcase 9600:\n\t\treturn QCA_BAUDRATE_9600;\n\tcase 19200:\n\t\treturn QCA_BAUDRATE_19200;\n\tcase 38400:\n\t\treturn QCA_BAUDRATE_38400;\n\tcase 57600:\n\t\treturn QCA_BAUDRATE_57600;\n\tcase 115200:\n\t\treturn QCA_BAUDRATE_115200;\n\tcase 230400:\n\t\treturn QCA_BAUDRATE_230400;\n\tcase 460800:\n\t\treturn QCA_BAUDRATE_460800;\n\tcase 500000:\n\t\treturn QCA_BAUDRATE_500000;\n\tcase 921600:\n\t\treturn QCA_BAUDRATE_921600;\n\tcase 1000000:\n\t\treturn QCA_BAUDRATE_1000000;\n\tcase 2000000:\n\t\treturn QCA_BAUDRATE_2000000;\n\tcase 3000000:\n\t\treturn QCA_BAUDRATE_3000000;\n\tcase 3500000:\n\t\treturn QCA_BAUDRATE_3500000;\n\tdefault:\n\t\treturn QCA_BAUDRATE_115200;\n\t}\n}\n\nstatic int qca_set_baudrate(struct hci_dev *hdev, uint8_t baudrate)\n{\n\tstruct hci_uart *hu = hci_get_drvdata(hdev);\n\tstruct qca_data *qca = hu->priv;\n\tstruct sk_buff *skb;\n\tu8 cmd[] = { 0x01, 0x48, 0xFC, 0x01, 0x00 };\n\n\tif (baudrate > QCA_BAUDRATE_3000000)\n\t\treturn -EINVAL;\n\n\tcmd[4] = baudrate;\n\n\tskb = bt_skb_alloc(sizeof(cmd), GFP_ATOMIC);\n\tif (!skb) {\n\t\tBT_ERR(\"Failed to allocate memory for baudrate packet\");\n\t\treturn -ENOMEM;\n\t}\n\n\t/* Assign commands to change baudrate and packet type. */\n\tmemcpy(skb_put(skb, sizeof(cmd)), cmd, sizeof(cmd));\n\thci_skb_pkt_type(skb) = HCI_COMMAND_PKT;\n\n\tskb_queue_tail(&qca->txq, skb);\n\thci_uart_tx_wakeup(hu);\n\n\t/* wait 300ms to change new baudrate on controller side\n\t * controller will come back after they receive this HCI command\n\t * then host can communicate with new baudrate to controller\n\t */\n\tset_current_state(TASK_UNINTERRUPTIBLE);\n\tschedule_timeout(msecs_to_jiffies(BAUDRATE_SETTLE_TIMEOUT_MS));\n\tset_current_state(TASK_INTERRUPTIBLE);\n\n\treturn 0;\n}\n\nstatic int qca_setup(struct hci_uart *hu)\n{\n\tstruct hci_dev *hdev = hu->hdev;\n\tstruct qca_data *qca = hu->priv;\n\tunsigned int speed, qca_baudrate = QCA_BAUDRATE_115200;\n\tint ret;\n\n\tBT_INFO(\"%s: ROME setup\", hdev->name);\n\n\t/* Patch downloading has to be done without IBS mode */\n\tclear_bit(STATE_IN_BAND_SLEEP_ENABLED, &qca->flags);\n\n\t/* Setup initial baudrate */\n\tspeed = 0;\n\tif (hu->init_speed)\n\t\tspeed = hu->init_speed;\n\telse if (hu->proto->init_speed)\n\t\tspeed = hu->proto->init_speed;\n\n\tif (speed)\n\t\thci_uart_set_baudrate(hu, speed);\n\n\t/* Setup user speed if needed */\n\tspeed = 0;\n\tif (hu->oper_speed)\n\t\tspeed = hu->oper_speed;\n\telse if (hu->proto->oper_speed)\n\t\tspeed = hu->proto->oper_speed;\n\n\tif (speed) {\n\t\tqca_baudrate = qca_get_baudrate_value(speed);\n\n\t\tBT_INFO(\"%s: Set UART speed to %d\", hdev->name, speed);\n\t\tret = qca_set_baudrate(hdev, qca_baudrate);\n\t\tif (ret) {\n\t\t\tBT_ERR(\"%s: Failed to change the baud rate (%d)\",\n\t\t\t       hdev->name, ret);\n\t\t\treturn ret;\n\t\t}\n\t\thci_uart_set_baudrate(hu, speed);\n\t}\n\n\t/* Setup patch / NVM configurations */\n\tret = qca_uart_setup_rome(hdev, qca_baudrate);\n\tif (!ret) {\n\t\tset_bit(STATE_IN_BAND_SLEEP_ENABLED, &qca->flags);\n\t\tqca_debugfs_init(hdev);\n\t}\n\n\t/* Setup bdaddr */\n\thu->hdev->set_bdaddr = qca_set_bdaddr_rome;\n\n\treturn ret;\n}\n\nstatic struct hci_uart_proto qca_proto = {\n\t.id\t\t= HCI_UART_QCA,\n\t.name\t\t= \"QCA\",\n\t.manufacturer\t= 29,\n\t.init_speed\t= 115200,\n\t.oper_speed\t= 3000000,\n\t.open\t\t= qca_open,\n\t.close\t\t= qca_close,\n\t.flush\t\t= qca_flush,\n\t.setup\t\t= qca_setup,\n\t.recv\t\t= qca_recv,\n\t.enqueue\t= qca_enqueue,\n\t.dequeue\t= qca_dequeue,\n};\n\nint __init qca_init(void)\n{\n\treturn hci_uart_register_proto(&qca_proto);\n}\n\nint __exit qca_deinit(void)\n{\n\treturn hci_uart_unregister_proto(&qca_proto);\n}\n`\n\n\n// WEBPACK FOOTER //\n// ./src/FakeCode.js","/**\n * Jscii - Image to ASCII converter\n * http://enotionz.github.com/jscii/\n * Author: Dominick Pham (@enotionz | http://dph.am)\n */\n\n!function() {\n\n\tnavigator.getUserMedia = navigator.getUserMedia ||\n\t\tnavigator.webkitGetUserMedia ||\n\t\tnavigator.mozGetUserMedia ||\n\t\tnavigator.msGetUserMedia;\n\n\t/**\n\t * value to character mapping from dark to light\n\t * add more characters and they will be accounted for automatically\n\t * note: the extra &nbsp; is to account for the value range inclusive of 100%\n\t */\n\tvar chars = ['@','#','$','=','*','!',';',':','~','-',',','.','&nbsp;', '&nbsp;'];\n\t// invert colors\n\tchars = [\"&nbsp;\", \"&nbsp;\", \".\", \",\", \"-\", \"~\", \":\", \";\", \"!\", \"*\", \"=\", \"$\", \"#\", \"@\"];\n\tvar charLen = chars.length-1;\n\tfunction getChar(val) { return chars[parseInt(val*charLen, 10)]; }\n\n\t/**\n\t * log when getUserMedia or when video metadata loading fail\n\t */\n\tfunction logError(err) { if(console && console.log) console.log('Error!', err); return false; }\n\n\t/**\n\t * Options:\n\t * el        - DOM node (img or video)\n\t * container - if supplied, ascii string will automatically be set on container innerHTML during a render\n\t * fn        - function, callback to fire during a render with ascii string as arguments[0]\n\t * width     - hi-res images/videos must be resized down, specify width and jscii will figure out height\n\t * color     - enable color ascii (highly experimental)\n\t * interval  - integer - for videos only, this is the interval between each render\n\t * webrtc    - bool, default false, only applicable if 'el' is a video\n\t */\n\tfunction Jscii(params) {\n\t\tvar self = this;\n\n\t\tvar el = this.el = params.el;\n\t\tthis.container = params.container;\n\t\tthis.fn = typeof params.fn === 'function' ? params.fn : null;\n\t\tthis.width = typeof params.width === 'number' ? params.width : 150;\n\t\tthis.color = !!params.color;\n\n\t\tthis.canvas = document.createElement('canvas');\n\t\tthis.ctx = this.canvas.getContext('2d');\n\t\tvar nodeName = el.nodeName;\n\t\tif(nodeName === 'IMG') {\n\t\t\tself.render();\n\t\t\tel.addEventListener('load', function(){ self.render(); });\n\t\t} else if(nodeName === 'VIDEO') {\n\t\t\tthis.interval = typeof params.interval === 'number' ? params.interval : 15;\n\t\t\tthis.webrtc = !!params.webrtc;\n\n\t\t\tif(this.webrtc) {\n\t\t\t\tif(typeof navigator.getUserMedia !== 'function') {\n\t\t\t\t\treturn logError((el.innerHTML = 'Error: browser does not support WebRTC'));\n\t\t\t\t}\n\t\t\t\tnavigator.getUserMedia({video: true, audio: false}, function(localMediaStream){\n\t\t\t\t\tself.mediaStream = localMediaStream;\n\t\t\t\t\tel.src = (window.URL || window.webkitURL).createObjectURL(localMediaStream);\n\t\t\t\t}, logError);\n\t\t\t}\n\t\t\tel.addEventListener('loadeddata', function() { self.play(); });\n\t\t}\n\t}\n\n\t/**\n\t * start rendering, for video type only\n\t */\n\tJscii.prototype.play = function() {\n\t\tvar self = this;\n\t\tself.pause().videoTimer = setInterval(function() {\n\t\t\tif(self.mediaStream || !self.webrtc) self.render();\n\t\t}, self.interval);\n\t\treturn self;\n\t};\n\n\t/**\n\t * pause rendering, for video type only\n\t */\n\tJscii.prototype.pause = function() {\n\t\tif(this.videoTimer) clearInterval(this.videoTimer);\n\t\treturn this;\n\t};\n\n\t/**\n\t * getter/setter for output dimension\n\t */\n\tJscii.prototype.dimension = function(width, height) {\n\t\tif(typeof width === 'number' && typeof height === 'number') {\n\t\t\tthis._scaledWidth = this.canvas.width = width;\n\t\t\tthis._scaledHeight = this.canvas.height = height;\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn { width: this._scaledWidth, height: this._scaledHeight };\n\t\t}\n\t};\n\n\t/**\n\t * gets context image data, perform ascii conversion, append string to container\n\t */\n\tJscii.prototype.render = function() {\n\t\tvar el = this.el, nodeName = el.nodeName, ratio;\n\t\tvar dim = this.dimension(), width, height;\n\t\tif(!dim.width || !dim.height) {\n\t\t\tratio = nodeName === 'IMG' ? el.height/el.width : el.videoHeight/el.videoWidth;\n\t\t\tthis.dimension(this.width, parseInt(this.width*ratio, 10));\n\t\t\tdim = this.dimension();\n\t\t}\n\t\twidth = dim.width;\n\t\theight = dim.height;\n\n\t\t// might take a few cycles before we\n\t\tif(!width || !height) return;\n\n\t\tthis.ctx.drawImage(this.el, 0, 0, width, height);\n\t\tthis.imageData = this.ctx.getImageData(0, 0, width, height).data;\n\t\tvar asciiStr = this.getAsciiString();\n\t\tif(this.container) this.container.innerHTML = asciiStr;\n\t\tif(this.fn) this.fn(asciiStr);\n\t};\n\n\t/**\n\t * given a picture/frame's pixel data and a defined width and height\n\t * return the ASCII string representing the image\n\t */\n\tJscii.prototype.getAsciiString = function() {\n\t\tvar dim = this.dimension(), width = dim.width, height = dim.height;\n\t\tvar len = width*height, d = this.imageData, str = '';\n\n\t\t// helper function to retrieve rgb value from pixel data\n\t\tvar getRGB = function(i) { return [d[i=i*4], d[i+1], d[i+2]]; };\n\n\t\tfor(var i=0; i<len; i++) {\n\t\t\tif(i%width === 0) str += '\\n';\n\t\t\tvar rgb = getRGB(i);\n\t\t\tvar val = Math.max(rgb[0], rgb[1], rgb[2])/255;\n\t\t\tif(this.color) str += '<font style=\"color: rgb('+rgb.join(',')+')\">'+getChar(val)+'</font>';\n\t\t\telse str += getChar(val);\n\t\t}\n\t\treturn str;\n\t};\n\n\twindow.Jscii = Jscii;\n\n}();\n\n\n// WEBPACK FOOTER //\n// ./src/Jscii.js","import _ from 'lodash'\n\nfunction RuleGenerator(args) {\n\tthis.selectionCount = {}\n\tthis.improvisers = args.improvisers\n\tthis.ruleData = _.clone(args.ruleData)\n\tthis.allowRepeats = args.allowRepeats ? args.allowRepeats : false\n}\n\nRuleGenerator.prototype.incrementSelectionCount = function (name) {\n  this.selectionCount[name] = this.selectionCount[name] ? this.selectionCount[name] + 1 : 1\n}\n\nRuleGenerator.prototype.getSelectionCount = function (name) {\n  return typeof(this.selectionCount[name]) == 'undefined' ? 0 : this.selectionCount[name]\n}\n\nRuleGenerator.prototype.sortBySelectionCount = function (people) {\n  return people.sort((person1, person2) => {return this.getSelectionCount(person1.name) - this.getSelectionCount(person2.name)});\n}\n\nRuleGenerator.prototype.getBySelectionCount = function (people) {\n  this.shuffle(people);\n  this.sortBySelectionCount(people);\n  let person = people[0];\n  this.incrementSelectionCount(person.name);\n  return person\n}\n\nRuleGenerator.prototype.shuffle = function (a) {\n  for (let i = a.length; i; i--) {\n    let j = Math.floor(Math.random() * i);\n    [a[i - 1], a[j]] = [a[j], a[i - 1]];\n  }\n}\n\nRuleGenerator.prototype.random = function (arr) {\n  let person = arr[parseInt(Math.random() * arr.length)]\n  return person;\n}\n\nRuleGenerator.prototype.randInd = function (arr) {\n  return parseInt(Math.random() * arr.length);\n}\n\nRuleGenerator.prototype.selectRule = function (rules) {\n  let r = Math.random()\n  for (var i = 0; i < rules.length; i++) {\n    if (rules[i].probCeil > r)\n      return rules[i];\n  }\n}\n\nRuleGenerator.prototype.generateReverseRuleText = function (ruleGen, ruleFills) {\n  let index = 0;\n  let improviser, uniqueImproviser, getWord, ruleFill, pronoun;\n  improviser = uniqueImproviser = getWord = pronoun = () => {\n    ruleFill = ruleFills[index];\n    index++;\n    return ruleFill\n  }\n  if (ruleGen.reverseTemplate.length == 0) {\n    return eval(ruleGen.reverseTemplate);\n  }\n\n  let rule = eval(ruleGen.template);\n\n  let improviserName = ruleFills[0];\n  if (rule.match(`${improviserName} is `)) {\n    return rule.replace(`${improviserName} is `, `${improviserName} is no longer `);\n  } else if (rule.match(`${improviserName} `)) {\n    return rule.replace(`${improviserName} `, `${improviserName} no longer `);\n  }\n\n  return `The following rule no longer applies: ${rule}`\n}\n\nRuleGenerator.prototype.sentenceify = function (s) {\n  s = s.charAt(0).toUpperCase() + s.slice(1);\n  s = s.charAt(s.length - 1) == '.' ? s : s + '.'\n  return s\n}\n\nRuleGenerator.prototype.generateRule = function (ruleIndex) {\n  let ruleFills = []\n\n  let uniqueImprovisers = _.clone(this.improvisers);\n\n\n  let improviser = () => {\n    let choices = this.improvisers.concat({\n      name: 'everyone',\n      pronouns: {\n        subjective: 'they',\n        objective: 'them',\n        possessive: 'their'\n      }\n    });\n    let ans = this.getBySelectionCount(choices).name;\n    ruleFills.push(ans);\n    return ans;\n  }\n\n  let uniqueImproviser = () => {\n    let ans = this.getBySelectionCount(uniqueImprovisers);\n    uniqueImprovisers.splice(uniqueImprovisers.indexOf(ans), 1);\n    ruleFills.push(ans.name);\n    return ans.name;\n  }\n\n  let getWord = category => {\n    let ans = this.random(this.ruleData.words[category]);\n    ruleFills.push(ans);\n    return ans;\n  }\n\n  let pronoun = (tense) => {\n    let pronoun = null;\n    let person = this.improvisers.concat({\n      name: 'everyone',\n      pronouns: {\n        subjective: 'they',\n        objective: 'them',\n        possessive: 'their'\n      }\n    }).find(p => ruleFills.indexOf(p.name) > -1);\n    if (!person) {\n      person = this.improvisers[0]\n      console.log('pronoun uh oh')\n    }\n    if (tense == 'objective' || tense == 'possessive') {\n      pronoun = person.pronouns[tense];\n    } else {\n      pronoun = person.pronouns.subjective      \n    }\n    ruleFills.push(pronoun);\n    return pronoun;\n  }\n\n  let parseRuleGen = (ruleGen) => {\n    return eval(ruleGen.template);\n  }\n\n  let selectedRule = typeof ruleIndex == 'number' ? this.ruleData.rules[ruleIndex] : this.selectRule(this.ruleData.rules);\n\n  if (!this.allowRepeats) {\n    this.ruleData.rules.splice(this.ruleData.rules.indexOf(selectedRule), 1);\n  }\n\n  let rule = parseRuleGen(selectedRule);\n\n  rule = rule.replace('they has', 'they have');\n  rule = rule.replace('they is', 'they are');\n\n  return {\n  \ttext: this.sentenceify(rule),\n  \tremovalText: this.sentenceify(this.generateReverseRuleText(selectedRule, ruleFills)),\n  \tremoving: false,\n  \tlateGame: selectedRule.lateGame,\n  \tisCommand: selectedRule.isCommand,\n  \tmaxDuration: selectedRule.maxDuration,\n  \ttimeCreated: Date.now()\n  }\n}\n\nexport default RuleGenerator\n\n\n// WEBPACK FOOTER //\n// ./src/components/RuleGenerator.js","import _ from 'lodash'\n\nmodule.exports = {\n\tFlip15: function(durationOfShow) {\n\n\t\tthis.durationOfShow = durationOfShow;\n\t\tthis.timeCreated = Date.now();\n\t\tthis.activeRules = 0;\n\t\tthis.timeOfLastRule = 0;\n\t\tthis.timeOfLastFlip = 0;\n\n\t\tthis.getAction = (timeElapsed) => {\n\t\t\tif (!timeElapsed) {\n\t\t\t\ttimeElapsed = Date.now() - this.timeCreated;;\n\t\t\t}\n\t\t\tvar timeSinceLastRule = timeElapsed - this.timeOfLastRule;\n\t\t\tvar timeSinceLastFlip = timeElapsed - this.timeOfLastFlip;\n\t\t\tvar percentComplete = timeElapsed / this.durationOfShow;\n\t\t\tvar perComSq = (timeElapsed * timeElapsed) / (this.durationOfShow * this.durationOfShow);\n\t\t\tif (timeElapsed > durationOfShow) {\n\t\t\t\treturn 'end show'\n\t\t\t}\n\t\t\tif (timeElapsed < 90 * 1000) {\n\t\t\t\treturn 'nothing'\n\t\t\t}\n\t\t\tif (timeSinceLastFlip > 15000) {\n\t\t\t\tthis.timeOfLastFlip = timeElapsed\n\n\t\t\t\tlet removeOdds = (Math.pow(this.activeRules, 3) + 4) * ((1-perComSq) * .8 + .2);\n\t\t\t\tlet addOdds = perComSq * 30 + 4;\n\t\t\t\tlet nothingOdds = Math.max(1 - (timeSinceLastRule / (90 * 1000)), 0) * ((1 - percentComplete) * 100)\n\n\n\t\t\t\tlet sum = removeOdds + addOdds + nothingOdds;\n\t\t\t\tlet removeBound = removeOdds / sum;\n\t\t\t\tlet addBound = addOdds / sum + removeBound;\n\n\t\t\t\tlet r = Math.random()\n\t\t\t\tif (r < removeBound) {\n\t\t\t\t\tif (this.activeRules > 0) {\n\t\t\t\t\t\tthis.activeRules--;\n\t\t\t\t\t\treturn 'removeRule'\n\t\t\t\t\t}\n\t\t\t\t} else if (r < addBound) {\n\t\t\t\t\tthis.timeOfLastRule = timeElapsed;\n\t\t\t\t\tthis.activeRules++;\n\t\t\t\t\treturn 'addRule'\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 'nothing';\n\t\t}\n\n\t},\n\tEvery15: function(durationOfShow) {\n\n\t\tthis.durationOfShow = durationOfShow;\n\t\tthis.timeCreated = Date.now();\n\t\tthis.activeRules = 0;\n\t\tthis.timeOfLastRule = 0;\n\t\tthis.timeOfLastFlip = 0;\n\n\t\tthis.getAction = () => {\n\t\t\tvar timeElapsed = Date.now() - this.timeCreated;\n\t\t\tvar timeSinceLastRule = Date.now() - this.timeOfLastRule;\n\t\t\tvar timeSinceLastFlip = Date.now() - this.timeOfLastFlip;\n\t\t\tvar percentComplete = timeElapsed / this.durationOfShow\n\t\t\tif (timeSinceLastFlip > 15000) {\n\t\t\t\tthis.timeOfLastFlip = Date.now()\n\t\t\t\tif (Math.random() < (this.activeRules/(10*percentComplete + 2))) {\n\t\t\t\t\tthis.activeRules--;\n\t\t\t\t\treturn 'removeRule'\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.timeOfLastRule = Date.now();\n\t\t\t\t\tthis.activeRules++;\n\t\t\t\t\treturn 'addRule'\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 'nothing';\n\t\t}\n\n\t},\n\tJustClose: function(durationOfShow) {\n\t\tthis.getAction = () => {\n\t\t\treturn 'end show'\n\t\t}\n\t},\n\tHandCrafted: function(options) {\n    // let showDuration = options.showDuration\n    // let addRule      = options.addRule\n    // let generateRule = options.generateRule\n    // let removeRule   = options.removeRule\n    // let ruleGens     = options.ruleGens\n    // let improvisers  = options.improvisers\n\n    _.extend(this, options);\n\n    this.activeRules = []\n    this.ruleSelectCount = {}\n\n\t\tthis.selectRule = (rules) => {\n\t\t  let r = Math.random()\n\t\t  for (var i = 0; i < rules.length; i++) {\n\t\t    if (rules[i].probCeil > r) {\n\t\t    \twhile (this.ruleSelectCount[rules[i].template] >= 1) {\n\t\t    \t\ti = (i + 1) % rules.length\n\t\t    \t}\n  \t    \tthis.ruleSelectCount[rules[i].template] = this.ruleSelectCount[rules[i].template] ? this.ruleSelectCount[rules[i].template] + 1 : 1\n  \t    \tconsole.log(i);\n\t\t      return rules[i];\t\t    \t\n\t\t    }\n\t\t  }\n\t\t}\n\n    // this.insertRule = (rule) => {\n\t   //  return compiledRule;\n    // }\n\n    this.distribution = (x) => {\n    \treturn x * x\n    }\n\n    this.times = [\n\n    ]\n    for (let i = 0; i < parseInt(this.showDuration / 1000 / 60) * 2; i++) {\n    \tthis.times.push(this.distribution(i + 1));\n    }\n\n    let max = Math.max(...this.times);\n\n    this.times = this.times.map(t => this.showDuration - ((t / max) * (this.showDuration - 90 * 1000)))\n    this.times.reverse()\n\n\n    this.actions = []\n\n    this.times.forEach(time => {\n    \tlet rule = this.selectRule(this.ruleGens.rules);\n\n    \tconsole.log('selectedRule', rule)\n    \tlet compiledRule = this.generateRule({\n\t    \tselectedRule: rule,\n\t      ruleGens: this.ruleGens,\n\t      improvisers: this.improvisers\n\t    })\n    \tthis.activeRules.push(compiledRule);\n\n    \tthis.actions.push({\n    \t\tfunc: this.addRule,\n    \t\trule: compiledRule,\n    \t\ttime: time\n    \t})\n    \tthis.actions.push({\n    \t\tfunc: this.removeRule,\n    \t\trule: compiledRule,\n    \t\ttime: time + (Math.random() * 90 + 30) * 1000\n    \t})\n    })\n\n    this.actions.sort((a, b) => a.time - b.time);\n\n    console.log('actions', this.actions);\n\n    let rule = this.ruleGens.rules[23]\n  \tconsole.log('selectedRule', rule)\n  \tlet compiledRule = this.generateRule({\n    \tselectedRule: rule,\n      ruleGens: this.ruleGens,\n      improvisers: this.improvisers\n    })\n  \tthis.activeRules.push(compiledRule);\n  \tthis.addRule(rule)\n\n    setTimeout(() => {\n    \tconsole.log('remove timeout strategy', rule)\n\t    this.removeRule(rule);\n    }, 10000)\n\n\n    this.startTime = 0\n\n    this.start = () => {\n    \treturn;\n    \tthis.startTime = Date.now();\n    \tlet actionQueue = [];\n\t    setInterval(() => {\n\t    \tlet elapsedTime = Date.now() - this.startTime;\n\t    \tthis.actions.forEach(action => {\n\t    \t\tif (action.time < elapsedTime) {\n\t    \t\t\tactionQueue.push(action)\n\t    \t\t}\n\t    \t})\n\t    \tthis.actions = this.actions.filter(action => actionQueue.indexOf(action) == -1);\n\n\t    \tlet action = actionQueue.shift();\n\t    \taction.func(action.rule);\n\t    \tconsole.log(action, actionQueue, this.actions)\n\t    }, 15000)\n    }\n\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/Strategies.js","module.exports = __webpack_public_path__ + \"static/img/amy.a7fc195.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/amy.png\n// module id = 127\n// module chunks = 2","module.exports = __webpack_public_path__ + \"static/img/charna.aeb5628.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/charna.png\n// module id = 128\n// module chunks = 2","module.exports = __webpack_public_path__ + \"static/img/del.92abdc1.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/del.png\n// module id = 129\n// module chunks = 2","module.exports = __webpack_public_path__ + \"static/img/ian.638d02f.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ian.png\n// module id = 130\n// module chunks = 2","module.exports = __webpack_public_path__ + \"static/img/keith.6b63371.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/keith.png\n// module id = 131\n// module chunks = 2","module.exports = __webpack_public_path__ + \"static/img/tj.3bd54f1.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/tj.png\n// module id = 132\n// module chunks = 2","module.exports = __webpack_public_path__ + \"static/img/viola.8d75b50.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/viola.png\n// module id = 133\n// module chunks = 2","\n/* styles */\nrequire(\"!!../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../node_modules/vue-loader/lib/style-rewriter?id=data-v-78c18bd7!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n\nvar Component = require(\"!../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"),\n  /* template */\n  require(\"!!../node_modules/vue-loader/lib/template-compiler?id=data-v-78c18bd7!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = 134\n// module chunks = 2","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../../node_modules/vue-loader/lib/style-rewriter?id=data-v-1aa94ace&scoped=true!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./AsciiImage.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./AsciiImage.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-1aa94ace!../../node_modules/vue-loader/lib/selector?type=template&index=0!./AsciiImage.vue\"),\n  /* scopeId */\n  \"data-v-1aa94ace\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/AsciiImage.vue\n// module id = 135\n// module chunks = 2","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../../node_modules/vue-loader/lib/style-rewriter?id=data-v-21244a73&scoped=true!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./BootAnimation.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./BootAnimation.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-21244a73!../../node_modules/vue-loader/lib/selector?type=template&index=0!./BootAnimation.vue\"),\n  /* scopeId */\n  \"data-v-21244a73\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/BootAnimation.vue\n// module id = 136\n// module chunks = 2","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../../node_modules/vue-loader/lib/style-rewriter?id=data-v-4a3f67a6&scoped=true!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Intro.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Intro.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-4a3f67a6!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Intro.vue\"),\n  /* scopeId */\n  \"data-v-4a3f67a6\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Intro.vue\n// module id = 137\n// module chunks = 2","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../../node_modules/vue-loader/lib/style-rewriter?id=data-v-2b47f138&scoped=true!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Rules.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Rules.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-2b47f138!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Rules.vue\"),\n  /* scopeId */\n  \"data-v-2b47f138\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Rules.vue\n// module id = 138\n// module chunks = 2","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../../node_modules/vue-loader/lib/style-rewriter?id=data-v-1a948596&scoped=true!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Simulation.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Simulation.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-1a948596!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Simulation.vue\"),\n  /* scopeId */\n  \"data-v-1a948596\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Simulation.vue\n// module id = 139\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"type-and-say\"\n    }\n  }, [_c('TypeWriter', {\n    attrs: {\n      \"volume\": _vm.typingVolume,\n      \"timeout\": _vm.timeout\n    }\n  }, [_vm._t(\"default\")], 2)], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-0b6b627d!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/TypeAndSay.vue\n// module id = 140\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"simulation\"\n    },\n    on: {\n      \"click\": _vm.simulateShow\n    }\n  }, [_c('h1', [_vm._v(\"Click me to simulate a show\")]), _vm._v(\" \"), _c('div', {\n    attrs: {\n      \"id\": \"timeline\"\n    }\n  }, _vm._l((_vm.actions), function(action, i) {\n    return _c('div', {\n      staticClass: \"action\",\n      style: ({\n        left: (i / _vm.actions.length * 100) + '%'\n      })\n    }, [(action.action != 'doNothing') ? _c('div', [_c('div', {\n      staticClass: \"rules\",\n      style: ({\n        height: action.rules * 8 + 18 + 'px',\n        top: -action.rules * 8 - 18 + 'px'\n      })\n    }, [_vm._v(\"\\n\\t\\t\\t\\t\\t\" + _vm._s(action.rules) + \"\\n\\t\\t\\t\\t\")]), _vm._v(\" \"), _c('div', {\n      staticClass: \"message\",\n      style: ({\n        height: _vm.meaningfulActions.indexOf(action) % 5 * 50 + 50 + 'px'\n      })\n    }, [_c('span', {\n      staticClass: \"text\"\n    }, [_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\" + _vm._s(action.action) + \" \" + _vm._s(_vm.formatTime(action.time)) + \"\\n\\t\\t\\t\\t\\t\")]), _vm._v(\" \"), _c('span', {\n      staticClass: \"rule-text\"\n    }, [_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\" + _vm._s(action.ruleText) + \"\\n\\t\\t\\t\\t\\t\")])])]) : _vm._e()])\n  }))])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-1a948596!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Simulation.vue\n// module id = 141\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"ascii-image\",\n    class: {\n      loaded: _vm.asciiLoaded\n    }\n  }, [_c('img', {\n    attrs: {\n      \"id\": \"image-del\",\n      \"src\": require(\"../assets/del.png\")\n    }\n  }), _vm._v(\" \"), _c('img', {\n    attrs: {\n      \"id\": \"image-amy\",\n      \"src\": require(\"../assets/amy.png\")\n    }\n  }), _vm._v(\" \"), _c('img', {\n    attrs: {\n      \"id\": \"image-charna\",\n      \"src\": require(\"../assets/charna.png\")\n    }\n  }), _vm._v(\" \"), _c('img', {\n    attrs: {\n      \"id\": \"image-keith\",\n      \"src\": require(\"../assets/keith.png\")\n    }\n  }), _vm._v(\" \"), _c('img', {\n    attrs: {\n      \"id\": \"image-tj\",\n      \"src\": require(\"../assets/tj.png\")\n    }\n  }), _vm._v(\" \"), _c('img', {\n    attrs: {\n      \"id\": \"image-ian\",\n      \"src\": require(\"../assets/ian.png\")\n    }\n  }), _vm._v(\" \"), _c('img', {\n    attrs: {\n      \"id\": \"image-viola\",\n      \"src\": require(\"../assets/viola.png\")\n    }\n  }), _vm._v(\" \"), _c('pre', {\n    staticClass: \"ascii-text\"\n  }, [_vm._v(\"\\n    \" + _vm._s(_vm.text) + \"\\n  \")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"loading-cover\"\n  })])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-1aa94ace!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/AsciiImage.vue\n// module id = 142\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"boot-animation\"\n    }\n  }, [(_vm.step == 'fakeCode') ? _c('div', {\n    attrs: {\n      \"id\": \"fakecode\"\n    }\n  }, [_c('pre', [_vm._v(\"\\n        \"), _c('TypeWriter', {\n    attrs: {\n      \"timeout\": 40,\n      \"spliton\": '\\n'\n    }\n  }, [_vm._v(_vm._s(_vm.fakeCode))]), _vm._v(\"\\n      \")], 1)]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'greenFlash') ? _c('div', {\n    staticClass: \"glitch\",\n    attrs: {\n      \"id\": \"green-flash\"\n    }\n  }) : _vm._e(), _vm._v(\" \"), (_vm.step == 'ascii') ? _c('div', {\n    attrs: {\n      \"id\": \"ascii\"\n    }\n  }, [_c('pre', {\n    attrs: {\n      \"id\": \"loading\"\n    }\n  }, [_vm._v(\"\\n        \"), _c('TypeWriter', {\n    attrs: {\n      \"timeout\": 60\n    }\n  }, [_vm._v(\"\\n\\nCalibrating comedic timing...\\nNullifying transactions...\\nFinding light...\\nSimulating montage...\\n\\n        \")]), _vm._v(\"        \\n      \")], 1), _vm._v(\" \"), _c('AsciiImage', {\n    attrs: {\n      \"imagename\": _vm.asciiName\n    }\n  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.step == 'title') ? _c('div', {\n    class: {\n      inverted: _vm.titleInverted\n    },\n    attrs: {\n      \"id\": \"title\"\n    }\n  }, [_c('div', [_vm._v(\"IMPROV\")]), _vm._v(\" \"), _c('div', [_vm._v(\"GOD\")])]) : _vm._e()])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-21244a73!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/BootAnimation.vue\n// module id = 143\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"rules\"\n    }\n  }, [(_vm.step == 'board') ? _c('div', [_c('div', {\n    attrs: {\n      \"id\": \"board-title\"\n    }\n  }, [_vm._v(\"\\n        Active Rules\\n\")]), _vm._v(\" \"), _c('div', {\n    attrs: {\n      \"id\": \"board\"\n    }\n  }, _vm._l((_vm.rules), function(rule) {\n    return _c('div', [_c('div', {\n      staticClass: \"rule\",\n      class: {\n        removing: rule.removing\n      }\n    }, [_vm._v(\"\\n            \" + _vm._s(rule.text) + \"\\n          \")])])\n  }))]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'new rule') ? _c('div', {\n    attrs: {\n      \"id\": \"new-rule\"\n    }\n  }, [_c('div', {\n    staticClass: \"flash-text\"\n  }, [_vm._v(\"\\n        NEW RULE\\n      \")])]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'new command') ? _c('div', {\n    attrs: {\n      \"id\": \"new-command\"\n    }\n  }, [_c('div', {\n    staticClass: \"flash-text\"\n  }, [_vm._v(\"\\n        NEW COMMAND\\n      \")])]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'remove rule') ? _c('div', {\n    attrs: {\n      \"id\": \"new-rule\"\n    }\n  }, [_c('div', {\n    staticClass: \"flash-text\"\n  }, [_vm._v(\"\\n        REMOVING RULE\\n      \")])]) : _vm._e(), _vm._v(\" \"), (_vm.step == 'read rule') ? _c('div', [_c('TypeAndSay', {\n    attrs: {\n      \"timeout\": 40,\n      \"doneReading\": _vm.doneReading\n    }\n  }, [_vm._v(\"\\n        \" + _vm._s(_vm.readRuleText) + \"\\n      \")])], 1) : _vm._e(), _vm._v(\" \"), (_vm.step == 'closer') ? _c('div', [_c('div', {\n    class: {\n      'flash-text': _vm.closerStep == 'closer title'\n    },\n    attrs: {\n      \"id\": \"closer\"\n    }\n  }, [(_vm.closerStep == 'closer title') ? _c('div', [_c('div', {\n    staticClass: \"flash-text\"\n  }, [_vm._v(\"\\n            CLOSER\\n          \")])]) : _vm._e(), _vm._v(\" \"), (_vm.closerStep == 'read closer') ? _c('div', [_c('TypeAndSay', {\n    attrs: {\n      \"timeout\": 40,\n      \"doneReading\": _vm.closerFunc\n    }\n  }, [_vm._v(\"\\n            \" + _vm._s(_vm.closerText) + \"\\n          \")])], 1) : _vm._e(), _vm._v(\" \"), (_vm.closerStep == 'playing out') ? _c('div', [_vm._v(\"\\n          <playing you out>\\n        \")]) : _vm._e(), _vm._v(\" \"), (_vm.closerStep == 'lights down') ? _c('div', [_vm._v(\"\\n          Lights down\\n        \")]) : _vm._e(), _vm._v(\" \"), (_vm.closerStep == 'advertise') ? _c('div', [_vm._v(\"\\n          \" + _vm._s(_vm.adMessage) + \"\\n        \")]) : _vm._e()])]) : _vm._e()])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-2b47f138!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Rules.vue\n// module id = 144\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"typewriter\"\n  }, [_vm._v(\"\\n  \" + _vm._s(_vm.text) + \"\\n\")])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-3a5118dc!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/TypeWriter.vue\n// module id = 145\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"intro\"\n    }\n  }, [_c('TypeAndSay', [_vm._v(_vm._s(_vm.message))])], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-4a3f67a6!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Intro.vue\n// module id = 146\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [(_vm.step.current == 'boot') ? _c('div', [_c('BootAnimation', {\n    attrs: {\n      \"showStep\": _vm.step\n    }\n  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.step.current == 'intro') ? _c('div', [_c('Intro', {\n    attrs: {\n      \"names\": _vm.names,\n      \"step\": _vm.step\n    }\n  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.step.current == 'rules') ? _c('div', [_c('Rules', {\n    attrs: {\n      \"ruleGens\": _vm.rules,\n      \"improvisers\": _vm.improvisers\n    }\n  })], 1) : _vm._e(), _vm._v(\" \"), (_vm.step.current == 'simulate') ? _c('div', [_c('Simulation', {\n    attrs: {\n      \"ruleGens\": _vm.rules,\n      \"names\": _vm.names,\n      \"improvisers\": _vm.improvisers\n    }\n  })], 1) : _vm._e()])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-78c18bd7!./~/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = 147\n// module chunks = 2"],"sourceRoot":""}